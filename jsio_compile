#!/usr/local/bin/node
jsio=function T(z){function F(a,c,d){a=j.splitPath(a+".js");if(c){a.baseMod=c;a.basePath=d}return a}function U(){var a=require("fs"),c=require("sys");this.name="node";this.global=GLOBAL;this.getCwd=process.cwd;this.log=function(){var d;try{c.error(d=Array.prototype.map.call(arguments,function(b){if(b instanceof Error&&b.message)return"Error:"+b.message+"\nStack:"+b.stack+"\nArguments:"+b.arguments;return typeof b=="string"?b:JSON.stringify(b)}).join(" "))}catch(f){c.error(d=Array.prototype.join.call(arguments,
" ")+"\n")}return d};this.getPath=function(){var d=__filename.split("/");d.pop();return j.makeRelativePath(d.join("/")||".",this.getCwd())};this.eval=process.compile;this.fetch=function(d){try{return a.readFileSync(d,"utf8")}catch(f){}return false};this.require=require}function V(){var a=window.XMLHttpRequest||function(){return new ActiveXObject("Msxml2.XMLHTTP")},c=null,d=null;this.name="browser";this.global=window;this.global.jsio=g;this.log=function(){var b=G.call(arguments,0);if(typeof console!=
"undefined"&&console.log)console.log.apply?console.log.apply(console,arguments):console.log(b);return b.join(" ")};this.getCwd=function(){if(!c){var b=window.location,e=b.pathname;c=b.protocol+"//"+b.host+e.substring(0,e.lastIndexOf("/")+1)}return c};this.getPath=function(){if(!d){try{for(var b=RegExp("(.*?)"+g.__filename+"(\\?.*)?$"),e=document.getElementsByTagName("script"),h=0,k;k=e[h];++h){var r=k.src.match(b);if(r){d=r[1];if(/^[A-Za-z]*:\/\//.test(d))d=j.makeRelativePath(d,this.getCwd());break}}}catch(l){}d||
(d=".")}return d};this.debugPath=function(b){return b};var f=typeof eval("(function(){})")=="undefined"?function(b){return(new Function("return "+b))()}:function(b,e){b=b+"\n//@ sourceURL="+e;return window.eval(b)};this.eval=function(b,e,h){try{return f(b,this.debugPath(e))}catch(k){if(k instanceof SyntaxError){i.log("a syntax error is preventing execution of "+e);W&&this.checkSyntax&&this.checkSyntax(h,e)}throw k;}};this.checkSyntax=function(b,e){try{var h=g("import util.syntax",{suppressErrors:true,
dontExport:true}),k=h(b);h.display(k,e)}catch(r){}};this.fetch=function(b){var e=new a;try{e.open("GET",b,false);e.send(null)}catch(h){i.log("e:",h);return false}if(e.status==404||e.status==-1100||0)return false;return e.responseText}}function L(a,c,d,f){for(var b=0,e=d.length;b<e;++b)(p=typeof d[b]=="function"?d[b]:g.__modules["preprocessors."+d[b]]||g("import preprocessors."+d[b],{dontExport:true}))&&p(a,c,f)}function X(a,c,d,f){a||(a={});if(!a.exports)a.exports={};a.jsio=j.bind(this,H,a,d.directory,
d.filename);a.require=function(b,e){e||(e={});e.dontExport=true;e.suppressErrors=true;try{var h=a.jsio(b,e);if(h===false)throw"module failed to load";else return h}catch(k){try{return require(b)}catch(r){i.log("Error loading request "+b+":");i.log(k);i.log("Also could not load using standard CommonJS");i.log(r);throw k;}}};a.module={id:c,exports:a.exports};if(!f&&c!="base"){a.jsio("from base import *");a.logging.__create(c,a)}a.jsio.__jsio=g;a.jsio.__env=g.__env;a.jsio.__dir=d.directory;a.jsio.__filename=
d.filename;a.jsio.__path=c;a.jsio.path=g.path;return a}function H(a,c,d,f,b){b=b||{};c=c||"./";d=d||"<initial file>";a=b.exportInto||a||i.global;for(var e=b,h=g.__cmds,k=[],r=false,l=0,s;s=h[l];++l)if(r=s(a,f,e,k))break;if(r!==true)throw new (typeof SyntaxError!="undefined"?SyntaxError:Error)(String(r||"invalid jsio command: jsio('"+f+"')"));e=k.length;h=e>1?{}:null;for(r=0;r<e;++r){l=k[r];var o=l.from;s=g.__modules;try{var v;a:{for(var t=c,q=d,m=o,x=b,y=j.resolveModulePath(m,t),w=0,M=void 0;y[w];++w){var N=
y[w].path;if(!x.reload&&N in g.__modules){v=y[w];break a}N in O&&y.splice(w--,1)}if(!y.length){if(x.suppressErrors){v=false;break a}var P=Error("Module failed to load (again)");P.jsioLogged=true;throw P;}var n;b:{for(var B=y,I=void 0,Q=0,A=void 0;A=B[Q];++Q){var J=A.path,R=D[J];if(R){A.src=R.src;n=A;break b}I=i.fetch(J);if(I!==false){A.src=I;n=A;break b}else O[J]=true}n=false}B=void 0;if(!n){if(x.suppressErrors){v=false;break a}b=[];for(w=0;M=y[w];++w)b.push(M.path);throw Error(t+q+": \n\tcurrent directory: "+
i.getCwd()+"\n\tlooked in:\n\t\t"+b.join("\n\t\t")+"\n\tImport Stack:\n\t\t"+E.join("\n\t\t")+"\n\tError: requested import ("+m+") not found.");}n.friendlyPath=m;if(n.baseMod&&!(n.baseMod in g.path.cache))g.path.cache[n.baseMod]=n.basePath;for(;n.src.charAt(0)=='"'&&(B=n.src.match(Y));){n.src=n.src.substring(B[0].length-1);L(t,n,B[1].split(","),x)}x.preprocessors&&L(t,n,x.preprocessors,x);v=n}if(v===false)return false}catch(K){if(!K.jsioLogged){i.log("\nError loading module:\n\trequested:",o,"\n\tfrom:",
c+d,"\n\tfull request:",f,"\n");K.jsioLogged=true}throw K;}E.push(E.length+" : "+v.friendlyPath+" ("+v.path+")");t=v.path;if(!(t in s)){o=X(b.context,o,v,l.dontAddBase);s[t]=o.exports;if(l.dontUseExports){q=[";(function(){"];var u=1;for(var C in l["import"]){o.exports[C]=undefined;q[u++]="if(typeof "+C+'!="undefined"&&exports.'+C+"==undefined)exports."+C+"="+C+";"}q[u]="})();";v.src+=q.join("")}q=o;m=v;w="(function(_){with(_){delete _;return function $$"+m.friendlyPath.replace(/[\/.]/g,"_")+"(){"+
m.src+"\n}}})";m=i.eval(w,m.path,m.src);m=m(q);m.call(q.exports);s[t]=o.exports}E.pop();o=s[t];if(e==1)h=o;if(!b.dontExport)if(l.as){l=l.as.match(/^\.*(.*?)\.*$/)[1];s=l.split(".");t=s.length-1;q=a;for(u=0;u<t;++u)if(m=s[u]){q[m]||(q[m]={});q=q[m]}q[s[t]]=o;if(e>1)h[l]=o}else if(l["import"])if(l["import"]["*"])for(u in s[t])a[u]=o[u];else try{for(u in l["import"])a[l["import"][u]]=o[u]}catch(Z){i.log("module: ",s);throw Z;}}return h}var W=true,G=Array.prototype.slice,i,S=/\/$/,j={bind:function(a,
c){var d=G.call(arguments,2);return function(){c=typeof c=="string"?a[c]:c;return c.apply(a,d.concat(G.call(arguments,0)))}},addEndSlash:function(a){return S.test(a)?a:a+"/"},removeEndSlash:function(a){return a.replace(S,"")},makeRelativePath:function(a,c){var d=c.length;if(a.substring(0,d)==c)return a.slice((a.charAt(d)=="/")+d);d=j.removeEndSlash(a).split("/");for(var f=j.removeEndSlash(c).split("/"),b=0;d[b]==f[b];)++b;if(b){a=d.slice(b).join("/");for(d=f.length-b;d>0;--d)a="../"+a}return a},buildPath:function(){return j.resolveRelativePath(Array.prototype.join.call(arguments,
"/"))},resolveRelativePath:function(a){var c=a.match(/^(\w+:\/\/)(.*)$/);if(c)a=c[2];for(a=a.replace(/\/+/g,"/").replace(/\/\.\//g,"/");a!=(a=a.replace(/(^|\/)(?!\.?\.\/)([^\/]+)\/\.\.\//g,"$1")););return c?c[1]+a:a},resolveRelativeModule:function(a,c){for(var d=[],f=a.split("."),b=f.length,e=b>1&&!f[0],h=e?0:-1;++h<b;)d.push(f[h]?f[h]:"..");return j.buildPath(e?c:"",d.join("/"))},resolveModulePath:function(a,c){if(a.charAt(0)==".")return[F(j.resolveRelativeModule(a,c))];var d=a.split("."),f=d[0];
d=d.join("/");if(g.path.cache.hasOwnProperty(f))return[F(j.buildPath(g.path.cache[f],d))];for(var b=[],e=g.path.get(),h=e.length,k=0;k<h;++k)b.push(F(j.buildPath(e[k],d),f,e[k]));return b},splitPath:function(a){var c=a.lastIndexOf("/")+1;return{path:a,directory:a.substring(0,c),filename:a.substring(c)}}},g=j.bind(this,H,null,null,null);g.__util=j;g.__init__=T;var D=g.__srcCache={};if(z&&z.__srcCache)D=g.__srcCache=z.__srcCache;(function(){this.__filename="jsio.js";this.__preprocessors={};this.__cmds=
[];this.__jsio=this;this.__importer=H;this.__modules={preprocessors:{}};this.path={set:function(a){this.value=typeof a=="string"?[a]:a},get:function(){return this.value.slice(0)},add:function(a){for(var c=this.value,d=c.length,f=0;f<d;++f)if(c[f]==a)return;c.push(a)},remove:function(a){for(var c=this.value,d=c.length,f=0;f<d;++f)c[f]==a&&c.splice(f,1)},value:[],cache:{}};this.addPath=j.bind(this.path,"add");this.setCachedSrc=function(a,c){D[a]={path:a,src:c}};this.getCachedSrc=function(a){return D[a]};
this.addPreprocessor=function(a,c){this.__preprocessors[a]=c};this.addCmd=function(a){this.__cmds.push(a)};this.setEnv=function(a){if(!a&&z)i=z.__env;else if(typeof a=="string")switch(a){case "node":i=new U(j);break;case "browser":default:i=new V(j);break}else i=new a(j);this.__env=i;this.__dir=i.getCwd();this.path.set(i.getPath())}}).call(g);if(z)g.setEnv();else if(typeof process!=="undefined"&&process.version)g.setEnv("node");else if(typeof XMLHttpRequest!="undefined"||typeof ActiveXObject!="undefined")g.setEnv("browser");
var Y=/^"use (.*?)"\s*;\s*\n/,O={},E=[];g.addCmd(function(a,c,d,f){if(a=c.match(/^\s*(from|external)\s+([\w.$]+)\s+(import|grab)\s+(.*)$/)){f.push({from:a[2],dontAddBase:a[1]=="external",dontUseExports:a[3]=="grab"||a[1]=="external","import":{}});a[4].replace(/\s*([\w.$*]+)(?:\s+as\s+([\w.$]+))?/g,function(b,e,h){f[0]["import"][e]=h||e});return true}});g.addCmd(function(a,c,d,f){if(a=c.match(/^\s*import\s+(.*)$/)){a[1].replace(/\s*([\w.$]+)(?:\s+as\s+([\w.$]+))?,?/g,function(b,e,h){f.push(h?{from:e,
as:h}:{from:e,as:e})});return true}});g.addCmd(function(a,c,d,f){if(a=c.match(/^\s*[\w.0-9$\/]+\s*$/)){a=j.resolveRelativePath(a[0]);c=a.charAt(0)==".";a=a.replace(/\.\.\//g,".").replace(/\.\//g,"").replace(/\//g,".");f[0]={from:(c?".":"")+a};return true}});g.install=function(){g("from base import *");GLOBAL.logger=logging.get("jsiocore")};g.clone=function(){var a=g.__init__(g);if(i.name=="browser")window.jsio=g;return a};return g}();jsio.path.set(["../../packages"]);
jsio.path.cache={base:"../../packages",lib:"../../packages",preprocessors:"../../packages",std:"../../packages",util:"../../packages",math:"../../packages",math2D:"../../packages",net:"../../packages",index:"../../packages",logging:"../../packages"};jsio.setCachedSrc("../../packages/preprocessors/compiler.js",'jsio("import std.js as JS");var JSIO=jsio.__jsio,sourceCache=/jsio.__srcCache\\s*=\\s*\\{\\s*\\}/,jsioAddPath=/jsio\\.path\\.add\\s*\\(\\s*([\'"][^\'"]+?[\'"])\\s*\\)/g,jsioNormal=/jsio\\s*\\(\\s*([\'"].+?[\'"])\\s*(,\\s*\\{[^}]+\\})?\\)/g,jsioDynamic=/jsio\\s*\\(\\s*DYNAMIC_IMPORT_(.*?)\\s*(,\\s*\\{[^}]+\\})?\\)/g,gSrcTable={};\nexports=function(a,e,b){b=b||{};if(!gSrcTable[e.path]){logger.info("compiling",e.path);gSrcTable[e.path]=true;var d=e.path;if(b.path)if(JS.isArray(b.path)){a=0;for(var c=b.path.length;a<c;++a)jsio.path.add(b.path)}else typeof b.path=="string"&&jsio.path.add(b.path);if(b.autoDetectPaths){jsioAddPath.lastIndex=0;for(logger.debug("detecting paths for",d);;){c=jsioAddPath.exec(e.src);if(!c)break;try{jsio.path.add(eval(c[1]));logger.info("added path "+c[1])}catch(f){logger.info("failed to add path "+c[1])}}}for(jsioNormal.lastIndex=\n0;;){c=jsioNormal.exec(e.src);if(!c)break;logger.debug("detected",c[0]);a=c[1];c=c[2]?c[2].substring(1):"";try{a=eval(a)}catch(g){logger.warn("could not compile import from",d+":",a);continue}try{c=eval(c)}catch(j){logger.warn("could not parse opts for jsio in",d+":",c);c={}}run(e,a,b,c)}for(jsioDynamic.lastIndex=0;;){c=jsioDynamic.exec(e.src);if(!c)break;a=c[1];c=c[2]||"";if(b.dynamicImports&&a in b.dynamicImports)if(d=b.dynamicImports[a])if(JS.isArray(d))for(var i=0,h;h=d[i];++i){logger.debug("Dynamic import "+\na+": "+h);run(e,h,b,c)}else{logger.debug("Dynamic import "+a+": "+d);run(e,d,b,c)}else logger.debug("Dynamic import "+a+": <nothing>");else logger.error("Missing: import definition\\nConstant",a,"for DYNAMIC_IMPORT_"+a," was not provided to the compiler")}gSrcTable[e.path]=JS.shallowCopy(e)}e.src=""};exports.setDebugLevel=function(a){logger.setLevel(a)};exports.reset=function(){gSrcTable={}};var gActiveCompressor;exports.setCompressor=function(a){gActiveCompressor=a};\nexports.generateSrc=function(a,e){a=JS.merge(a,{compressSources:false,includeJsio:true,preserveJsioSource:false});var b=bind(this,buildJsio,a,e);a.compressSources?compressTable(gSrcTable,a,b):b()};exports.getPathJS=function(){return"jsio.path.set("+JSON.stringify(jsio.path.get())+");jsio.path.cache="+JSON.stringify(jsio.path.cache)+";"};\nfunction buildJsio(a,e){function b(){var g=jsio.__jsio.__init__.toString(-1);if(g.substring(0,8)=="function")g="jsio=("+g+")();";return g}var d;d=(a.includeJsio?b():"")+exports.getPathJS();if(a.preserveJsioSource||!a.includeJsio){logger.info("source include method: jsio.setCachedSrc");var c=[];for(var f in gSrcTable)c.push("jsio.setCachedSrc(\'"+gSrcTable[f].path+"\',"+JSON.stringify(gSrcTable[f].src)+");");d=d+c.join("\\n")}else{logger.info("source include method: setting jsio.__srcCache");d=d.replace(sourceCache,\nfunction(){return"jsio.__srcCache="+JSON.stringify(gSrcTable)})}if(a.compressResult){logger.info("compressing final code...");gActiveCompressor(null,d,e,a)}else e(d)}function compressTable(a,e,b){logger.info("compressing sources");var d=[];for(var c in a)d.push(c);compressStep(d,a,e,d.pop(),b)}function compressStep(a,e,b,d,c){if(d){logger.log("compressing",d+"...");gActiveCompressor(d,e[d].src,function(f){e[d].src=f;compressStep(a,e,b,a.pop(),c)},b)}else c()}exports.getTable=function(){return gSrcTable};\nexports.compile=function(a,e){var b=mergeOpts({reload:true},e);JSIO(a,b)};function run(a,e,b,d){b=mergeOpts(b,d);JSIO.__importer({},a.directory,a.filename,e,b)}function mergeOpts(a,e){var b=JS.merge(JS.shallowCopy(a),e);if(b.preprocessors){for(var d=0,c=b.preprocessors.length;d<c;++d)if(b.preprocessors[d]=="compiler")break;d==c&&b.preprocessors.push("compiler")}else b.preprocessors=["compiler"];return b};\n');
jsio.setCachedSrc("../../packages/std/js.js",'var SLICE=Array.prototype.slice;exports.vargs=function(a,b){return SLICE.call(a,b||0)};exports.isArray=function(a){return Object.prototype.toString.call(a)==="[object Array]"};exports.shallowCopy=function(a){if(exports.isArray(a))return a.slice(0);else{var b={};for(var c in a)if(a.hasOwnProperty(c))b[c]=a[c]}return b};exports.merge=function(a){a=a||{};for(var b=1,c=arguments.length;b<c;++b){var d=arguments[b];for(var e in d)if(d.hasOwnProperty(e)&&!a.hasOwnProperty(e))a[e]=d[e]}return a};\nexports.curry=function(a){var b=SLICE.call(arguments,1),c=typeof a=="string"?function(){this[a].apply(ctx,b.concat(SLICE.call(arguments)))}:function(){a.apply(this,b.concat(SLICE.call(arguments)))};c.curried=true;return c};exports.unbind=function(a){var b=SLICE.call(arguments,1),c=typeof a=="string"?function(d){d[a].apply(d,b.concat(SLICE.call(arguments,1)))}:function(d){a.apply(d,b.concat(SLICE.call(arguments,1)))};c.unbound=true;return c};\n');
jsio.setCachedSrc("./compiler.js",'jsio("from base import *");var logger=logging.get("jsio_compiler"),JSIO="jsio",supportedEnvs={node:true,browser:true},_interface=null;exports.start=function(e,a){if(!jsio.__env.name in supportedEnvs)logger.error("autostart failed: unknown environment.\\n\\n\\tTry using compiler.run(args, opts) instead.");else{_interface=jsio("import ."+jsio.__env.name+"_interface");_interface.init(exports,e,a)}};\nfunction getPackage(e){try{var a=eval("("+jsio.__env.fetch(e)+")");logger.info("Package definition loaded from",e);return a}catch(f){logger.log(jsio.__env.getCwd());logger.warn(\'If "\'+e+\'" is a package file, it could not be read.\',f)}return false}\nexports.run=function(e,a){var f="debug"in a?a.debug:5;logger.setLevel(f);_interface.logger.setLevel(f);if(f>=3){var c=JSON.stringify(a,null,"\\t");logger.info("Starting compiler with args: ",e,"and options:",c.substring(1,c.length-1))}if(a.jsioPath){jsio.path.set([a.jsioPath]);jsio.__jsio.__init__.toString=function(){return jsio.__env.fetch(jsio.__jsio.__util.buildPath(a.jsioPath,"jsio.js"))};for(var i in jsio.path.cache)delete jsio.path.cache[i];c=jsio.__jsio.__srcCache;for(var b in c)delete c[b]}if(a.path){b=\n0;for(c=a.path.length;b<c;++b)a.path[b]&&jsio.path.add(a.path[b])}logger.info("js.io path:",JSON.stringify(jsio.path.get()));var d;if(/\\.pkg$/.test(e[2])){b=getPackage(e[2]);if(b!=false){e.splice(2,1);a["package"]=b}}if(typeof a["package"]=="string"&&/\\.pkg$/.test(a["package"]))a["package"]=getPackage(a["package"]);if(a["package"]){var h=a["package"];logger.debug(h);if("root"in h){d=h.root;/^\\./.test(d)||(d="."+d);a.appendImport=true}b=function(g,j){a[g]=(a[g]||[]).concat(h[j||g])};c=function(g,j){a[g]=\nJS.merge(a[g]||{},h[j||g])};h.environments&&b("environments");h.transports&&b("transports");h.additional_dependancies&&b("additionalDeps","additional_dependancies");h.dynamicImports&&c("dynamicImports")}if(e.length>2)d=e[2];if(d){logger.info("dynamic imports: ",a.dynamicImports);if(!a.dynamicImports)a.dynamicImports={};if(!a.dynamicImports.ENV)a.dynamicImports.ENV=null;if(a.transports&&a.environments){a.dynamicImports.ENV=a.dynamicImports.ENV||[];b=0;for(c=a.transports.length;b<c;++b){i=0;for(var k=\na.environments.length;i<k;++i)a.dynamicImports.ENV.push("import net.env."+a.environments[i]+"."+a.transports[b])}}if(b=d.match(/^(.*)\\.js$/)){d=b[1];if(d.charAt[0]!="/"&&d.charAt[0]!=".")d="./"+d}c=jsio("import preprocessors.compiler");c.setDebugLevel(f);a.compressor&&c.setCompressor(a.compressor);c.compile("import base");if(a.additionalDeps){f=a.additionalDeps;i=f.length;logger.info("compiling dependencies...");for(b=0;b<i;++b)c.compile(f[b])}f={autoDetectPaths:true,dynamicImports:a.dynamicImports};\nlogger.info("compiling main program",d,JSON.stringify(f));c.compile(d,f);c.generateSrc(a,function(g){if(a.appendImport)g=g+JSIO+\'("import \'+d+\'")\';if(a.footer)g+=a.footer||"";_interface.onFinish(a,g)})}else _interface.onError("No initial import specified")};\n');
jsio.setCachedSrc("../../packages/base.js",'exports.log=jsio.__env.log;exports.GLOBAL=jsio.__env.global;var SLICE=Array.prototype.slice;exports.isArray=function(a){return Object.prototype.toString.call(a)==="[object Array]"};\nexports.bind=function(a,b){if(arguments.length>2){var e=SLICE.call(arguments,2);return typeof b=="string"?function(){if(a[b])return a[b].apply(a,e.concat(SLICE.call(arguments,0)));else throw logger.error("No method:",b,"for context",a);}:function(){return b.apply(a,e.concat(SLICE.call(arguments,0)))}}else return typeof b=="string"?function(){if(a[b])return a[b].apply(a,arguments);else throw logger.error("No method:",b,"for context",a);}:function(){return b.apply(a,arguments)}};\nexports.Class=function(a,b,e){if(typeof a=="string"){var g=a;a=b;b=e;var f=exports.logging.get(g)}if(!a)throw Error("parent or prototype not provided");if(b)if(exports.isArray(a)){b.prototype={};e=0;for(var c;c=a[e];++e){if(c==Error&&ErrorParentClass)c=ErrorParentClass;for(var d in c.prototype)d in b.prototype||(b.prototype[d]=c.prototype[d])}a=a[0]}else{if(a==Error&&ErrorParentClass)a=ErrorParentClass;b.prototype=a.prototype}else{b=a;a=null}d=function(){if(this.init)return this.init.apply(this,arguments)};\ne=a?function(h,i,j){var k=a.prototype[i];if(!k)throw Error("method "+i+" does not exist");return k.apply(h,j||[])}:null;d.prototype=new b(f||e,f&&e);d.prototype.constructor=d;d.prototype.__parentClass__=a;if(g)d.prototype.__class__=g;return d};var ErrorParentClass=exports.Class(Error,function(){this.init=function(){var a=Error.prototype.constructor.apply(this,arguments);for(var b in a)if(a.hasOwnProperty(b))this[b]=a[b]}});\nexports.Class.defaults=exports.merge=function(a){a=a||{};for(var b=1,e=arguments.length;b<e;++b){var g=arguments[b];for(var f in g)if(g.hasOwnProperty(f)&&!a.hasOwnProperty(f))a[f]=g[f]}return a};exports.delay=function(a,b){var e=null,g,f=function(){a.apply(g,arguments)};return function(){g=this;e&&clearTimeout(e);e=setTimeout(f,b||0)}};\nexports.Class.ctor=function(a,b,e,g){b||(b=function(f,c,d){f._opts=d[0]});a.init=g?function(f){b(this,"init",[f=exports.merge(f,e)]);g.apply(this,[f].concat(SLICE.call(arguments,1)))}:function(f){b(this,"init",[exports.merge(f,e)])}};\nexports.logging=function(){var a={DEBUG:1,LOG:2,INFO:3,WARN:4,ERROR:5},b={},e=false,g="";a.setPrefix=function(c){g=c+" "};a.setProduction=function(c){e=!!c};a.get=function(c){return b.hasOwnProperty(c)?b[c]:b[c]=new f(c)};a.set=function(c,d){b[c]=d};a.getAll=function(){return b};a.__create=function(c,d){d.logger=a.get(c)};var f=exports.Class(function(){function c(d,h){return function(){if(!e&&d>=this._level){var i=h+" "+g+this._name,j=this._listener||exports.log;return j&&j.apply(this._listener,[i].concat(SLICE.call(arguments)))}return arguments[0]}}\nthis.init=function(d,h){this._name=d;this._level=h||a.LOG};this.setLevel=function(d){this._level=d};this.setListener=function(d){this._listener=d};this.debug=c(a.DEBUG,"DEBUG");this.log=c(a.LOG,"LOG");this.info=c(a.INFO,"INFO");this.warn=c(a.WARN,"WARN");this.error=c(a.ERROR,"ERROR")});return a}();var logger=exports.logging.get("jsiocore");\n');
jsio.setCachedSrc("./node_interface.js",'jsio("import util.optparse;");jsio("import .optsDef;");var fs=require("fs"),path=require("path"),closurePath="";(function(){var a=require("path"),b=a.join(a.dirname(jsio.__filename),"jsio_minify.jar");if(a.existsSync(b))closurePath=b})();exports.logger=logger;function findMinifier(a){if(require("path").existsSync(a))closurePath=a}function usage(){util.optparse.printUsage(\'<node> compile.js <initial import>\\n\\t where <initial import> looks like "import .myModule"\',optsDef)}\nexports.init=function(a,b,c){if(!b){c=util.optparse(process.argv,optsDef);b=c.args;c=c.opts}if(c.help){usage();process.exit()}findMinifier(c.closurePath);c.compressor=exports.compressor;a.run(b,c)};exports.onError=function(a){usage();jsio.__env.log("");logger.error("\\n"+a);jsio.__env.log("");process.exit(1)};exports.onFinish=function(a,b){if(a.outputFile){logger.info("Writing output to",a.outputFile);require("fs").writeFileSync(a.outputFile,b)}else{logger.info("Writing output to stdout");require("sys").print(b)}};\nexports.compressor=function(a,b,c,h){var e;if(closurePath){if(h.compressorCachePath&&a)try{var f=""+fs.statSync(a).mtime,m=(/^\\.\\//.test(a)?"R-"+a.substring(2):"A-"+a).replace(/\\.\\.\\//g,"--U--").replace(/\\//g,"---");e=path.join(h.compressorCachePath,m);if(path.existsSync(e)){var g=fs.readFileSync(e,"utf8"),i=g.indexOf("\\n"),j=g.substring(0,i);logger.debug(e,"current:",f,"cached at:",j);if(f==j){c(g.substring(i+1));return}}}catch(n){logger.error(n)}a=require("child_process").spawn;a=a("java",["-jar",\nclosurePath||"jsio_minify.jar","--compilation_level","SIMPLE_OPTIMIZATIONS"]);var k=[],l=[];a.stdout.on("data",function(d){k.push(d)});a.stderr.on("data",function(d){l.push(d)});a.on("exit",function(d){if(d==0){d=k.join("");try{if(e){logger.debug("updating cache for",e);fs.writeFileSync(e,f+"\\n"+d)}}catch(o){logger.error(o)}c(d)}else{(d=l.join(""))&&logger.error(d);c(b)}});a.stdin.write(b);a.stdin.end()}else c(b)};\n');
jsio.setCachedSrc("../../packages/util/optparse.js",'jsio("import util.jsonSchema");jsio("import lib.Enum;");jsio("import std.js as JS;");function ERROR(e){logger.error(e);process.exit(1)}function addAlso(e,d,b){if(typeof d=="string")e[d]=b;else logger.warn("Key specified in option",e.name,"is invalid.  Ignoring:",d)}var truthyValues=lib.Enum("true","1","yes"),falsyValues=lib.Enum("false","0","no");\nfunction addArg(e,d,b,a){var c,g=b[a];d=d[b[a]];var h=b.length,f=d.type.toLowerCase();++a;switch(f){case "boolean":if(typeof b[a]=="undefined"){c=true;--a}else if(b[a].toLowerCase()in truthyValues)c=true;else if(b[a].toLowerCase()in falsyValues)c=false;else{c=true;--a}break;case "int":case "integer":c=parseInt(b[a]);break;case "float":case "double":case "number":c=parseFloat(b[a]);break;case "array":case "object":for(f=b[a];;){try{c=eval("("+f+")");break}catch(i){}++a;a>=h&&ERROR(\'Could not parse "\'+\ng+\'": \'+d.type+"\\n"+f+"\\n"+JSON.stringify(b));f+=b[a]}break;case "any":case "string":default:c=b[a];break}h=util.jsonSchema.validate(c,d);if(h.valid){e[d.name]=c;return a+1}else{e=[];for(c=0;f=h.errors[c];++c)e.push("\\n\\t\\t"+(f.property?f.property+": ":"")+f.message);ERROR("\\n"+g+": provided value "+b[a]+"\\n\\t"+d.name+" option:"+e.join(""))}}\nexports=function(e,d){var b=JS.shallowCopy(d),a={};for(var c in b){var g=b[c];if("default"in g)a[g.name]=g["default"];var h=g.also;if(h)if(JS.isArray(h))for(var f=0,i=h.length;f<i;++f)addAlso(b,h[f],g);else addAlso(b,h,g)}g=[];c=0;for(i=e.length;c<i;)if(e[c]in b)c=addArg(a,b,e,c);else{g.push(e[c]);c++}return{args:g,opts:a}};\nexports.printUsage=function(e,d){jsio("import util.wordWrap;");var b=jsio.__env.log;b("Usage:");b("\\t"+e);b("Options:");for(var a in d){var c=[a];if(d[a].also)if(JS.isArray(d[a].also))c=c.concat(d[a].also);else c.push(d[a].also);b("\\t"+c.join(", "));d[a].description&&b(util.wordWrap(d[a].description,80,"\\t\\t"))}};\n');
jsio.setCachedSrc("../../packages/util/jsonSchema.js",'jsio("import std.js as JS;");exports={validate:validate,checkPropertyChange:function(b,a,f){return validate(b,a,f||"property")}};var gCheckPropChange=false;function validate(b,a,f){gCheckPropChange=f;a=a?checkProp(b,a,"",f||""):[];!f&&b&&b.$schema&&checkProp(b,b.$schema,"","",a);return{valid:!a.length,errors:a}}\nfunction checkProp(b,a,f,d,e){function c(j){e.push({property:f,message:j})}e||(e=[]);f+=f?typeof d=="number"?"["+d+"]":typeof d=="undefined"?"":"."+d:d;var g=typeof a,h=g=="function";if((g!="object"||JS.isArray(a))&&(f||!h)){if(h)b instanceof a||c("is not an instance of the class/constructor "+a.name);else a&&c("Invalid schema/property definition "+a);return e}gCheckPropChange&&a.readonly&&c("is a readonly field, it can not be changed");a["extends"]&&checkProp(b,a["extends"],f,d,e);if(b===undefined)a.optional||\nc("is missing and it is not optional");else{e=e.concat(checkType(a.type,b));a.disallow&&!checkType(a.disallow,b).length&&c(" disallowed value was matched");if(b!==null){if(JS.isArray(b)){if(a.items)if(JS.isArray(a.items)){d=0;for(g=b.length;d<g;d++)e.concat(checkProp(b[d],a.items[d],f,d,e))}else{d=0;for(g=b.length;d<g;d++)e.concat(checkProp(b[d],a.items,f,d,e))}a.minItems&&b.length<a.minItems&&c("There must be a minimum of "+a.minItems+" in the array");a.maxItems&&b.length>a.maxItems&&c("There must be a maximum of "+\na.maxItems+" in the array")}else a.properties&&e.concat(checkObj(b,a.properties,f,a.additionalProperties,e));a.pattern&&typeof b=="string"&&!b.match(a.pattern)&&c("does not match the regex pattern "+a.pattern);a.maxLength&&typeof b=="string"&&b.length>a.maxLength&&c("may only be "+a.maxLength+" characters long");a.minLength&&typeof b=="string"&&b.length<a.minLength&&c("must be at least "+a.minLength+" characters long");typeof a.minimum!==undefined&&typeof b==typeof a.minimum&&a.minimum>b&&c("must have a minimum value of "+\na.minimum);typeof a.maximum!==undefined&&typeof b==typeof a.maximum&&a.maximum<b&&c("must have a maximum value of "+a.maximum);if(a["enum"]){d=a["enum"];var i;g=d.length;for(h=0;h<g;h++)if(d[h]===b){i=1;break}i||c("does not have a value in the enumeration "+d.join(", "))}typeof a.maxDecimal=="number"&&b.toString().match(RegExp("\\\\.[0-9]{"+(a.maxDecimal+1)+",}"))&&c("may only have "+a.maxDecimal+" digits of decimal places")}}return e}\nfunction checkObj(b,a,f,d,e){if(typeof a=="object"){if(typeof b!="object"||JS.isArray(b))e.push({property:f,message:"an object is required"});for(var c in a)if(a.hasOwnProperty(c)&&!(c.charAt(0)=="_"&&c.charAt(1)=="_")){var g=b[c];checkProp(g,a[c],f,c,e)}}for(c in b){b.hasOwnProperty(c)&&!(c.charAt(0)=="_"&&c.charAt(1)=="_")&&a&&!a[c]&&d===false&&e.push({property:f,message:typeof g+"The property "+c+" is not defined in the schema and the schema does not allow additional properties"});(g=a&&a[c]&&\na[c].requires)&&!(g in b)&&e.push({property:f,message:"the presence of the property "+c+" requires that "+g+" also be present"});g=b[c];a&&typeof a=="object"&&!(c in a)&&checkProp(g,d,f,c,e);if(!gCheckPropChange&&g&&g.$schema)e=e.concat(checkProp(g,g.$schema,f,c,e))}return e}\nfunction checkType(b,a,f){if(b){var d=typeof a;if(typeof b=="string"){b=b.toLowerCase();switch(b){case "any":return[];case "array":if(!JS.isArray(a))return[{property:path,message:"expected an array, but "+d+" found instead"}];break;case "integer":case "int":break;case "float":case "double":case "number":b="number";default:if(d!=b)return[{property:path,message:"expected "+b+", but "+d+" found instead"}];break}return[]}if(JS.isArray(b)){d=[];for(var e=0;e<b.length;e++){var c=checkType(b[e],a,f);if(!c.length)return[];\nd=d.concat(c)}return d}else if(typeof b=="object")return checkProp(a,b,path)}return[]};\n');
jsio.setCachedSrc("../../packages/lib/Enum.js",'exports=function(){if(arguments.length==1)if(typeof arguments[0]=="object"){var b=arguments[0];for(var a in b)b[a]in b||(b[b[a]]=a);return b}else if(typeof arguments[0]!="string")c=arguments[0];if(!c)var c=arguments;b={};a=0;for(var d=c.length;a<d;++a){if(c[a])b[c[a]]=a+1;b[a+1]=c[a]}return b};\n');jsio.setCachedSrc("../../packages/util/wordWrap.js",'exports=function(a,d,c,g){function k(){e[f]=c+b.str.join(" ");++f}c=c||"";d-=exports.getLengthWithTabs(c,g);if(!d)return c+a;a=a.split(" ");g=a.length;for(var e=[{str:[],len:0}],f=0,b=e[f],h=0;h<g;++h){var i=a[h],j=i.length;if(b.len&&b.len+j+1>d){k();b=e[f]={str:[i],len:j}}else{b.str.push(i);b.len&&b.len++;b.len+=j}}b.len?k():e.pop();return e.join("\\n")};exports.getLengthWithTabs=function(a,d){var c=0;a=a.replace(/\\t/g,function(){++c});return a.length+c*(d||8)};\n');
jsio.setCachedSrc("./optsDef.js",'exports={"-g":{also:"--compressResult",name:"compressResult",type:"boolean",description:"Compress final output with Google\'s Closure Compiler"},"-c":{also:"--compress",name:"compressSources",type:"boolean","default":false,description:"Compress individual source files with Google\'s Closure Compiler"},"--closure":{name:"closurePath",type:"string",description:"Path to closure.jar, if using compression (default: cwd)"},"-d":{also:"--debug",name:"debug",type:"integer",minimum:0,maximum:5,constants:{DEBUG:1,\nLOG:2,INFO:3,WARN:4,ERROR:5},description:"Turn on the compiler logger. A value of i logs all levels i and higher. 1: DEBUG, 2: LOG, 3: INFO, 4: WARN, 5: ERROR"},"--dynamic":{name:"dynamicImports",type:"object",description:"Specify dynamic jsio imports"},"-p":{name:"package",also:"--package",type:"object",description:"Specifies a package file.  The compiler looks for configuration parameters from the command line as well as the package file.  Command line options have precedence over package settings provided in the package file."},\n"-j":{name:"jsioPath",type:"string",also:"--jsio",description:"Provides an alternative path for jsio.  This path must contain the file \'jsio.js\'.  The compiler contains a copy of jsio, so this is optional (can be used to compile against custom versions of jsio)."},"--path":{name:"path",type:"array",description:"Provide extra paths (follow --path with a JSON literal array of strings)"},"-o":{name:"outputFile",type:"string",also:"--output",description:"The filename to write the compiled code to.  Defaults to stdout (prints to the console)."},\n"--preserveJsioSource":{name:"preserveJsioSource",type:"boolean","default":false,description:"(advanced option) Specify this option if the compiler shouldn\'t modify the core jsio JavaScript.  This option wraps compiled source in the jsio API call setCachedSrc rather than inserting the source into the jsio cache table."},"--includeJsio":{name:"includeJsio",type:"boolean","default":true,description:"(advanced option) Defaults to true.  Set to false to exclude jsio from the resulting source.  Setting to false enables --preserveJsioSource."},\n"--appendImport":{name:"appendImport",type:"boolean","default":true,description:"Defaults to true.  When true, the import statement passed to the compiler is appended to the end of the file."},"--compressorCachePath":{name:"compressorCachePath",type:"string",description:"Provide a path to cache compressed source."},"--help":{type:"boolean",description:"prints this help message"}};\n');
jsio.setCachedSrc("../../packages/lib/Callback.js",'jsio("import std.js as JS;");\nexports=Class(function(){this.init=function(){this._fired=false;this._run=[];this._pending=this._id=0;this._stat={}};this.fired=function(){return this._fired};this.reset=function(){this._args=[];this._fired=false};this.clear=function(){this.reset();this._run=[]};this.forward=function(a){this.run.apply(this,a)};this.run=function(a,b){var c=b?bind.apply(this,arguments):a;if(c)this._fired?c.apply(this,this._args):this._run.push(c);return this};this.fire=function(){if(!this._fired){this._fired=true;var a=\nthis._run;this._run=[];this._args=arguments;for(var b=0,c=a.length;b<c;++b)a[b]&&a[b].apply(this,arguments)}};this.chain=function(a){++this._pending;this.reset();return bind(this,"_deferred",a||this._id++)};this._deferred=function(a){if(!this._stat.hasOwnProperty(a)){this._stat[a]=JS.vargs(arguments,1);this._pending&&--this._pending;this._pending||this.fire(this._stat)}}});\n');
jsio.setCachedSrc("../../packages/lib/Hash.js",'exports=Class(function(){this.init=function(){this._keys={};this._dict={};this._values={};if(arguments.length==1&&typeof arguments=="object"){var a=arguments[0];for(var b in a)if(a.hasOwnProperty(b)){this._keys[b]=true;this._values[b]=a[b]}}else{b=0;for(a=arguments.length;b<a;b++){this._keys[arguments[b]]=true;this._values[arguments[b]]=true}}};this.contains=function(a){return this._values.hasOwnProperty(a)};this.hasKey=this.containsKey=function(a){return this._keys.hasOwnProperty(a)};this.each=function(a,\nb){for(var c in keys)if(this._keys.hasOwnProperty(c))a.call(b||GLOBAL,c,this._values[c],this)}});\n');
jsio.setCachedSrc("../../packages/lib/Iterator.js",'jsio("import std.js as JS;");\nexports=Class(function(){this.init=function(a){this._src=a;this._calls=this._i=0;if(JS.isArray(a))this._isArray=true;else if(Object.keys)this._keys=Object.keys(a);else{var b=this._keys=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c)}};this.nextKey=function(){return this._keys[this._i++]};this.next=function(){if(this._isArray)return this._src[this._i++]||exports.END_OF_LOOP;else{var a=this._keys[this._i++];return a?this._src[a]:exports.END_OF_LOOP}};this.loop=function(a){if(arguments.length>1)a=bind.apply(this,\narguments);var b;if(this._isArray)for(;b=this.next();)a(b);else for(;b=this.nextKey();)a(this._src[b],b)};this.asyncLoop=function(a){if(arguments.length>1)a=bind.apply(this,arguments);this._next=bind(this,"_onReturn",a);this._calls++;this._asyncLoop(a)};this._asyncLoop=function(a){for(this._inLoop=true;this._calls;){--this._calls;a(this.next(),this._next)}this._inLoop=false};this._onReturn=function(a){this._calls++;this._inLoop||this._asyncLoop(a)}});exports.END_OF_LOOP=Error("jsio.Iterator.END_OF_LOOP");\n');
jsio.setCachedSrc("../../packages/lib/LogClass.js","exports=function(b,a,c){if(!c){c=a;a=null}var d={};b=bind(this,LogClassProto,b,c,logging.get(b),d);d.proto=b;return a?Class(a,b):Class(b)};function LogClassProto(b,a,c,d,e){a.prototype=d.proto.prototype;a=new a(c,e);a.__class__=b;return a};\n");jsio.setCachedSrc("../../packages/lib/PubSub.js","var ctx=jsio.__env.global,SLICE=Array.prototype.slice;\nexports=Class(function(){this.init=function(){};this.publish=function(b){if(this._subscribers){var d=SLICE.call(arguments,1);if(this._subscribers.__any)for(var e=[b].concat(d),a=this._subscribers.__any.slice(0),c=0,f;f=a[c];++c)f.apply(ctx,e);if(!this._subscribers[b])return;a=this._subscribers[b].slice(0);for(c=0;f=a[c];++c)f.apply(ctx,d)}return this};this.subscribe=function(b,d,e){var a;if(arguments.length==2)a=d;else{a=bind.apply(GLOBAL,SLICE.call(arguments,1));a._ctx=d;a._method=e}var c=this._subscribers||\n(this._subscribers={});(c[b]||(c[b]=[])).push(a);return this};this.subscribeOnce=function(b,d){var e=arguments,a=bind(this,function(){this.unsubscribe(this,a);e.length==2?d.apply(GLOBAL,arguments):bind.apply(GLOBAL,SLICE.call(e,1)).apply(GLOBAL,arguments)});return this.subscribe(b,a)};this.unsubscribe=function(b,d,e){if(this._subscribers&&this._subscribers[b]){b=this._subscribers[b];for(var a=0,c;c=b[a];++a)if(c==d||c._ctx==d&&(!e||c._method==e))b.splice(a--,1);return this}}});\n");
jsio.setCachedSrc("../../packages/lib/Resource.js","exports=Class(function(){this.init=function(a){a=a||{};if(a.key){this._key=a.key;this._keyed={}}this._creator=a.creator||function(){return{}};this._count=0;this._limit=a.limit||-1;this._queue=[]};this.create=function(){if(this._limit<0||this._count<this._limit){var a=this._creator();this._queue.push(a);if(this._key)this._keyed[a[this._key]]=a;return a}return false};this.get=function(a){if(a&&this._keyed)return this._keyed[a];if(!this._queue.length)if(this.create()!==false)return false;return this._queue.unshift()}});\n");
jsio.setCachedSrc("../../packages/lib/sort.js",'var zeroPadding=[];function ensurePadding(d){for(var e=zeroPadding.length;e<d;++e){for(var c=[],b=0;b<e;++b)c.push("0");zeroPadding[e]=c.join("")}}function sortIndex(d){return this[d]}\nexports=function(d,e){var c=d.length,b=Array(c),g=Array(c),k=Array(c),m=Array.prototype.slice.call(arguments,1),l=!!m[1];if(l)for(var a=0;a<c;++a)g[a]=[];for(var n=0;e=m[n];++n){for(a=0;a<c;++a)b[a]=e.call(d[a],a);if(typeof b[0]=="number"){var h=b[0],i=b[0];for(a=1;a<c;++a)if(b[a]>h)h=b[a];else if(b[a]<i)i=b[a];h=String(Math.floor(h)).length;var o=String(Math.floor(i)).length;ensurePadding(Math.max(h,o));var j;for(a=0;a<c;++a){var f=b[a];if(f<0){f=-(i-f);j=(""+Math.floor(f)).length;b[a]="-"+zeroPadding[o-\nj]+f}else{j=(""+Math.floor(f)).length;b[a]=zeroPadding[h-j]+f}}}if(l)for(a=0;a<c;++a)g[a].push(b[a]);else g=b}for(a=0;a<c;++a){if(l)g[a]=g[a].join("|");k[a]=d[a].hasOwnProperty("toString")&&d[a].toString||null;d[a].toString=bind(g,sortIndex,a)}Array.prototype.sort.apply(d);for(a=0;a<c;++a)if(k[a])d[a].toString=k[a];else delete d[a].toString};\n');
jsio.setCachedSrc("../../packages/lib/Sortable.js",'jsio("import .LogClass;");exports=LogClass("lib.Sortable",function(){this.toStringPush=function(c){if(!this._toString||!this._toString.push)this._toString=[this.toString];else this._toString.push(this.toString);this.toString=c};this.toStringPop=function(){this.toString=this._toString.pop()}});var zeroPadding=[];function ensurePadding(c){for(var e=zeroPadding.length;e<c;++e){for(var d=[],b=0;b<e;++b)d.push("0");zeroPadding[e]=d.join("")}}function sortIndex(c){return this[c]}\nexports.sort=function(c,e){var d=c.length,b=Array(d),g=Array(d),k=Array(d),m=Array.prototype.slice.call(arguments,1),l=!!m[1];if(l)for(var a=0;a<d;++a)g[a]=[];for(var n=0;e=m[n];++n){for(a=0;a<d;++a)b[a]=e.call(c[a],a);if(typeof b[0]=="number"){var h=b[0],i=b[0];for(a=1;a<d;++a)if(b[a]>h)h=b[a];else if(b[a]<i)i=b[a];h=String(Math.floor(h)).length;var o=String(Math.floor(i)).length;ensurePadding(Math.max(h,o));var j;for(a=0;a<d;++a){var f=b[a];if(f<0){f=-(i-f);j=(""+Math.floor(f)).length;b[a]="-"+\nzeroPadding[o-j]+f}else{j=(""+Math.floor(f)).length;b[a]=zeroPadding[h-j]+f}}}if(l)for(a=0;a<d;++a)g[a].push(b[a]);else g=b}for(a=0;a<d;++a){if(l)g[a]=g[a].join("|");k[a]=c[a].hasOwnProperty("toString")&&c[a].toString||null;c[a].toString=bind(g,sortIndex,a)}Array.prototype.sort.apply(c);for(a=0;a<d;++a)if(k[a])c[a].toString=k[a];else delete c[a].toString};\n');
jsio.setCachedSrc("../../packages/math/arrays.js",'jsio("import .util");exports.weightedAverage=function(b,e,c){c=c||b.length;for(var d=0,a=c-1;a>=0;--a)d+=b[a]*e;return d/c};exports.subtract=function(b,e){for(var c=b.length,d=Array(c),a=0;a<c;++a)d[a]=e[a]-b[a];return d};exports.average=function(b,e){e=e||b.length;for(var c=0,d=e-1;d>=0;--d)c+=b[d];return c/e};exports.stddev=function(b,e){var c=exports.average(b,e);e=e||b.length;for(var d=0,a=e-1;a>=0;--a){var f=b[a]-c;d+=f*f}return Math.sqrt(d/(e-1))};\nexports.shuffle=function(b,e){for(var c=b.length,d=0;d<c;++d){var a=util.random(d,c,e),f=b[a];b[a]=b[d];b[d]=f}return b};exports.rotate=function(b,e){var c=b.length,d=Array(c),a=e%c;if(a<0){a%=c;if(a)a+=c}for(var f=0;f<c;++f){d[f]=b[a];a=(a+1)%c}return d};\n');
jsio.setCachedSrc("../../packages/math/util.js",'jsio("import lib.Enum as Enum");exports.interpolate=function(a,d,c){return a*(1-c)+d*c};exports.random=function(a,d,c){return a+((c||Math.random)()*(d-a)|0)};exports.randomInclusive=function(a,d,c){return exports.random(a,d+1,c)};exports.rand=Math.random;exports.integer=exports.truncate=function(a){return a|0};exports.clip=function(a,d,c){return Math.max(Math.min(a,c),d)};\nvar round=exports.round=function(a,d,c){if(!c||c==round.ROUND_HALF_AWAY_FROM_ZERO)return a.toFixed(d);if(!d){var b=a|0,e=a-b;half=e==0.5||e==-0.5;if(!half)return Math.round(a);e=a<0?-1:1;switch(c){case round.ROUND_HALF_TO_EVEN:return b%2?b+e:b;case round.ROUND_HALF_TO_ODD:return b%2?b:b+e;case round.ROUND_HALF_STOCHASTIC:return Math.random()<0.5?b+e:b;case round.ROUND_HALF_ALTERNATE:return(round.alt=!round.alt)?b+e:b}}b=a|0;e=a-b;p=Math.pow(10,d);return(b+round(e*p,0,c)/p).toFixed(d)};round.alt=true;\nEnum.call(round,"ROUND_HALF_UP","ROUND_HALF_AWAY_FROM_ZERO","ROUND_HALF_TO_EVEN","ROUND_HALF_STOCHASTIC","ROUND_HALF_ALTERNATE");\n');
jsio.setCachedSrc("../../packages/math2D/angle.js","var PI=Math.PI,TWOPI=Math.PI*2;exports.average=function(a,c,b){if(b===undefined)b=0.5;var d=exports.getRange(a,c);a=d<PI?a+d*(1-b):c+(2*PI-d)*b;return a>PI?a-2*PI:a<-PI?a+2*PI:a};exports.normalize=function(a){for(;a<-PI;)a+=2*PI;for(;a>PI;)a-=2*PI;return a};exports.add=function(a,c){var b=a+c;return b>PI?b-TWOPI:b<-PI?b+TWOPI:b};exports.difference=function(a,c){var b=exports.getRange(a,c);return b>PI?b-TWOPI:b};exports.getRange=function(a,c){var b=c-a;return b<0?b+TWOPI:b};\n");
jsio.setCachedSrc("../../packages/math2D/Circle.js",'jsio("import .Point;");exports=Class(Point,function(b){this.init=function(a,c,d){switch(arguments.length){case 0:this.radius=this.y=this.x=0;break;case 1:case 2:this.x=a.x||0;this.y=a.y||0;this.radius=a.radius||0;break;case 3:this.x=a;this.y=c;this.radius=d;break}};this.scale=function(a){b(this,"scale",arguments);this.radius*=a;return this}});\n');jsio.setCachedSrc("../../packages/math2D/Point.js",'var Point=exports=Class(function(){this.init=function(a,b){switch(arguments.length){case 0:this.y=this.x=0;break;case 1:this.x=a.x||0;this.y=a.y||0;break;case 2:this.x=a||0;this.y=b||0;break}};this.rotate=function(a){var b=this.x,c=this.y,d=Math.cos(a);a=Math.sin(a);this.x=b*d-c*a;this.y=b*a+c*d;return this};this.translate=this.add=function(a,b){if(typeof a=="number"){this.x+=a;this.y+=b}else{this.x+=a.x;this.y+=a.y}return this};this.subtract=function(a,b){if(typeof a=="number"){this.x-=a;this.y-=\nb}else{this.x-=a.x;this.y-=a.y}return this};this.scale=function(a){this.x*=a;this.y*=a;return this};this.setMagnitude=function(a){var b=Math.atan2(this.y,this.x);this.x=a*Math.cos(b);this.y=a*Math.sin(b);return this};this.normalize=function(){var a=this.getMagnitude();this.x/=a;this.y/=a;return this};this.addMagnitude=function(a){return this.setMagnitude(this.getMagnitude()+a)};this.getMagnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};this.getSquaredMagnitude=function(){return this.x*\nthis.x+this.y*this.y};this.getDirection=this.getAngle=function(){return Math.atan2(this.y,this.x)}});Point.getPolarR=function(){throw"notImplemented";};Point.getPolarTheta=function(a,b){var c=Math.atan2(b,a)+Math.PI*2;return c>Math.PI*2?c%(Math.PI*2):c};Point.add=Point.translate=function(a,b,c,d){switch(arguments.length){case 2:return(new Point(a)).add(b);case 3:return(new Point(a)).add(b,c);case 4:return(new Point(a,b)).add(c,d)}};\nPoint.subtract=function(a,b,c,d){switch(arguments.length){case 2:return(new Point(a)).subtract(b);case 3:return(new Point(a)).subtract(b,c);case 4:return(new Point(a,b)).subtract(c,d)}};Point.scale=function(a,b,c){switch(arguments.length){case 2:return(new Point(a)).scale(b);case 3:return(new Point(a,b)).scale(c)}};Point.setMagnitude=function(a,b,c){switch(arguments.length){case 2:return(new Point(a)).setMagnitude(c);case 3:return(new Point(a,b)).setMagnitude(c)}};\nPoint.addMagnitude=function(a,b,c){switch(arguments.length){case 2:pt=new Point(a);break;case 3:pt=new Point(a,b);b=c;break}return pt.addMagnitude(b)};Point.getMagnitude=function(a,b){return(new Point(a,b)).getMagnitude()};Point.rotate=function(a,b,c){switch(arguments.length){case 2:return(new Point(a)).rotate(b);case 3:return(new Point(a,b)).rotate(c)}};\n');
jsio.setCachedSrc("../../packages/math2D/intersect.js",'jsio("import .Point;");jsio("import .Line;");jsio("import .Rect;");var intersect=exports;intersect.rectAndPt=function(b,a){return intersect.ptAndRect(a,b)};intersect.ptAndRect=function(b,a){var c=b.x,d=b.y;return c>=a.x&&c<=a.x+a.width&&d>=a.y&&d<=a.y+a.height};intersect.circAndPt=function(b,a){return intersect.ptAndCirc(a,b)};intersect.ptAndCirc=function(b,a){var c=b.x-a.x,d=b.y-a.y;return c*c+d*d<a.radius*a.radius};\nintersect.rectAndRect=function(b,a){return!(b.y+b.height<a.y||a.y+a.height<b.y||b.x+b.width<a.x||a.x+a.width<b.x)};var SIDES=Rect.SIDES;intersect.rectAndCircle=function(b,a){return intersect.rectAndCircle(a,circ)};intersect.circleAndRect=function(b,a){if(intersect.ptAndRect(b,a))return true;return intersect.lineAndCircle(a.getSide(1),b)||intersect.lineAndCircle(a.getSide(2),b)||intersect.lineAndCircle(a.getSide(3),b)||intersect.lineAndCircle(a.getSide(4),b)};\nintersect.circleAndLine=function(b,a){return intersect.lineAndCircle(a,b)};intersect.lineAndCircle=function(b,a){return intersect.util.ptToLine(a,b).getMagnitude()<a.radius};intersect.util={};intersect.util.ptToLine=function(b,a){var c=a.end.x-a.start.x,d=a.end.y-a.start.y,e=((b.x-a.start.x)*c+(b.y-a.start.y)*d)/(c*c+d*d);c=e<0?new Point(a.start):e>1?new Point(a.end):new Point(a.start.x+e*c,a.start.y+e*d);return new Line(c,b)};\nintersect.util.rectAndRect=function(b,a){if(intersect.rectAndRect(b,a)){var c=Math.max(b.x,a.x),d=Math.max(b.y,a.y);return new Rect(c,d,Math.min(b.x+b.width,a.x+a.width)-c,Math.min(b.y+b.height,a.y+a.height)-d)}return null};\n');
jsio.setCachedSrc("../../packages/math2D/Line.js",'jsio("import .Point;");\nexports=Class(function(){this.init=function(a,b,c,d){switch(arguments.length){case 0:this.start=new Point;this.end=new Point;break;case 1:this.start=new Point(a.start);this.end=new Point(a.end);break;case 2:this.start=new Point(a);this.end=new Point(b);break;case 3:this.start=new Point(a);this.end=new Point(b,c);break;case 4:default:this.start=new Point(a,b);this.end=new Point(c,d);break}};this.getMagnitude=this.getLength=function(){var a=this.end.x-this.start.x,b=this.end.y-this.start.y;return Math.sqrt(a*\na+b*b)}});\n');
jsio.setCachedSrc("../../packages/math2D/Rect.js",'jsio("import lib.Enum;");jsio("import .Point;");jsio("import .Line;");\nvar Rect=exports=Class(function(){this.init=function(a,b,c,d){switch(arguments.length){case 0:this.width=this.height=this.x=this.y=0;break;case 1:this.width=a.width;this.height=a.height;this.x=a.x;this.y=a.y;break;case 2:this.x=a.x;this.y=a.y;this.width=b.x;this.height=b.y;break;case 3:this.x=a.x;this.y=a.y;this.width=b;this.height=c;break;case 4:this.x=a;this.y=b;this.width=c;this.height=d;break}};this.normalize=function(){if(this.width<0){this.x-=this.width;this.width=-this.width}if(this.height<\n0){this.y-=this.height;this.height=-this.height}return this};this.unionRect=function(a){this.normalize();a.normalize&&a.normalize();var b=this.x+this.width,c=this.y+this.height,d=a.x+a.width,e=a.y+a.height;this.x=this.x<a.x?this.x:a.x;this.y=this.y<a.y?this.y:a.y;this.width=(b>d?b:d)-this.x;this.height=(c>e?c:e)-this.y};this.getCorner=function(a){switch(a){case CORNERS.TOP_LEFT:return new Point(this.x,this.y);case CORNERS.TOP_RIGHT:return new Point(this.x+this.width,this.y);case CORNERS.BOTTOM_LEFT:return new Point(this.x,\nthis.y+this.height);case CORNERS.BOTTOM_RIGHT:return new Point(this.x+this.width,this.y+this.height)}};this.getSide=function(a){switch(a){case SIDES.TOP:return new Line(this.getCorner(CORNERS.TOP_LEFT),this.getCorner(CORNERS.TOP_RIGHT));case SIDES.RIGHT:return new Line(this.getCorner(CORNERS.TOP_RIGHT),this.getCorner(CORNERS.BOTTOM_RIGHT));case SIDES.BOTTOM:return new Line(this.getCorner(CORNERS.BOTTOM_RIGHT),this.getCorner(CORNERS.BOTTOM_LEFT));case SIDES.LEFT:return new Line(this.getCorner(CORNERS.BOTTOM_LEFT),\nthis.getCorner(CORNERS.TOP_LEFT))}};this.getCenter=function(){return new Point(this.x+this.width/2,this.y+this.height/2)}}),SIDES=Rect.SIDES=lib.Enum("TOP","BOTTOM","LEFT","RIGHT"),CORNERS=Rect.CORNERS=lib.Enum("TOP_LEFT","TOP_RIGHT","BOTTOM_RIGHT","BOTTOM_LEFT");\n');
jsio.setCachedSrc("../../packages/math2D/morphology.js",'exports.open=function(a,b){return exports.dilate(exports.erode(a,b),b)};exports.close=function(a,b){return exports.erode(exports.dilate(a,b),b)};exports.getSquareMask=function(a){a%2==0&&a++;for(var b=[],e=0;e<a;++e){b[e]=[];for(var d=0;d<a;++d)b[e][d]=1}return b};exports.getCircleMask=function(a){a%2==0&&a++;for(var b=[],e=a/2-0.5,d=0;d<a;++d){b[d]=[];for(var c=0;c<a;++c){var f=c-e,h=d-e;b[d][c]=Math.sqrt(f*f+h*h)<=e?1:0}}return b};\nexports.multiply=function(a,b){for(var e=a.width,d=a.height,c=0;c<d;++c)for(var f=0;f<e;++f)a[c][f]*=b;return a};exports.subtract=function(a,b){for(var e=Math.min(a.width,b.width),d=Math.min(a.height,b.height),c=0;c<d;++c)for(var f=0;f<e;++f)a[c][f]-=b[c][f];return a};\nexports.erode=function(a,b){logger.info("erode");var e=(b.length-1)/2,d=(b[0].length-1)/2,c=[],f=a.width,h=a.height;c.width=f;c.height=h;for(var g=0;g<h;++g){c[g]=[];for(var i=0;i<f;++i){for(var n=true,j=-e;j<e+1;++j)for(var k=-d;k<d+1;++k){var l=i+j,m=g+k;b[k+d][j+e]&&(n&=l>=0&&l<f&&m>=0&&m<h&&a[m][l])}c[g][i]=n&&255}}return c};\nexports.dilate=function(a,b){logger.info("dilate");var e=(b.length-1)/2,d=(b[0].length-1)/2,c=[],f=a.width,h=a.height;c.width=f;c.height=h;for(var g=0;g<h;++g){c[g]=[];for(var i=0;i<f;++i){for(var n=false,j=-e;j<e+1;++j)for(var k=-d;k<d+1;++k){var l=i+j,m=g+k;n|=l>=0&&l<f&&m>=0&&m<h&&b[k+d][j+e]&&a[m][l]}c[g][i]=n&&255}}return c};\n');
jsio.setCachedSrc("../../packages/math2D/Vec2D.js",'var Vec2D=exports=Class(function(){this.init=function(a){if("angle"in a){this.x=a.magnitude*Math.cos(a.angle);this.y=a.magnitude*Math.sin(a.angle)}else{this.x=a.x;this.y=a.y}};this.addForce=function(a){this.x+=a.x;this.y+=a.y};this.getAngle=function(){return Math.atan2(this.y,this.x)};this.getMagnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};this.getUnitVector=function(){var a=this.getAngle();return new Vec2D({magnitude:1,angle:a})};this.dot=function(a){return this.x*a.x+this.y*\na.y};this.add=function(a){return new Vec2D({x:this.x+a.x,y:this.y+a.y})};this.minus=function(a){return new Vec2D({x:this.x-a.x,y:this.y-a.y})};this.negate=function(){return new Vec2D({x:-this.x,y:-this.y})};this.multiply=function(a){return new Vec2D({angle:this.getAngle(),magnitude:this.getMagnitude()*a})}});\n');
jsio.setCachedSrc("../../packages/net/csp/client.js",'jsio("import std.base64 as base64");jsio("import std.utf8 as utf8");jsio("import std.uri as uri");jsio("import net.errors as errors");jsio("import .transports");jsio("import lib.Enum as Enum");var READYSTATE=exports.READYSTATE=Enum({INITIAL:0,CONNECTING:1,CONNECTED:2,DISCONNECTING:3,DISCONNECTED:4});\nexports.CometSession=Class(function(){var f=0;this.init=function(){this._id=++f;this._url=null;this.readyState=READYSTATE.INITIAL;this._options=this._transport=this._sessionKey=null;this._writeBuffer=this._utf8ReadBuffer="";this._handshakeLater=this._lastSentId=this._lastEventId=this._packetsInFlight=null;this._handshakeBackoff=50;this._timeoutTimer=this._handshakeTimeoutTimer=this._handshakeRetryTimer=null;this._cometBackoff=this._writeBackoff=50;this._nullReceived=this._nullSent=this._nullInFlight=\nthis._nullInBuffer=false};this.setEncoding=function(a){if(a!=this._options.encoding){if(a!="utf8"&&a!="plain")throw new errors.InvalidEncodingError;if(a=="plain"&&this._buffer){var b=this._utf8ReadBuffer;this._utf8ReadBuffer="";this._doOnRead(b)}this._options.encoding=a}};this.connect=function(a,b){this._url=a.replace(/\\/$/,"");this._options=b||{};this._options.encoding=this._options.encoding||"utf8";this.setEncoding(this._options.encoding);this._options.connectTimeout=this._options.connectTimeout||\n1E4;this._transport=new (transports.chooseTransport(a,this._options));this._transport.handshakeFailure=bind(this,this._handshakeFailure);this._transport.handshakeSuccess=bind(this,this._handshakeSuccess);this._transport.cometFailure=bind(this,this._cometFailure);this._transport.cometSuccess=bind(this,this._cometSuccess);this._transport.sendFailure=bind(this,this._writeFailure);this._transport.sendSuccess=bind(this,this._writeSuccess);this.readyState=READYSTATE.CONNECTING;this._transport.handshake(this._url,\nthis._options);this._handshakeTimeoutTimer=setTimeout(bind(this,this._handshakeTimeout),this._options.connectTimeout)};this.write=function(a,b){if(this.readyState!=READYSTATE.CONNECTED)throw new errors.ReadyStateError;b=b||this._options.encoding||"utf8";if(b=="utf8")a=utf8.encode(a);this._writeBuffer+=a;this._doWrite()};this._protocolError=function(a){logger.debug("_protocolError",a);this.readyState=READYSTATE.DISCONNECTED;this._doWrite(true);this._doOnDisconnect(new errors.ServerProtocolError(a))};\nthis._receivedNullPacket=function(){logger.debug("_receivedNullPacket");this._receivedNull=true;if(this._nullInFlight||this._nullInBuffer||this._nullSent)this.readyState=READYSTATE.DISCONNECTED;else{this.readyState=READYSTATE.DISCONNECTING;this._doWrite(true)}this._doOnDisconnect(new errors.ConnectionClosedCleanly)};this._sentNullPacket=function(){logger.debug("_sentNullPacket");if((this._nullSent=true)&&this._nullReceived)this.readyState=READYSTATE.DISCONNECTED};this.close=function(a){logger.debug("close called",\na,"readyState",this.readyState);switch(this.readyState){case READYSTATE.CONNECTING:clearTimeout(this._handshakeRetryTimer);clearTimeout(this._handshakeTimeoutTimer);this.readyState=READYSTATE.DISCONNECTED;this._doOnDisconnect(a);break;case READYSTATE.CONNECTED:this.readyState=READYSTATE.DISCONNECTING;this._doWrite(true);clearTimeout(this._timeoutTimer);break;case READYSTATE.DISCONNECTED:throw new errors.ReadyStateError("Session is already disconnected");}this._sessionKey=null;this._opened=false;this.readyState=\nREADYSTATE.DISCONNECTED;this._doOnDisconnect(a)};this._handshakeTimeout=function(){logger.debug("handshake timeout");this._handshakeTimeoutTimer=null;clearTimeout(this._handshakeRetryTimer);if(this.readyState==READYSTATE.CONNECTING)this.readyState=READYSTATE.DISCONNECTED;this._doOnDisconnect(new errors.ServerUnreachable)};this._handshakeSuccess=function(a){logger.debug("handshake success",a);if(this.readyState!=READYSTATE.CONNECTING)logger.debug("received handshake success in invalid readyState:",\nthis.readyState);else{clearTimeout(this._handshakeTimeoutTimer);this._handshakeTimeoutTimer=null;this._sessionKey=a.response.session;this._opened=true;this.readyState=READYSTATE.CONNECTED;this._doOnConnect();this._doConnectComet()}};this._handshakeFailure=function(a){logger.debug("handshake failure",a);if(this.readyState==READYSTATE.CONNECTING){if(a.status==404){clearTimeout(this._handshakeTimeoutTimer);return this._doOnDisconnect(new errors.ServerUnreachable)}logger.debug("trying again in ",this._handshakeBackoff);\nthis._handshakeRetryTimer=setTimeout(bind(this,function(){this._handshakeRetryTimer=null;this._transport.handshake(this._url,this._options)}),this._handshakeBackoff);this._handshakeBackoff*=2}};this._writeSuccess=function(){if(!(this.readyState!=READYSTATE.CONNECTED&&this.readyState!=READYSTATE.DISCONNECTING)){if(this._nullInFlight)return this._sentNullPacket();this._resetTimeoutTimer();this.writeBackoff=50;this._packetsInFlight=null;if(this._writeBuffer||this._nullInBuffer)this._doWrite(this._nullInBuffer)}};\nthis._writeFailure=function(a){if(a&&a.status==404&&a.response=="Session not found")return this.close(new errors.ExpiredSession(a));if(!(this.readyState!=READYSTATE.CONNECTED&&this.READYSTATE!=READYSTATE.DISCONNECTING)){this._writeTimer=setTimeout(bind(this,function(){this._writeTimer=null;this.__doWrite(this._nullInBuffer)}),this._writeBackoff);this._writeBackoff*=2}};this._doWrite=function(a){if(this._packetsInFlight){if(a)this._nullInBuffer=true}else this.__doWrite(a)};this.__doWrite=function(a){logger.debug("_writeBuffer:",\nthis._writeBuffer);if(!this._packetsInFlight&&this._writeBuffer){this._packetsInFlight=[this._transport.encodePacket(++this._lastSentId,this._writeBuffer,this._options)];this._writeBuffer=""}if(a&&!this._writeBuffer){if(!this._packetsInFlight)this._packetsInFlight=[];this._packetsInFlight.push([++this._lastSentId,0,null]);this._nullInFlight=true}if(this._packetsInFlight){logger.debug("sending packets:",JSON.stringify(this._packetsInFlight));this._transport.send(this._url,this._sessionKey,this._lastEventId||\n0,JSON.stringify(this._packetsInFlight),this._options)}else logger.debug("no packets to send")};this._doConnectComet=function(){logger.debug("_doConnectComet");this._transport.comet(this._url,this._sessionKey,this._lastEventId||0,this._options)};this._cometFailure=function(a){if(this.readyState==READYSTATE.CONNECTED){if(a.status==404&&a.response=="Session not found")return this.close(new errors.ExpiredSession(a));this._cometTimer=setTimeout(bind(this,"_doConnectComet"),this._cometBackoff);this._cometBackoff*=\n2}};this._cometSuccess=function(a){if(!(this.readyState!=READYSTATE.CONNECTED&&this.readyState!=READYSTATE.DISCONNECTING)){logger.debug("comet Success:",a);this._cometBackoff=50;this._resetTimeoutTimer();for(var b=a.response,d=0,c;(c=b[d])||d<b.length;d++){logger.debug("process packet:",c);if(c===null)return this.close(new errors.ServerProtocolError(a));logger.debug("process packet",c);var e=c[0],g=c[1];a=c[2];if(!(typeof this._lastEventId=="number"&&e<=this._lastEventId)){if(typeof this._lastEventId==\n"number"&&e!=this._lastEventId+1)return this._protocolError("Ack id too high");this._lastEventId=e;if(a==null)return this._receivedNullPacket();if(g==1)try{logger.debug("before base64 decode:",a);a=base64.decode(a);logger.debug("after base64 decode:",a)}catch(h){return this._protocolError("Unable to decode base64 payload")}if(this._options.encoding=="utf8"){this._utf8ReadBuffer+=a;logger.debug("before utf8 decode, _utf8ReadBuffer:",this._utf8ReadBuffer);c=utf8.decode(this._utf8ReadBuffer);a=c[0];\nthis._utf8ReadBuffer=this._utf8ReadBuffer.slice(c[1]);logger.debug("after utf8 decode, _utf8ReadBuffer:",this._utf8ReadBuffer,"data:",a)}logger.debug("dispatching data:",a);this._doOnRead(a)}}this.readyState!=READYSTATE.CONNECTED&&this.readyState!=READYSTATE.DISCONNECTING||this._doConnectComet()}};this._doOnRead=function(a){if(typeof this.onread=="function"){logger.debug("call onread function",a);this.onread(a)}else logger.debug("skipping onread callback (function missing)")};this._doOnDisconnect=\nfunction(a){if(typeof this.ondisconnect=="function"){logger.debug("call ondisconnect function",a);this.ondisconnect(a)}else logger.debug("skipping ondisconnect callback (function missing)")};this._doOnConnect=function(){if(typeof this.onconnect=="function"){logger.debug("call onconnect function");try{this.onconnect()}catch(a){logger.debug("onconnect caused errror",a);setTimeout(function(){throw a;},0)}}else logger.debug("skipping onconnect callback (function missing)")};this._resetTimeoutTimer=function(){clearTimeout(this._timeoutTimer);\nthis._timeoutTimer=setTimeout(bind(this,function(){logger.debug("connection timeout expired");this.close(new errors.ConnectionTimeout)}),this._getTimeoutInterval())};this._getTimeoutInterval=function(){return 45E3}});\n');
jsio.setCachedSrc("../../packages/std/base64.js",'for(var alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",trailingPad="=",padChar=alphabet.charAt(alphabet.length-1),decodeMap={},i=0,len=alphabet.length;i<len;i++)decodeMap[alphabet.charAt(i)]=i;var alphabet_inverse=RegExp("[^"+alphabet.replace("-","\\\\-")+"]");exports.Base64CodecError=Class(Error,function(a){this.name="Base64CodecError";this.init=function(b){a(this,"init",arguments);this.message=b}});\nvar assertOrBadInput=function(a,b){if(!a)throw new exports.Base64CodecError(b);};exports.encode=function(a){assertOrBadInput(!/[^\\x00-\\xFF]/.test(a),"Input contains out-of-range characters.");var b="\\u0000\\u0000\\u0000".slice(a.length%3||3);a+=b;for(var d=[],c=0,e=a.length;c<e;c+=3){var f=(a.charCodeAt(c)<<16)+(a.charCodeAt(c+1)<<8)+a.charCodeAt(c+2);d.push(alphabet.charAt(f>>18&63),alphabet.charAt(f>>12&63),alphabet.charAt(f>>6&63),alphabet.charAt(f&63))}d.length-=b.length;return d.join("")};\nexports.decode=function(a){logger.debug("decode",a);a=a.replace(/\\s/g,"");for(var b=a.length;a.charAt(--b)===trailingPad;);a=a.slice(0,b+1);assertOrBadInput(!alphabet_inverse.test(a),"Input contains out-of-range characters.");var d=4-(a.length%4||4),c=Array(d+1).join(padChar);a+=c;c=[];var e=b+d+1;for(b=0;b<e;b+=4){newchars=(decodeMap[a.charAt(b)]<<18)+(decodeMap[a.charAt(b+1)]<<12)+(decodeMap[a.charAt(b+2)]<<6)+decodeMap[a.charAt(b+3)];c.push(newchars>>16&255,newchars>>8&255,newchars&255)}e=c.length-=\nd;if(e>65536){a=[];for(d=b=0;b<e;){a[d++]=String.fromCharCode.apply(String,c.slice(b,b+65536));b+=65536}a=a.join("")}else a=String.fromCharCode.apply(String,c);logger.debug("decoded",a);return a};\n');
jsio.setCachedSrc("../../packages/std/utf8.js",'exports.UnicodeCodecError=function(a){this.message=a};var UnicodeCodecError=exports.UnicodeCodecError;UnicodeCodecError.prototype.toString=function(){return"UnicodeCodecError"+(this.message?": "+this.message:"")};exports.encode=function(a){try{return unescape(encodeURIComponent(a))}catch(b){throw new UnicodeCodecError("invalid input string");}};\nexports.decode=function(a){if(/[^\\x00-\\xFF]/.test(a))throw new UnicodeCodecError("invalid utf-8 bytes");var b,c;b=c=a.length;if(a.charCodeAt(b-1)>=128){for(var d=1;d<=3;d++)if(a.charCodeAt(b-d)>=192){c=b-d;break}try{decodeURIComponent(escape(a.slice(c)));c=b}catch(e){}}try{return[decodeURIComponent(escape(a.slice(0,c))),c]}catch(f){throw new UnicodeCodecError("invalid utf-8 bytes");}};\n');
jsio.setCachedSrc("../../packages/std/uri.js",'var attrs=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],URI=exports=Class(function(){this.init=function(a,c){if(a instanceof URI)for(var d=0,f;f=attrs[d];++d)this["_"+f]=a["_"+f];else{this._isStrict=c;d=exports.parse(a,c);for(f in d)this["_"+f]=d[f]}};for(var b=0,e;e=attrs[b];++b)(function(a){var c=a.charAt(0).toUpperCase()+a.slice(1);this["get"+c]=function(){return this["_"+a]};this["set"+c]=function(d){this["_"+\na]=d;return this}}).call(this,e);this.query=function(a){return exports.parseQuery(this._query)[a]};this.hash=function(a){return exports.parseQuery(this._anchor)[a]};this.addHash=function(a){var c=exports.parseQuery(this._anchor);for(var d in a)c[d]=a[d];this._anchor=exports.buildQuery(c);return this};this.addQuery=function(a){var c=exports.parseQuery(this._query);for(var d in a)c[d]=a[d];this._query=exports.buildQuery(c);return this};this.removeQuery=function(a){var c=exports.parseQuery(this._query);\nif(isArray(a))for(var d=0,f=a.length;d<f;++d)delete c[a[d]];else delete c[a];this._query=exports.buildQuery(c);return this};this.toString=this.render=function(a){var c=this._protocol?this._protocol+"://":"",d=this._host?this._host+((this._port||80)==80?"":":"+this._port):"";if(a)return c+d;return c+d+this._path+(this._query?"?"+this._query:"")+(this._anchor?"#"+this._anchor:"")}});\nexports.relativeTo=function(b,e){if(!e)return b;b=String(b);if(/^http(s?):\\/\\//.test(b))return b;b=b.charAt(0)=="/"?(new exports(e)).toString(true)+b:e+b;return exports.resolveRelative(b)};exports.resolveRelative=function(b){for(;b!=(b=b.replace(/(^|\\/)([^\\/]+)\\/\\.\\.\\//g,"/")););return b.replace(/[^.]\\.\\//g,"")};exports.buildQuery=function(b){var e=[];for(var a in b)e.push(encodeURIComponent(a)+"="+encodeURIComponent(b[a]));return e.join("&")};\nexports.parseQuery=function(b){b=b.split("&");for(var e=b.length,a={},c=0;c<e;++c){var d=b[c].split("="),f=decodeURIComponent(d[0]);if(f)a[f]=decodeURIComponent(d[1])}return a};\nvar strictRegex=/^(?:([^:\\/?#]+):)?(?:\\/\\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\\/?#]*)(?::(\\d*))?))?((((?:[^?#\\/]*\\/)*)([^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,looseRegex=/^(?:(?![^:@]+:[^:@\\/]*@)([^:\\/?#.]+):)?(?:\\/\\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/,queryStringRegex=/(?:^|&)([^&=]*)=?([^&]*)/g;\nexports.parse=function(b,e){for(var a={},c=(e?strictRegex:looseRegex).exec(b),d=0,f;f=attrs[d];++d)a[f]=c[d]||"";var g=a.queryKey={};a.query.replace(queryStringRegex,function(h,i,j){if(h)g[i]=j});return a};exports.isSameDomain=function(b,e){var a=exports.parse(b),c=exports.parse(e);return a.port==c.port&&a.host==c.host&&a.protocol==c.protocol};\n');
jsio.setCachedSrc("../../packages/net/errors.js",'var makeErrorClass=function(b){var c=function(a){if(typeof a=="string")this.message=a;else this.data=a};c.prototype={type:b,toString:function(){return b+(this.message?": "+this.message:"")}};return c};exports.ReadyStateError=makeErrorClass("ReadyStateError");exports.InvalidEncodingError=makeErrorClass("InvalidEncodingError");exports.ExpiredSession=makeErrorClass("ExpiredSession");exports.ServerUnreachable=makeErrorClass("ServerUnreachable",100);\nexports.ConnectionTimeout=makeErrorClass("ConnectionTimeout",101);exports.ServerProtocolError=makeErrorClass("ServerProtocolError",200);exports.ServerClosedConnection=makeErrorClass("ServerClosedConnection",301);exports.ConnectionClosedCleanly=makeErrorClass("ConnectionClosedCleanly",300);\n');
jsio.setCachedSrc("../../packages/net/csp/transports.js",'jsio("import std.uri as uri");jsio("import std.base64 as base64");jsio("from util.browserdetect import BrowserDetect");\n(function(){var c;exports.getDoc=function(){if(c)return c;try{if(c=window.ActiveXObject&&new ActiveXObject("htmlfile")){c.open().write("<html></html>");c.close();window.attachEvent("onunload",function(){try{c.body.innerHTML=""}catch(e){}c=null})}}catch(d){}c||(c=document);return c};exports.XHR=function(){var d=window;exports.getDoc();return new (exports.XHR=d.XMLHttpRequest?d.XMLHttpRequest:function(){return d.ActiveXObject&&new d.ActiveXObject("Msxml2.XMLHTTP")||null})};exports.createXHR=function(){return new exports.XHR}})();\nfunction isLocalFile(c){return/^file:\\/\\//.test(c)}function isWindowDomain(c){return uri.isSameDomain(c,window.location.href)}var xhrSupportsBinary=undefined;function checkXHRBinarySupport(c){xhrSupportsBinary=!!c.sendAsBinary}\nfunction canUseXHR(c){if(isLocalFile(c))return false;var d=new exports.XHR;if(!d)return false;checkXHRBinarySupport(d);if(isWindowDomain(c))return true;if(window.XMLHttpRequest&&(d.__proto__==XMLHttpRequest.prototype||d instanceof window.XMLHttpRequest)&&d.withCredentials!==undefined||window.XDomainRequest&&d instanceof window.XDomainRequest)return true}var transports=exports.transports={};\nexports.chooseTransport=function(c,d){switch(d.preferredTransport){case "jsonp":return transports.jsonp;case "xhr":default:if(canUseXHR(c))return transports.xhr;return transports.jsonp}};var PARAMS={xhrstream:{is:"1",bs:"\\n"},xhrpoll:{du:"0"},xhrlongpoll:{},sselongpoll:{bp:"data: ",bs:"\\r\\n",se:"1"},ssestream:{bp:"data: ",bs:"\\r\\n",se:"1",is:"1"}};\nexports.Transport=Class(function(){this.handshake=function(){throw Error("handshake Not Implemented");};this.comet=function(){throw Error("comet Not Implemented");};this.send=function(){throw Error("send Not Implemented");};this.encodePacket=function(){throw Error("encodePacket Not Implemented");};this.abort=function(){throw Error("abort Not Implemented");}});\nvar baseTransport=Class(exports.Transport,function(){this.init=function(){this._aborted=false;this._handshakeArgs={ct:"application/javascript"};this._handshakeData="{}"};this.handshake=function(c,d){logger.debug("handshake:",c,d);this._makeRequest("send",c+"/handshake",this._handshakeArgs,this._handshakeData,this.handshakeSuccess,this.handshakeFailure)};this.comet=function(c,d,e,g){logger.debug("comet:",c,d,e,g);this._makeRequest("comet",c+"/comet",{s:d,a:e},null,this.cometSuccess,this.cometFailure)};\nthis.send=function(c,d,e,g){this._makeRequest("send",c+"/send",{s:d,a:e},g,this.sendSuccess,this.sendFailure)}});\ntransports.xhr=Class(baseTransport,function(c){function d(e,g,j,k){try{var h={status:e.status}}catch(i){k({response:"Could not access status"})}try{if(e.readyState!=4)return;h.response=eval(e.responseText);if(h.status!=200){logger.debug("XHR failed with status ",e.status);k(h);return}logger.debug("XHR data received")}catch(a){logger.debug("Error in XHR::onReadyStateChange",a);k(h);this._abortXHR(g);logger.debug("done handling XHR error");return}j(h)}this.init=function(){c(this,"init");this._xhr={send:new exports.XHR,\ncomet:new exports.XHR}};this.abort=function(){this._aborted=true;for(var e in this._xhr)this._xhr.hasOwnProperty(e)&&this._abortXHR(e)};this._abortXHR=function(e){logger.debug("aborting XHR");var g=this._xhr[e];try{if("onload"in g)g.onload=g.onerror=g.ontimeout=null;else if("onreadystatechange"in g)g.onreadystatechange=null;g.abort&&g.abort()}catch(j){logger.debug("error aborting xhr",j)}this._xhr[e]=new exports.XHR};this.encodePacket=function(e,g){return!xhrSupportsBinary?[e,1,base64.encode(g)]:\n[e,0,g]};this._makeRequest=function(e,g,j,k,h,i){if(!this._aborted){var a=this._xhr[e];a.open("POST",g+"?"+uri.buildQuery(j));a.setRequestHeader("Content-Type","text/plain");if("onload"in a){a.onload=bind(this,d,a,e,h,i);a.onerror=a.ontimeout=i}else if("onreadystatechange"in a)a.onreadystatechange=bind(this,d,a,e,h,i);setTimeout(function(){a[xhrSupportsBinary?"sendAsBinary":"send"](k||null)},0)}}});var EMPTY_FUNCTION=function(){},SLICE=Array.prototype.slice;\ntransports.jsonp=Class(baseTransport,function(c){function d(a,b){logger.debug("successful: ",a.url,b);a.completed=true;logger.debug("calling the cb");a.cb.call(GLOBAL,{status:200,response:b});logger.debug("cb called")}function e(a,b){if(!(b&&b.readyState!="loaded")){b.onreadystatechange=function(){};g.call(this,a)}}function g(a,b){k(this._ifr[a.type]);if(!a.completed){var f={status:b?200:404,response:b||"Unable to load resouce"};logger.debug("error making request:",a.url,f);logger.debug("calling eb");\na.eb.call(GLOBAL,f)}}var j=function(){var a=exports.getDoc();if(!a.body)return false;var b=a.createElement("iframe");with(b.style){display="block";width=height=border=margin=padding="0";overflow=visibility="hidden";position="absolute";top=left="-999px"}b.cbId=0;a.body.appendChild(b);b.src=\'javascript:var d=document;d.open();d.write("<html><body></body></html>");d.close();\';return b},k=function(a){var b=a.contentWindow,f=b.document;logger.debug("removing script tags");for(var m=f.getElementsByTagName("script"),\nn=m.length-1;n>=0;--n)f.body.removeChild(m[n]);logger.debug("deleting iframe callbacks");b["cb"+a.cbId]=b["eb"+a.cbId]=EMPTY_FUNCTION},h=function(a){setTimeout(function(){a&&a.parentNode&&a.parentNode.removeChild(a)},6E4)};this.init=function(){c(this,"init");this._onReady=[];this._isReady=false;this._createIframes()};this._createIframes=function(){this._ifr={send:j(),comet:j()};if(this._ifr.send===false)return setTimeout(bind(this,"_createIframes"),100);this._isReady=true;var a=this._onReady;this._onReady=\n[];for(var b=0,f;f=a[b];++b)this._makeRequest.apply(this,f)};this.encodePacket=function(a,b){return[a,1,base64.encode(b)]};this.abort=function(){this._aborted=true;for(var a in this._ifr)if(this._ifr.hasOwnProperty(a)){var b=this._ifr[a];k(b);h(b)}};this._makeRequest=function(a,b,f,m,n,o){if(!this._isReady)return this._onReady.push(arguments);var l=++this._ifr[a].cbId;l={type:a,id:l,cb:n,eb:o,cbName:"cb"+l,ebName:"eb"+l,completed:false};f.d=m;f.n=Math.random();switch(a){case "send":f.rs=";";f.rp=\nl.cbName;break;case "comet":f.bs=";";f.bp=l.cbName;break}l.url=b+"?"+uri.buildQuery(f);setTimeout(bind(this,"_request",l),0)};this._request=function(a){var b=this._ifr[a.type].contentWindow,f=b.document,m=f.body;b[a.ebName]=bind(this,g,a);b[a.cbName]=bind(this,d,a);if(BrowserDetect.isWebKit){f.open();f.write(\'<script src="\'+a.url+\'"><\\/script><script>\'+ebName+"(false)<\\/script>");f.close()}else{b=f.createElement("script");b.src=a.url;if(b.onreadystatechange===null)b.onreadystatechange=bind(this,e,\na,b);m.appendChild(b);if(!BrowserDetect.isIE){b=f.createElement("script");b.innerHTML=a.ebName+"(false)";m.appendChild(b)}}i()};var i=BrowserDetect.isFirefox||BrowserDetect.isOpera?function(){var a=document.body;if(a){if(!i.iframe)i.iframe=document.createElement("iframe");a.insertBefore(i.iframe,a.firstChild);a.removeChild(i.iframe)}}:function(){}});\n');
jsio.setCachedSrc("../../packages/util/browserdetect.js",'exports.BrowserDetect=new (function(){function e(c){for(var b=0,a;a=c[b];b++){var f=a.string,h=a.prop;a.identity=a.identity||a.subString;d=a.versionSearch||a.identity;if(f){if(f.indexOf(a.subString)!=-1)return a.identity}else if(h)return a.identity}}function g(c){var b=c.indexOf(d);if(b!=-1)return parseFloat(c.substring(b+d.length+1))}var d,i=[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},\n{string:navigator.platform,subString:"Linux"}];this.browser=e([{string:navigator.userAgent,subString:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox"},{string:navigator.vendor,subString:"Camino"},\n{string:navigator.userAgent,subString:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"IE",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}])||"unknown";this.version=g(navigator.userAgent)||g(navigator.appVersion)||"unknown";this.OS=e(i)||"unknown";this.isWebKit=/ AppleWebKit\\//.test(navigator.userAgent);this["is"+this.browser]=this.version});\n');
jsio.setCachedSrc("../../packages/net/env/browser/csp.js",'jsio("import net.interfaces");jsio("from net.csp.client import CometSession");jsio("import std.utf8 as utf8");\nexports.Connector=Class(net.interfaces.Connector,function(){this.connect=function(){this._state=net.interfaces.STATE.CONNECTING;var a=new CometSession;a.onconnect=bind(this,"cometSessionOnConnect",a);a.ondisconnect=bind(this,"onDisconnect");logger.debug("opening the connection");if(!this._opts.encoding)this._opts.encoding="plain";a.connect(this._opts.url,this._opts)};this.cometSessionOnConnect=function(a){logger.debug("conn has opened");this.onConnect(new Transport(a))}});\nvar Transport=Class(net.interfaces.Transport,function(){this.init=function(a){this._conn=a};this.makeConnection=function(a){this._conn.onread=bind(a,"dataReceived")};this.write=function(a){this._conn.write(a)};this.loseConnection=function(){this._conn.close()}});\n');
jsio.setCachedSrc("../../packages/net/interfaces.js",'jsio("import net");jsio("import lib.Enum as Enum");var ctx=jsio.__env.global;exports.Protocol=Class(function(){this.connectionMade=function(){};this.dataReceived=function(){};this.connectionLost=function(){};this._connectionMade=function(){this._isConnected=true;this.connectionMade.apply(this,arguments)};this._connectionLost=function(){this._isConnected=true;this.connectionLost.apply(this,arguments)};this._isConnected=false;this.isConnected=function(){return!!this._isConnected}});\nexports.Client=Class(function(){this.init=function(a){this._protocol=a};this.connect=function(a,b){this._remote=new this._protocol;this._remote._client=this;net.connect(this._remote,a,b)}});exports.Server=Class(function(){this.init=function(a){this._protocolClass=a};this.buildProtocol=function(){return new this._protocolClass};this.listen=function(a,b){return net.listen(this,a,b)}});\nexports.Transport=Class(function(){this._encoding="plain";this.write=function(){throw Error("Not implemented");};this.getPeer=function(){throw Error("Not implemented");};this.setEncoding=function(a){this._encoding=a};this.getEncoding=function(){return this._encoding}});\nexports.Listener=Class(function(){this.init=function(a,b){this._server=a;this._opts=b||{}};this.onConnect=function(a){var b=this._server.buildProtocol();b.transport=a;b.server=this._server;a.protocol=b;a.makeConnection(b);b._connectionMade()};this.listen=function(){throw Error("Abstract class");};this.stop=function(){}});exports.STATE=Enum("INITIAL","DISCONNECTED","CONNECTING","CONNECTED");\nexports.Connector=Class(function(){this.init=function(a,b){this._protocol=a;this._opts=b;this._state=exports.STATE.INITIAL};this.getState=function(){return this._state};this.onConnect=function(a){this._state=exports.STATE.CONNECTED;a.makeConnection(this._protocol);this._protocol.transport=a;this._protocol._connectionMade()};this.onDisconnect=function(a){var b=this._state==exports.STATE.CONNECTED;this._state=exports.STATE.DISCONNECTED;try{this._protocol._connectionLost(a,b)}catch(c){throw logger.error(c);\n}};this.getProtocol=function(){return this._protocol}});\n');
jsio.setCachedSrc("../../packages/net.js",'jsio("import net.env");jsio("import std.JSON as JSON");JSON.createGlobal();exports.listen=function(a,b,c){if(!b)throw logger.error("No transport provided for net.listen");a=new (typeof b=="string"?net.env.getListener(b):b)(a,c);a.listen();return a};exports.connect=function(a,b,c){a=new (typeof b=="string"?net.env.getConnector(b):b)(a,c);a.connect();return a};exports.quickServer=function(a){jsio("import net.interfaces");return new net.interfaces.Server(a)};\n');
jsio.setCachedSrc("../../packages/net/env.js",'function getObj(c,a,b){try{jsio("from .env."+(b||jsio.__env.name)+"."+a+" import "+c+" as result")}catch(d){throw logger.error("Invalid transport (",a,") or environment (",b,")");}return result}exports.getListener=bind(this,getObj,"Listener");exports.getConnector=bind(this,getObj,"Connector");\n');jsio.setCachedSrc("../../packages/std/JSON.js",'exports.createGlobal=function(){if(typeof JSON=="undefined")JSON={};if(typeof JSON.stringify!=="function")JSON.stringify=exports.stringify;if(typeof JSON.parse!=="function")JSON.parse=exports.parse};\n(function(){function n(b){o.lastIndex=0;return o.test(b)?\'"\'+b.replace(o,function(g){var c=q[g];return typeof c==="string"?c:"\\\\u"+("0000"+g.charCodeAt(0).toString(16)).slice(-4)})+\'"\':\'"\'+b+\'"\'}function l(b,g){var c=h,a=g[b];if(a&&typeof a==="object"&&typeof a.toJSON==="function")a=a.toJSON(b);if(typeof k==="function")a=k.call(g,b,a);switch(typeof a){case "string":return n(a);case "number":return isFinite(a)?String(a):"null";case "boolean":return String(a);case "object":if(a===null)return"null";\nif(a.constructor===Date)return exports.stringifyDate(a);h+=m;var d=[];if(a.constructor===Array){for(var i=a.length,e=0;e<i;e+=1)d[e]=l(e,a)||"null";var j=d.length===0?"[]":h?"[\\n"+h+d.join(",\\n"+h)+"\\n"+c+"]":"["+d.join(",")+"]";h=c;return j}if(k&&typeof k==="object"){i=k.length;for(e=0;e<i;e+=1){var f=k[e];if(typeof f==="string")if(j=l(f,a))d.push(n(f)+(h?": ":":")+j)}}else for(f in a)if(Object.hasOwnProperty.call(a,f))if(j=l(f,a))d.push(n(f)+(h?": ":":")+j);j=d.length===0?"{}":h?"{\\n"+h+d.join(",\\n"+\nh)+"\\n"+c+"}":"{"+d.join(",")+"}";h=c;return j}}var p=/[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g,o=/[\\\\\\"\\x00-\\x1f\\x7f-\\x9f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g,h,m,q={"\\u0008":"\\\\b","\\t":"\\\\t","\\n":"\\\\n","\\u000c":"\\\\f","\\r":"\\\\r",\'"\':\'\\\\"\',"\\\\":"\\\\\\\\"},k;exports.stringify=function(b,g,c){m=h="";if(typeof c==="number")for(var a=0;a<c;a+=1)m+=" ";else if(typeof c==="string")m=\nc;if((k=g)&&typeof g!=="function"&&(typeof g!=="object"||typeof g.length!=="number"))throw Error("JSON stringify: invalid replacer");return l("",{"":b})};exports.stringifyDate=function(b){var g=b.getUTCFullYear(),c=b.getUTCMonth()+1,a=b.getUTCDate(),d=b.getUTCHours(),i=b.getUTCMinutes(),e=b.getUTCSeconds();b=b.getUTCMilliseconds();if(c<10)c="0"+c;if(a<10)a="0"+a;if(d<10)d="0"+d;if(i<10)i="0"+i;if(e<10)e="0"+e;if(b<10)b="00"+b;else if(b<100)b="0"+b;return\'"\'+g+"-"+c+"-"+a+"T"+d+":"+i+":"+e+"."+b+\'Z"\'};\nexports.parse=function(b,g){p.lastIndex=0;if(p.test(b))b=b.replace(p,function(d){return"\\\\u"+("0000"+d.charCodeAt(0).toString(16)).slice(-4)});if(/^[\\],:{}\\s]*$/.test(b.replace(/\\\\(?:["\\\\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\\\\n\\r]*"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g,"]").replace(/(?:^|:|,)(?:\\s*\\[)+/g,""))){var c=eval("("+b+")");if(g){var a=function(d,i){var e,j,f=d[i];if(f&&typeof f==="object")for(e in f)if(Object.hasOwnProperty.call(f,e)){j=a(f,e);if(j!==undefined)f[e]=\nj;else delete f[e]}return g.call(d,i,f)};return a({"":c},"")}else return c}throw new SyntaxError("JSON.parse");}})();\n');
jsio.setCachedSrc("../../packages/net/env/browser/iframe.js",'jsio("import net.interfaces;");jsio("from util.browser import $;");function findFrame(){var c=window;if(top==c)return"";var f=[],a=function(d){for(var b=0,e=d.length;b<e;++b)if(d[b]==c||a(d[b])){f.unshift(b);return true}};a(top);return f.join("-")}function findTarget(c){try{var f=c.split("-");c=top;for(var a=0,d;d=f[a];++a)c=c[d];return c&&c.postMessage?c:null}catch(b){logger.error(b,"Could not find iframe target:",c,"(possibly a security error)");return null}}\nexports.Listener=Class(net.interfaces.Listener,function(c){var f={background:"#442",border:"1px solid #885",margin:"0px 0px -1px 3px",MozBorderRadius:"3px 0px 0px 3px",WebkitBorderRadius:"3px 0px 0px 3px",boxSizing:"border-box",borderRightWidth:"0px",padding:"2px 0px 2px 5px",cursor:"pointer"};this.init=function(a,d){c(this,"init",arguments);this._clients={};this._opts=d;this._numTabs=0;this._frames=[]};this.buildTabUI=function(){$.style(document.documentElement,{overflow:"hidden",margin:"0px",padding:"0px",\nwidth:"100%",height:"100%"});$.style(document.body,{margin:"0px",padding:"0px",width:"100%",height:"100%"});$.onEvent(window,"resize",this,"onResize");this._leftCol=$({style:{position:"absolute",top:"0px",left:"0px",width:"150px",height:"100%",overflow:"hidden",paddingTop:"5px",background:"#444",fontWeight:"bold",color:"#EEA"},parent:document.body});this._rightCol=$({style:{position:"absolute",top:"0px",right:"0px",height:"100%",background:"#EEE",boxSizing:"border-box",border:"1px solid #CCC",borderWidth:"0px 1px",\noverflowX:"hidden",overflowY:"auto"},parent:document.body});this._serverContent=$({style:{position:"absolute",top:"0px",right:"0px",width:"100%",height:"100%",boxSizing:"border-box",padding:"10px"},parent:this._rightCol});var a=this.createTab("server");$.onEvent(a,"click",this,"showFrame",this._serverContent);if(this._opts&&this._opts.clientURL){a=this.createTab("+ client",1);$.onEvent(a,"click",this,"onNewTabClick");this._lastTab=a}this.onResize();return this._serverContent};this.findFrame=function(){return findFrame()};\nthis.getDOM=function(){return this._serverContent};this.onResize=function(){this._rightCol.style.width=$(window).width-150+"px"};this.createTab=function(a,d){var b=$({style:f});$.style(b,{marginLeft:(d||0)*10+"px"});b.text=$({text:a,parent:b});var e=$({style:{"float":"right"},before:b.text});b.status=function(g){$.setText(e,g)};this._lastTab?this._leftCol.insertBefore(b,this._lastTab):this._leftCol.appendChild(b);$.onEvent(b,"mouseover",bind($,$.style,b,{background:"#664"}));$.onEvent(b,"mouseout",\nbind($,$.style,b,{background:"#442"}));$.onEvent(b,"mousedown",bind($,$.style,b,{background:"#111"}));$.onEvent(b,"mouseup",bind($,$.style,b,{background:"#442"}));return b};this.createCloseableTab=function(a,d,b){a=b?this.newTab(b,a,d):this.createTab(a,d);a.close=$({text:"X",style:{"float":"right",border:"1px solid #AAF",background:"#000",padding:"1px"},before:a.firstChild});return a};this.onNewTabClick=function(){this.newTab()};this.newTab=function(a,d,b){++this._numTabs;d=d||this._numTabs;var e=\nthis.createTab(d,b);e.status("loading...");var g=$({tag:"iframe",attrs:{border:0,name:"tab"+this._numTabs},style:{position:"absolute",left:"200%",width:"100%",height:"100%",borderWidth:"0px"}});g.src=a||this._opts.clientURL;this._rightCol.appendChild(g);g.onload=bind(this,"onFrameLoad",g,e);this._frames.push(g);e._frame=g;$.onEvent(e,"click",this,"showFrame",g);e.reload=$({text:"R",style:{"float":"right",border:"1px solid #AAF",background:"#000",padding:"1px"},before:e.firstChild});$.onEvent(e.reload,\n"click",function(){e.status("loading...");g.contentWindow.location.reload(true)});this.onResize();return e};this.onFrameLoad=function(a,d){this.showFrame(a);d.status("")};this.showFrame=function(a){this._currentFrame&&$.style(this._currentFrame,{left:"200%"});this._currentFrame=a;$.style(a,{left:"0%"})};this.listen=function(){$.onEvent(window,"message",bind(this,"_onMessage"))};this._onMessage=function(a){var d=a.source.name,b=this._clients[d],e=a.data;if(/^iS>/.test(e)){e=eval("("+e.substring(3)+\n")");switch(e.type){case "open":this._clients[d]=new exports.Transport(a.source,"iC<");a.source.postMessage(\'iC<{type:"open"}\',"*");this.onConnect(this._clients[d]);break;case "data":b.onData(e.payload);break;case "close":b.onClose();a.source.postMessage(\'iC<{type:"close"}\',"*");delete this._clients[d];break}}}});\nexports.Connector=Class(net.interfaces.Connector,function(){this.connect=function(){var c;c=this._opts.target?findTarget(this._opts.target):top;findFrame();$.onEvent(window,"message",bind(this,"_onMessage"));c.postMessage(\'iS>{"type":"open"}\',"*")};this._onMessage=function(c){var f=c.data;if(/^iC</.test(f)){f=eval("("+f.substring(3)+")");switch(f.type){case "open":this._transport=new exports.Transport(c.source,"iS>");this.onConnect(this._transport);break;case "close":this._transport.onClose();break;\ncase "data":this._transport.onData(f.payload);break}}}});\nexports.Transport=Class(net.interfaces.Transport,function(){this.init=function(c,f){this._win=c;this._prefix=f};this.makeConnection=function(c){this._protocol=c};this.write=function(c){this.encoding=="utf8"?this._win.postMessage(this._prefix+JSON.stringify({type:"data",payload:utf8.encode(c)}),"*"):this._win.postMessage(this._prefix+JSON.stringify({type:"data",payload:c}),"*")};this.loseConnection=function(){this._win.postMessage(JSON.stringify({type:"close",code:301}),"*")};this.onData=function(){this._protocol.dataReceived.apply(this._protocol,\narguments)};this.onClose=function(){this._protocol._connectionLost.apply(this._protocol,arguments)}});\n');
jsio.setCachedSrc("../../packages/util/browser.js",'var evts=[];\nif(jsio.__env.name=="browser"){jsio("external .sizzle import Sizzle");jsio("import math2D.Rect");var isWindow=function(a){return a&&!$.isElement(a)&&$.isElement(a.document)},singleId=/^#([\\w-]+)$/,$=exports.$=function(a,b){switch(typeof a){case "object":if($.isElement(a))return $.remove(a);else if($.isElement(a.document&&a.document.body))return $.size(a);return $.create(a);case "string":if(singleId.test(a))return $.id(a.substring(1),b);return Sizzle.apply(GLOBAL,arguments)}},DOM2=typeof HTMLElement==="object";\n$.isElement=DOM2?function(a){return a&&a instanceof HTMLElement}:function(a){return a&&typeof a.nodeType=="number"&&typeof a.nodeName=="string"};$.id=function(a,b){return typeof a=="string"?(b||window).document.getElementById(a):a};$.apply=function(a,b){if(b.attrs)for(attr in b.attrs)a.setAttribute(attr,b.attrs[attr]);if(b.id)a.id=b.id;b.style&&$.style(a,b.style);if(b.src)a.src=b.src;if(b["class"]||b.className)a.className=b["class"]||b.className;var c=b.parent||b.parentNode;if(c&&b.first)$.insertBefore(c,\na,c.firstChild);else if(b.before)$.insertBefore(b.before.parentNode||c,a,b.before);else if(b.after)$.insertAfter(b.after.parentNode||c,a,b.after);else c&&c.appendChild(a);if("html"in b)a.innerHTML=b.html;"text"in b&&$.setText(a,b.text);if(b.children){c=b.children;for(var d=0,e=c.length;d<e;++d)a.appendChild($.isElement(c[d])?c[d]:$(c[d]))}return a};$.insertBefore=function(a,b,c){if(a&&b)c&&c.parentNode==a?a.insertBefore(b,c):a.appendChild(b)};$.insertAfter=function(a,b,c){if(a&&b)if(!c||c.parentNode!=\na)$.insertBefore(a,b,a.firstChild);else c.nextSibling?a.insertBefore(b,c.nextSibling):a.appendChild(b)};$.create=function(a){var b=(a&&a.win||window).document;if(!a||typeof a=="string")return b.createElement(a||"div");return $.apply(a.el||b.createElement(a.tag||a.tagName||"div"),a)};$.show=function(a,b){$.id(a).style.display=b||"block"};$.hide=function(a){$.id(a).style.display="none"};$.addClass=function(a,b){if(a){a=$.id(a);if(typeof b=="string")b=b.split(" ");for(var c=" "+a.className+" ",d=0,e=\nb.length;d<e;++d){var f=b[d];if(c.indexOf(" "+f+" ")==-1)c+=f+" "}a.className=c.replace(/^\\s+|\\s+$/g,"");return $}};$.getTag=function(a,b){return a.getElementsByTagName(b)};$.removeClass=function(a,b){if(a){a=$.id(a);a.className=(" "+a.className+" ").replace(" ","  ").replace(RegExp("( "+b.replace("s+"," | ").replace("-","-")+" )","g")," ").replace(/\\s+/," ").replace(/^\\s+|\\s+%/,"")}};var ieGetAlpha=function(a){try{return a.filters.item("alpha")}catch(b){}try{return a.filters.item("progid:DXImageTransform.Microsoft.Alpha")}catch(c){}return null};\n$.style=function(a,b){if(a instanceof Array)for(var c=0,d;d=a[c];++c)$.style(d,b);else{a=$.id(a);c=a.style;for(prop in b)switch(prop){case "styleFloat":case "cssFloat":case "float":c.styleFloat=c.cssFloat=b[prop];break;case "opacity":c.opacity=b[prop];if(a.filters)try{d=ieGetAlpha();var e=b[prop]==1?99.99:b[prop]*100;if(d)d.Opacity=e;else c.filter="alpha(opacity="+e+")"}catch(f){}break;case "borderRadius":c.borderRadius=c.MozBorderRadius=b[prop];break;case "boxSizing":c.MsBoxSizing=c.MozBoxSizing=\nc.WebkitBoxSizing=b[prop];default:c[prop]=b[prop];break}}};$.onEvent=function(a,b,c){if(typeof c!="function")c=bind.apply(GLOBAL,Array.prototype.slice.call(arguments,2));var d=c;a=$.id(a);if(a.addEventListener)a.addEventListener(b,d,false);else{d=function(e){c(e||window.event)};a.attachEvent("on"+b,d)}d=bind($,"removeEvent",a,b,d);evts.push(d);return d};$.removeAllEvents=function(){for(var a=0,b=evts.length;a<b;++a)evts[a]()};$.removeEvent=function(a,b,c){a=$.id(a);a.addEventListener?a.removeEventListener(b,\nc,false):a.detachEvent("on"+b,c)};$.stopEvent=function(a){if(a){a.cancelBubble=true;a.stopPropagation&&a.stopPropagation();a.preventDefault&&a.preventDefault()}};$.setText=function(a,b){a=$.id(a);b=String(b);if("textContent"in a)a.textContent=b;else if("innerText"in a)a.innerText=b.replace(/\\n/g," ");else{a.innerHTML="";a.appendChild(document.createTextNode(b))}};$.remove=function(a){(a=$.id(a))&&a.parentNode&&a.parentNode.removeChild(a)};$.cursorPos=function(a,b){var c=$.pos(b);c.top=a.clientY-c.top+\n(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop);c.left=a.clientX-c.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft);return c};$.pos=function(a){a=a;for(var b={top:0,left:0};a&&a!=document.body;){b.left+=a.offsetLeft;for(b.top+=a.offsetTop;a.offsetParent!=a.parentNode;){b.top-=a.scrollTop;b.left-=a.scrollLeft;a=a.parentNode}a=a.offsetParent}return b};$.size=function(a){if($.isElement(a))return{width:a.offsetWidth,height:a.offsetHeight};\nelse if(a.document){var b=a.document.documentElement||a.document.body;return new math2D.Rect(b.offsetTop,b.offsetLeft,a.innerWidth||b.clientWidth||b.clientWidth,a.innerHeight||b.clientHeight||b.clientHeight)}};$.insertCSSFile=function(a){document.getElementsByTagName("head")[0].appendChild($({tag:"link",attrs:{rel:"stylesheet",type:"text/css",href:a}}))}};\n');
jsio.setCachedSrc("../../packages/util/sizzle.js",'Sizzle=function(){function x(a,b,c,d,f,e){f=a=="previousSibling"&&!e;for(var h=0,j=d.length;h<j;h++){var g=d[h];if(g){if(f&&g.nodeType===1){g.sizcache=c;g.sizset=h}g=g[a];for(var l=false;g;){if(g.sizcache===c){l=d[g.sizset];break}if(g.nodeType===1&&!e){g.sizcache=c;g.sizset=h}if(g.nodeName===b){l=g;break}g=g[a]}d[h]=l}}}function y(a,b,c,d,f,e){f=a=="previousSibling"&&!e;for(var h=0,j=d.length;h<j;h++){var g=d[h];if(g){if(f&&g.nodeType===1){g.sizcache=c;g.sizset=h}g=g[a];for(var l=false;g;){if(g.sizcache===\nc){l=d[g.sizset];break}if(g.nodeType===1){if(!e){g.sizcache=c;g.sizset=h}if(typeof b!=="string"){if(g===b){l=true;break}}else if(k.filter(b,[g]).length>0){l=g;break}}g=g[a]}d[h]=l}}}var v=/((?:\\((?:\\([^()]+\\)|[^()]+)+\\)|\\[(?:\\[[^[\\]]*\\]|[\'"][^\'"]*[\'"]|[^[\\]\'"]+)+\\]|\\\\.|[^ >+~,(\\[\\\\]+)+|[>+~])(\\s*,\\s*)?/g,w=0,z=Object.prototype.toString,p=false,k=function(a,b,c,d){c=c||[];var f=b=b||document;if(b.nodeType!==1&&b.nodeType!==9)return[];if(!a||typeof a!=="string")return c;var e=[],h,j,g,l,n=true,o=s(b);\nfor(v.lastIndex=0;(h=v.exec(a))!==null;){e.push(h[1]);if(h[2]){l=RegExp.rightContext;break}}if(e.length>1&&D.exec(a))if(e.length===2&&i.relative[e[0]])j=A(e[0]+e[1],b);else for(j=i.relative[e[0]]?[b]:k(e.shift(),b);e.length;){a=e.shift();if(i.relative[a])a+=e.shift();j=A(a,j)}else{if(!d&&e.length>1&&b.nodeType===9&&!o&&i.match.ID.test(e[0])&&!i.match.ID.test(e[e.length-1])){h=k.find(e.shift(),b,o);b=h.expr?k.filter(h.expr,h.set)[0]:h.set[0]}if(b){h=d?{expr:e.pop(),set:q(d)}:k.find(e.pop(),e.length===\n1&&(e[0]==="~"||e[0]==="+")&&b.parentNode?b.parentNode:b,o);j=h.expr?k.filter(h.expr,h.set):h.set;if(e.length>0)g=q(j);else n=false;for(;e.length;){var m=e.pop();h=m;if(i.relative[m])h=e.pop();else m="";if(h==null)h=b;i.relative[m](g,h,o)}}else g=[]}g||(g=j);if(!g)throw"Syntax error, unrecognized expression: "+(m||a);if(z.call(g)==="[object Array]")if(n)if(b&&b.nodeType===1)for(a=0;g[a]!=null;a++){if(g[a]&&(g[a]===true||g[a].nodeType===1&&E(b,g[a])))c.push(j[a])}else for(a=0;g[a]!=null;a++)g[a]&&\ng[a].nodeType===1&&c.push(j[a]);else c.push.apply(c,g);else q(g,c);if(l){k(l,f,c,d);k.uniqueSort(c)}return c};k.uniqueSort=function(a){if(r){p=false;a.sort(r);if(p)for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1)}};k.matches=function(a,b){return k(a,null,null,b)};k.find=function(a,b,c){var d,f;if(!a)return[];for(var e=0,h=i.order.length;e<h;e++){var j=i.order[e];if(f=i.match[j].exec(a)){var g=RegExp.leftContext;if(g.substr(g.length-1)!=="\\\\"){f[1]=(f[1]||"").replace(/\\\\/g,"");d=i.find[j](f,\nb,c);if(d!=null){a=a.replace(i.match[j],"");break}}}}d||(d=b.getElementsByTagName("*"));return{set:d,expr:a}};k.filter=function(a,b,c,d){for(var f=a,e=[],h=b,j,g,l=b&&b[0]&&s(b[0]);a&&b.length;){for(var n in i.filter)if((j=i.match[n].exec(a))!=null){var o=i.filter[n],m,t;g=false;if(h==e)e=[];if(i.preFilter[n])if(j=i.preFilter[n](j,h,c,e,d,l)){if(j===true)continue}else g=m=true;if(j)for(var u=0;(t=h[u])!=null;u++)if(t){m=o(t,j,u,h);var B=d^!!m;if(c&&m!=null)if(B)g=true;else h[u]=false;else if(B){e.push(t);\ng=true}}if(m!==undefined){c||(h=e);a=a.replace(i.match[n],"");if(!g)return[];break}}if(a==f)if(g==null)throw"Syntax error, unrecognized expression: "+a;else break;f=a}return h};var i=k.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\\w\\u00c0-\\uFFFF_-]|\\\\.)+)/,CLASS:/\\.((?:[\\w\\u00c0-\\uFFFF_-]|\\\\.)+)/,NAME:/\\[name=[\'"]*((?:[\\w\\u00c0-\\uFFFF_-]|\\\\.)+)[\'"]*\\]/,ATTR:/\\[\\s*((?:[\\w\\u00c0-\\uFFFF_-]|\\\\.)+)\\s*(?:(\\S?=)\\s*([\'"]*)(.*?)\\3|)\\s*\\]/,TAG:/^((?:[\\w\\u00c0-\\uFFFF\\*_-]|\\\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\\((even|odd|[\\dn+-]*)\\))?/,\nPOS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\\((\\d*)\\))?(?=[^-]|$)/,PSEUDO:/:((?:[\\w\\u00c0-\\uFFFF_-]|\\\\.)+)(?:\\(([\'"]*)((?:\\([^\\)]+\\)|[^\\2\\(\\)]*)+)\\2\\))?/},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")}},relative:{"+":function(a,b,c){var d=typeof b==="string",f=d&&!/\\W/.test(b);d=d&&!f;if(f&&!c)b=b.toUpperCase();c=0;f=a.length;for(var e;c<f;c++)if(e=a[c]){for(;(e=e.previousSibling)&&e.nodeType!==1;);a[c]=d||e&&e.nodeName===b?e||false:e===b}d&&\nk.filter(b,a,true)},">":function(a,b,c){var d=typeof b==="string";if(d&&!/\\W/.test(b)){b=c?b:b.toUpperCase();c=0;for(var f=a.length;c<f;c++){var e=a[c];if(e){d=e.parentNode;a[c]=d.nodeName===b?d:false}}}else{c=0;for(f=a.length;c<f;c++)if(e=a[c])a[c]=d?e.parentNode:e.parentNode===b;d&&k.filter(b,a,true)}},"":function(a,b,c){var d=w++,f=y;if(!/\\W/.test(b)){var e=b=c?b:b.toUpperCase();f=x}f("parentNode",b,d,a,e,c)},"~":function(a,b,c){var d=w++,f=y;if(typeof b==="string"&&!/\\W/.test(b)){var e=b=c?b:\nb.toUpperCase();f=x}f("previousSibling",b,d,a,e,c)}},find:{ID:function(a,b,c){if(typeof b.getElementById!=="undefined"&&!c)return(a=b.getElementById(a[1]))?[a]:[]},NAME:function(a,b){if(typeof b.getElementsByName!=="undefined"){for(var c=[],d=b.getElementsByName(a[1]),f=0,e=d.length;f<e;f++)d[f].getAttribute("name")===a[1]&&c.push(d[f]);return c.length===0?null:c}},TAG:function(a,b){return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,f,e){a=" "+a[1].replace(/\\\\/g,"")+" ";if(e)return a;\ne=0;for(var h;(h=b[e])!=null;e++)if(h)if(f^(h.className&&(" "+h.className+" ").indexOf(a)>=0))c||d.push(h);else if(c)b[e]=false;return false},ID:function(a){return a[1].replace(/\\\\/g,"")},TAG:function(a,b){for(var c=0;b[c]===false;c++);return b[c]&&s(b[c])?a[1]:a[1].toUpperCase()},CHILD:function(a){if(a[1]=="nth"){var b=/(-?)(\\d*)n((?:\\+|-)?\\d*)/.exec(a[2]=="even"&&"2n"||a[2]=="odd"&&"2n+1"||!/\\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0;a[3]=b[3]-0}a[0]=w++;return a},ATTR:function(a,b,\nc,d,f,e){b=a[1].replace(/\\\\/g,"");if(!e&&i.attrMap[b])a[1]=i.attrMap[b];if(a[2]==="~=")a[4]=" "+a[4]+" ";return a},PSEUDO:function(a,b,c,d,f){if(a[1]==="not")if(v.exec(a[3]).length>1||/^\\w/.test(a[3]))a[3]=k(a[3],null,null,b);else{a=k.filter(a[3],b,c,true^f);c||d.push.apply(d,a);return false}else if(i.match.POS.test(a[0])||i.match.CHILD.test(a[0]))return true;return a},POS:function(a){a.unshift(true);return a}},filters:{enabled:function(a){return a.disabled===false&&a.type!=="hidden"},disabled:function(a){return a.disabled===\ntrue},checked:function(a){return a.checked===true},selected:function(a){return a.selected===true},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!k(c[3],a).length},header:function(a){return/h\\d/i.test(a.nodeName)},text:function(a){return"text"===a.type},radio:function(a){return"radio"===a.type},checkbox:function(a){return"checkbox"===a.type},file:function(a){return"file"===a.type},password:function(a){return"password"===a.type},submit:function(a){return"submit"===\na.type},image:function(a){return"image"===a.type},reset:function(a){return"reset"===a.type},button:function(a){return"button"===a.type||a.nodeName.toUpperCase()==="BUTTON"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-\n0==b},eq:function(a,b,c){return c[3]-0==b}},filter:{PSEUDO:function(a,b,c,d){var f=b[1],e=i.filters[f];if(e)return e(a,c,b,d);else if(f==="contains")return(a.textContent||a.innerText||"").indexOf(b[3])>=0;else if(f==="not"){b=b[3];c=0;for(d=b.length;c<d;c++)if(b[c]===a)return false;return true}},CHILD:function(a,b){var c=b[1],d=a;switch(c){case "only":case "first":for(;d=d.previousSibling;)if(d.nodeType===1)return false;if(c=="first")return true;d=a;case "last":for(;d=d.nextSibling;)if(d.nodeType===\n1)return false;return true;case "nth":c=b[2];var f=b[3];if(c==1&&f==0)return true;var e=b[0],h=a.parentNode;if(h&&(h.sizcache!==e||!a.nodeIndex)){var j=0;for(d=h.firstChild;d;d=d.nextSibling)if(d.nodeType===1)d.nodeIndex=++j;h.sizcache=e}d=a.nodeIndex-f;return c==0?d==0:d%c==0&&d/c>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||a.nodeName===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>\n-1},ATTR:function(a,b){var c=b[1];c=i.attrHandle[c]?i.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c);var d=c+"",f=b[2],e=b[4];return c==null?f==="!=":f==="="?d===e:f==="*="?d.indexOf(e)>=0:f==="~="?(" "+d+" ").indexOf(e)>=0:!e?d&&c!==false:f==="!="?d!=e:f==="^="?d.indexOf(e)===0:f==="$="?d.substr(d.length-e.length)===e:f==="|="?d===e||d.substr(0,e.length+1)===e+"-":false},POS:function(a,b,c,d){var f=i.setFilters[b[2]];if(f)return f(a,c,b,d)}}},D=i.match.POS;for(var C in i.match)i.match[C]=RegExp(i.match[C].source+\n/(?![^\\[]*\\])(?![^\\(]*\\))/.source);var q=function(a,b){a=Array.prototype.slice.call(a,0);if(b){b.push.apply(b,a);return b}return a};try{Array.prototype.slice.call(document.documentElement.childNodes,0)}catch(F){q=function(a,b){var c=b||[];if(z.call(a)==="[object Array]")Array.prototype.push.apply(c,a);else if(typeof a.length==="number")for(var d=0,f=a.length;d<f;d++)c.push(a[d]);else for(d=0;a[d];d++)c.push(a[d]);return c}}var r;if(document.documentElement.compareDocumentPosition)r=function(a,b){var c=\na.compareDocumentPosition(b)&4?-1:a===b?0:1;if(c===0)p=true;return c};else if("sourceIndex"in document.documentElement)r=function(a,b){var c=a.sourceIndex-b.sourceIndex;if(c===0)p=true;return c};else if(document.createRange)r=function(a,b){var c=a.ownerDocument.createRange(),d=b.ownerDocument.createRange();c.selectNode(a);c.collapse(true);d.selectNode(b);d.collapse(true);c=c.compareBoundaryPoints(Range.START_TO_END,d);if(c===0)p=true;return c};(function(){var a=document.createElement("div"),b="script"+\n(new Date).getTime();a.innerHTML="<a name=\'"+b+"\'/>";var c=document.documentElement;c.insertBefore(a,c.firstChild);if(document.getElementById(b)){i.find.ID=function(d,f,e){if(typeof f.getElementById!=="undefined"&&!e)return(f=f.getElementById(d[1]))?f.id===d[1]||typeof f.getAttributeNode!=="undefined"&&f.getAttributeNode("id").nodeValue===d[1]?[f]:undefined:[]};i.filter.ID=function(d,f){var e=typeof d.getAttributeNode!=="undefined"&&d.getAttributeNode("id");return d.nodeType===1&&e&&e.nodeValue===\nf}}c.removeChild(a);c=a=null})();(function(){var a=document.createElement("div");a.appendChild(document.createComment(""));if(a.getElementsByTagName("*").length>0)i.find.TAG=function(b,c){var d=c.getElementsByTagName(b[1]);if(b[1]==="*"){for(var f=[],e=0;d[e];e++)d[e].nodeType===1&&f.push(d[e]);d=f}return d};a.innerHTML="<a href=\'#\'></a>";if(a.firstChild&&typeof a.firstChild.getAttribute!=="undefined"&&a.firstChild.getAttribute("href")!=="#")i.attrHandle.href=function(b){return b.getAttribute("href",\n2)};a=null})();document.querySelectorAll&&function(){var a=k,b=document.createElement("div");b.innerHTML="<p class=\'TEST\'></p>";if(!(b.querySelectorAll&&b.querySelectorAll(".TEST").length===0)){k=function(d,f,e,h){f=f||document;if(!h&&f.nodeType===9&&!s(f))try{return q(f.querySelectorAll(d),e)}catch(j){}return a(d,f,e,h)};for(var c in a)k[c]=a[c];b=null}}();document.getElementsByClassName&&document.documentElement.getElementsByClassName&&function(){var a=document.createElement("div");a.innerHTML=\n"<div class=\'test e\'></div><div class=\'test\'></div>";if(a.getElementsByClassName("e").length!==0){a.lastChild.className="e";if(a.getElementsByClassName("e").length!==1){i.order.splice(1,0,"CLASS");i.find.CLASS=function(b,c,d){if(typeof c.getElementsByClassName!=="undefined"&&!d)return c.getElementsByClassName(b[1])};a=null}}}();var E=document.compareDocumentPosition?function(a,b){return a.compareDocumentPosition(b)&16}:function(a,b){return a!==b&&(a.contains?a.contains(b):true)},s=function(a){return a.nodeType===\n9&&a.documentElement.nodeName!=="HTML"||!!a.ownerDocument&&a.ownerDocument.documentElement.nodeName!=="HTML"},A=function(a,b){for(var c=[],d="",f,e=b.nodeType?[b]:b;f=i.match.PSEUDO.exec(a);){d+=f[0];a=a.replace(i.match.PSEUDO,"")}a=i.relative[a]?a+"*":a;f=0;for(var h=e.length;f<h;f++)k(a,e[f],c);return k.filter(d,c)};return k}();\n');
jsio.setCachedSrc("../../packages/net/env/browser/postmessage.js",'jsio("import net.interfaces");jsio("from util.browser import $");\nexports.Listener=Class(net.interfaces.Listener,function(a){this.init=function(){a(this,"init",arguments);this._clients={};if(!this._opts.clientUrl)this._opts.clientUrl=jsio.__dir+"/networkConsole.html"};this.listen=function(){$.onEvent(window,"message",bind(this,"_onMessage"))};this.getButton=function(b,c){var d=$({tagName:"button",text:c||"launch client",className:"clientButton"});$.onEvent(d,"click",bind(this,"openWindow",b||this._opts.clientUrl));return d};var f=1;this.openWindow=function(b){var c=\n{menubar:"no",location:"no",toolbar:"no",width:550,height:350,scrollbars:"yes",status:"yes",resizable:"yes"},d=[];for(var e in c)d.push(e+"="+c[e]);window.open(b,"W"+f++,d.join(",")).focus()};this._onMessage=function(b){var c=b.source.name,d=this._clients[c],e=eval("("+b.data+")");switch(e.type){case "open":this._clients[c]=new exports.Transport(b.source);b.source.postMessage(\'{type:"open"}\',"*");this.onConnect(this._clients[c]);break;case "data":d.onData(e.payload);break;case "close":d.onClose();\nb.source.postMessage(\'{type:"close"}\',"*");delete this._clients[c];break}}});\nexports.Connector=Class(net.interfaces.Connector,function(){this.connect=function(){$.onEvent(window,"message",bind(this,"_onMessage"));window.opener.postMessage(JSON.stringify({type:"open"}),"*")};this._onMessage=function(a){var f=eval("("+a.data+")");switch(f.type){case "open":this._transport=new exports.Transport(a.source);this.onConnect(this._transport);break;case "close":this._transport.onClose();break;case "data":this._transport.onData(f.payload);break}}});\nexports.Transport=Class(net.interfaces.Transport,function(){this.init=function(a){this._win=a};this.makeConnection=function(a){this._protocol=a};this.write=function(a){this.encoding=="utf8"?this._win.postMessage(JSON.stringify({type:"data",payload:utf8.encode(a)}),"*"):this._win.postMessage(JSON.stringify({type:"data",payload:a}),"*")};this.loseConnection=function(){this._win.postMessage(JSON.stringify({type:"close",code:301}),"*")};this.onData=function(){this._protocol.dataReceived.apply(this._protocol,\narguments)};this.onClose=function(){this._protocol._connectionLost.apply(this._protocol,arguments)}});\n');
jsio.setCachedSrc("../../packages/net/env/browser/websocket.js",'jsio("import net.interfaces");jsio("import std.utf8 as utf8");jsio("import net.errors as Errors");\nexports.Connector=Class(net.interfaces.Connector,function(){this.connect=function(){this._state=net.interfaces.STATE.CONNECTING;var a=this._opts.url,b=this._opts.wsConstructor||window.WebSocket;logger.info("this._opts",this._opts);a=new b(a);a.onopen=bind(this,"webSocketOnOpen",a);a.onclose=bind(this,"webSocketOnClose",a)};this.webSocketOnOpen=function(a){this.onConnect(new Transport(a))};this.webSocketOnClose=function(a,b){var c;c={rawError:b,webSocket:a};c=b.wasClean?new Errors.ServerClosedConnection("WebSocket Connection Closed",\nc):this._state==net.interfaces.STATE.CONNECTED?new Errors.ConnectionTimeout("WebSocket Connection Timed Out",c):new Errors.ServerUnreachable("WebSocket Connection Failed",c);logger.debug("conn closed",c);this.onDisconnect(c)}});\nvar Transport=Class(net.interfaces.Transport,function(){this.init=function(a){this._ws=a};this.makeConnection=function(a){this._ws.onmessage=function(b){b=utf8.encode(b.data);a.dataReceived(b)}};this.write=function(a){if(this._encoding=="plain"){result=utf8.decode(a);a=result[0]}this._ws.send(a)};this.loseConnection=function(){this._ws.close()}});\n');
jsio.setCachedSrc("../../packages/net/env/node/csp/proxy.js",'jsio("from .util import *");jsio("from .server import csp");var msp=this.msp=exports;\n(function(){var f=["open","close","data"],g={InvalidHandshake:102,UserConnectionReset:103,RemoteConnectionTimeout:104,Unauthorized:106,RemoteConnectionFailed:108,RemoteConnectionClosed:109,ProtocolError:110};msp.ProxyConnection=Class(function(){this.init=function(a){this.inConnection=a;this.inBuffer="";this.outConnections={};this.inConnection.addListener("receive",bind(this,this.receiveData)).addListener("eof",bind(this,this.shutdown)).addListener("disconnect",bind(this,this.shutdown)).setEncoding("bytes")};\nthis.receiveData=function(a){var b;this.inBuffer+=a;try{for(;(b=this.inBuffer.indexOf("["))!=-1;){var c=parseInt(this.inBuffer.slice(0,b))+b;assert(!isNaN(c),"Invalid frame size prefix");if(this.inBuffer.length<c)break;var d=JSON.parse(this.inBuffer.slice(b,c));this.inBuffer=this.inBuffer.slice(c);assert(d instanceof Array&&d.length>=2,"Invalid frame");var h=d.shift(),e=f[d.shift()];assert(e,"Unrecognized frame type");a=d;a.unshift(h);dispatchFrame[e].apply(this,a)}}catch(i){debug("PROTOCOL ERROR: ",\ni.message||"unknown error");this.shutdown(true)}};this.shutdown=function(a){for(var b in this.outConnections){a?this.closeOutgoing(b,"ProtocolError"):this.closeOutgoing(b,"UserConnectionReset");var c=this.outConnections[b];c.listeners("connect")=[];c.listeners("receive")=[];c.listeners("eof")=[];c.listeners("disconnect")=[]}};this.send=function(a){payload=JSON.stringify(a);this.inConnection.send(payload.length+","+payload,"bytes")};this.closeOutgoing=function(a,b){if(a in this.outConnections){this.send([a,\n1,g[b]]);this.outConnections[a].close();delete this.outConnections[a]}};this.dispatchFrame={open:function(a,b,c){assert(!(a in this.outConnections),"OPEN frame for existing connection");assert(b&&c,"Invalid host or port");b=this.outConnections[a]=node.tcp.createConnection(c,b);b.setEncoding("bytes");b.addListener("connect",function(){this.send([a,0])}).addListener("receive",function(d){this.send([a,2,d])}).addListener("eof",function(){this.closeOutgoing(a,"RemoteConnectionClosed")}).addListener("disconnect",\nfunction(){this.closeOutgoing(a,"RemoteConnectionClosed")})},close:function(a){this.closeOutgoing(a,"UserConnectionReset")},data:function(a,b){b=unescape(b);this.outConnections[a].send(b,"bytes")}}});msp.Proxy=Class(function(){this.init=function(){this.cspserver=csp.createServer(function(a){proxyConnection=new msp.ProxyConnection(a)})};this.listen=function(a,b){this.cspserver.listen(a,b)}})})();function start_server(){(new msp.Proxy).listen(8050);log("Proxying from http://:8050")}start_server();\n');
jsio.setCachedSrc("../../packages/net/env/node/csp/util.js",'exports.startswith=function(a,b){return a.substring(0,b.length)==b};exports.JSIOError=Class(Error,function(){this.name="JSIOError";this.toString=Error.prototype.toString;this.init=function(a,b,c){this.name=this.name;this.message=a||"";this.fileName=b||"\\u00abfilename\\u00bb";this.lineNumber=isNaN(+c)?0:+c}});exports.AssertionError=Class(exports.JSIOError,function(a){this.name="AssertionError";this.init=function(){a(this,"init",arguments)}});\nexports.assert=function(a,b){if(!a)throw new exports.AssertionError(b);};exports.reschedule=function(a){return setTimeout(a,0)};exports.staticFile=function(){var a={};return function(b,c){cacheContent=a[b];cacheContent!==undefined?exports.reschedule(function(){c(null,[cacheContent])}):process.fs.readFile(b,"utf8",function(d,e){if(d)c("staticFile readFile error "+d);else{a[b]=e;c(null,[e])}});return promise}}();\n');
jsio.setCachedSrc("../../packages/net/env/node/csp/server.js",'jsio("import std.uuid as uuid");jsio("import std.utf8 as utf8");jsio("import std.base64 as base64");jsio("import lib.Hash as Hash");jsio("from .util import *");var http=jsio.__env.require("http"),nodeUrl=jsio.__env.require("url"),sessionDict={},varNames={ct:"contentType",ps:"prebufferSize",p:"preamble",rp:"requestPrefix",rs:"requestSuffix",bp:"batchPrefix",bs:"batchSuffix",i:"interval",du:"duration",is:"isStreaming",g:"gzipOk",se:"sse"};\nexports.Session=Class(function(){this.init=function(){this.key=uuid.uuid(8);sessionDict[this.key]=this;this.connection=null;this.outgoingPacketBuffer=[];this.incomingPacketBuffer=[];this.lastSequentialIncomingId=0;this.timeoutTimer=this.intervalTimer=this.durationTimer=this.cometResponse=null;this.outgoingPacketId=1;this.variables={contentType:"text/html",prebuffer:"",preamble:"",requestPrefix:"",requestSuffix:"",batchPrefix:"",batchSuffix:"",interval:"0",duration:"30",isStreaming:"0",gzipOk:"",sse:""};\nthis.resetTimeoutTimer()};this.teardownSession=function(){clearTimeout(this.durationTimer);this.connection.readyState=this.connection.readyState==="open"?"writeOnly":"closed";this.connection.emit("eof");delete sessionDict[this.key]};this.send=function(a){a=typeof a==="string"&&/[^\\r\\n\\t\\x32-\\x7E]/.test(a)?[this.outgoingPacketId,1,base64.encode(a)]:[this.outgoingPacketId,0,a];this.outgoingPacketId+=1;this.outgoingPacketBuffer.push(a);this.cometResponse&&this.sendBatch([a])};this.close=function(){this.send(null);\nthis.connection.readyState=this.connection.readyState==="open"?"readOnly":"closed";this.connection.emit("close")};var g=new Hash("gzipOk","contentType");this.updateVars=function(a){for(var b in a){var c=varNames[b];if(c){var h=a[b];g.contains(c)&&h!=this.variables[c]&&this.cometResponse&&this.completeResponse();if(c in this.variables)this.variables[c]=h;else if(c=="prebufferSize"){c=parseInt(h);if(c>0)this.variables.prebuffer=Array(c+1).join(" ")}}}};this.isStreaming=function(){return this.variables.isStreaming===\n"1"&&parseInt(this.variables.duration)>0};this.resetDurationTimer=function(){var a=1E3*parseInt(this.variables.duration);this.durationTimer=setTimeout(bind(this,this.completeResponse),a)};this.resetIntervalTimer=function(){clearTimeout(this.intervalTimer);if(this.variables.interval!=="0"){var a=1E3*parseInt(this.variables.interval);this.intervalTimer=setTimeout(bind(this,this.sendBatch),a)}};this.resetTimeoutTimer=function(){clearTimeout(this.timeoutTimer);var a=1E3*parseInt(this.variables.duration)*\n1.5;this.timeoutTimer=setTimeout(bind(this,this.teardownSession),a)};this.sendHeaders=function(a,b){if(b==="stream")a.writeHead(200,{"Content-Type":this.variables.contentType,"Cache-Control":"no-cache, must-revalidate","Transfer-Encoding":"chunked","Access-Control-Allow-Origin":"*"});else b>=0&&a.writeHead(200,{"Content-Type":this.variables.contentType,"Cache-Control":"no-cache, must-revalidate","Content-Length":b,"Access-Control-Allow-Origin":"*"})};this.startStream=function(){this.sendHeaders(this.cometResponse,\n"stream");var a=this.variables.prebuffer+this.variables.preamble;a&&this.cometResponse.write(a);this.resetIntervalTimer()};this.sendBatch=function(a){a||(a=[]);var b=this.variables.batchPrefix+"(",c=")"+this.variables.batchSuffix;if(this.variables.sse==="1"&&a)c+="id: "+a[a.length-1][0]+"\\r\\n";a=b+JSON.stringify(a)+c;if(this.isStreaming()){this.cometResponse.write(a);this.resetIntervalTimer()}else{a=this.variables.prebuffer+this.variables.preamble+a;this.sendHeaders(this.cometResponse,a.length);this.cometResponse.write(a);\nthis.cometResponse.end();this.cometResponse=null;clearTimeout(this.durationTimer)}};this.completeResponse=function(){if(this.isStreaming()){this.cometResponse.end();this.cometResponse=null;clearTimeout(this.durationTimer);clearTimeout(this.intervalTimer)}else this.sendBatch()};this.receiveAck=function(a){for(this.resetTimeoutTimer();this.outgoingPacketBuffer.length&&a>=this.outgoingPacketBuffer[0][0];)this.outgoingPacketBuffer.shift()};this.renderResponse=function(a,b){b=this.variables.requestPrefix+\n"("+b+(")"+this.variables.requestSuffix);this.sendHeaders(a,b.length);a.write(b);a.end()};this.dispatch={handshake:function(a,b){this.renderResponse(b,JSON.stringify({session:this.key}))},comet:function(a,b){this.cometResponse=b;this.isStreaming()&&this.startStream();this.outgoingPacketBuffer.length&&this.sendBatch(this.outgoingPacketBuffer);if(!this.outgoingPacketBuffer.length||this.isStreaming())this.resetDurationTimer()},send:function(a,b){var c=JSON.parse(a.data);for(logger.debug("received packet batch:",\nc);c[0]!=undefined;){var h,i=c.shift(),d=i[0],e=i[1];i=i[2];if(i===null)this.close();else if(e===0)h=i;else if(e===1)h=base64.decode(i);else{logger.debug("BAD PACKET ENCODING,",e,"... dropping packet");break}this.incomingPacketBuffer[d-1-this.lastSequentialIncomingId]=h}for(logger.debug("incomingPacketBuffer",this.incomingPacketBuffer);this.incomingPacketBuffer[0]!==undefined;){c=this.incomingPacketBuffer.shift();this.lastSequentialIncomingId+=1;this.connection._receive(c)}this.renderResponse(b,\'"OK"\')},\nclose:function(a,b){this.teardownSession();this.renderResponse(b,\'"OK"\')},reflect:function(a,b){var c=a.data;this.sendHeaders(b,c.length);b.write(c);b.end()},streamtest:function(){logger.debug("streamtest")}}});\nexports.Connection=Class(process.EventEmitter,function(){this.init=function(b){this.remoteAddress=null;this.readyState="open";this._session=b;this._encoding="binary";this._utf8buffer=""};this._receive=function(b){if(this._encoding==="utf8"){this._utf8buffer+=b;var c=utf8.decode(this._utf8buffer);b=c[0];this._utf8buffer=this._utf8buffer.slice(c[1])}this.emit("receive",b)};var g=new Hash("utf8","plain","binary");this.setEncoding=function(b){assert(g.contains(b),"unrecognized encoding: "+b);b!=="utf8"&&\nassert(!this._utf8buffer,"cannot switch encodings with dirty utf8 buffer");this._encoding=b};var a=new Hash("writeOnly","open");this.send=function(b,c){if(!a.contains(this.readyState))throw Error("Socket is not writable in readyState: "+this.readyState);c=c||this._encoding||"binary";assert(g.contains(c),"unrecognized encoding: "+c);b=c==="utf8"?utf8.encode(b):b;this._session.send(b)};this.close=function(){this._session.close()}});\nexports.createServer=function(g){return(new exports.Server).addListener("connection",g)};\nexports.Server=Class(process.EventEmitter,function(){this.init=function(d){process.EventEmitter.call(this);this._sessionUrl=d||"";log("starting server, session url is <"+this._sessionUrl+">")};var g=Class(AssertionError,function(d){this.name="CSPError";this.init=function(e){d(this,"init",f);this.code=e;var f=Array.prototype.slice.call(arguments,1)}}),a=function(d,e,f){if(!d)throw new g(e,f);},b=function(d,e,f){d.writeHead(e,{"Content-Type":"text/plain","Content-Length":f.length});d.write(f);d.end()},\nc=function(d,e){if(d.method==="GET")reschedule(function(){e("")});else{var f=[];d.setEncoding("binary");d.addListener("data",function(l){f.push(l)}).addListener("end",function(){e(f.join(""))})}},h=new Hash("static","handshake","comet","send","close","reflect","streamtest"),i=new Hash("GET","POST");this._handleRequest=function(d,e){c(d,bind(this,function(f){logger.debug("received request",d.url);try{var l=nodeUrl.parse(d.url,true),m=l.pathname,q=this._sessionUrl;a(startswith(m,q+"/"),404,"Request to invalid session URL");\nlogger.debug(d.method);a(i.contains(d.method),405,"Invalid HTTP method, "+d.method);var n=m.split("/").pop();if(n==="static")a(startswith(m,q+"/"),404,"sendStatic Not Implemented");else{a(h.contains(n),404,"Invalid resource, "+m);var k=l.query;d.data=f||k.d||null;if(n==="handshake"){a(!k.s,400,"Handshake cannot have session");try{var r=JSON.parse(d.data);assert(r instanceof Object&&!(r instanceof Array))}catch(s){logger.debug("INVALID HANDSHAKE, ",d,s);throw new g(400,"Invalid data parameter for handshake");\n}var j=new exports.Session,p=new exports.Connection(j);j.connection=p;this.emit("connection",p);p.emit("connect")}else{j=sessionDict[k.s];a(j,400,"Invalid or missing session");var t=parseInt(d.headers["Last-Event-Id"])||parseInt(k.a)||-1;j.receiveAck(t)}j.updateVars(k);j.dispatch[n].call(j,d,e)}}catch(o){if(o instanceof g)b(e,o.code,o.message);else{logger.warn("Unexpected Error: ",o.message);b(e,500,"Unknown Server error")}}}))};this.listen=function(d,e){var f=http.createServer(bind(this,this._handleRequest));\nif(!d)throw logger.error("No port specified");f.listen(d,e)}});\n');
jsio.setCachedSrc("../../packages/std/uuid.js",'var CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");exports.uuid=function(f,c){var d=CHARS,a=[],g=Math.random;c=c||d.length;if(f)for(var b=0;b<f;b++)a[b]=d[0|g()*c];else{var e;a[8]=a[13]=a[18]=a[23]="-";a[14]="4";for(b=0;b<36;b++)if(!a[b]){e=0|g()*16;a[b]=d[b==19?e&3|8:e&15]}}return a.join("")};\n');jsio.setCachedSrc("../../packages/net/env/node/csp.js",'jsio("import net.interfaces");jsio("from .csp.server import createServer");var Transport=Class(net.interfaces.Transport,function(){this.init=function(a){this._socket=a;logger.debug("init",a)};this.makeConnection=function(a){logger.debug("makeConnection:",a);this._socket.addListener("receive",bind(a,"dataReceived"));this._socket.addListener("eof",this._socket.close);this._socket.addListener("close",bind(a,"connectionLost"))};this.write=function(a){this._socket.send(a)};this.loseConnection=function(){this._socket.forceClose()}});\nexports.Listener=Class(net.interfaces.Listener,function(){this.listen=function(){var a=createServer(bind(this,function(b){logger.info("Incoming connection");b.setEncoding("utf8");b.addListener("connect",bind(this,function(){this.onConnect(new Transport(b))}))}));this._cspServer=a;var c=(this._opts["interface"]||"")+":"+this._opts.port;if(!this._opts.skipListen){logger.info("Listening csp@"+c);a.listen(this._opts.port,this._opts["interface"]||"")}}});\n');
jsio.setCachedSrc("../../packages/net/env/node/stdio.js",'jsio("import net.interfaces");\nvar Transport=Class(net.interfaces.Transport,function(b){this.init=function(a,c){this._inStream=a;this._outStream=c;this.setEncoding("plain")};this.setEncoding=function(a){b(this,"setEncoding",arguments);if(a=="plain")a="binary";this._inStream.setEncoding(a);this._outStream.setEncoding(a)};this.makeConnection=function(a){this._inStream.on("data",bind(a,"dataReceived"));this._inStream.on("end",bind(a,"connectionLost"))};this.write=function(a){this._outStream.write(a);this._outStream.flush()};this.loseConnection=\nfunction(){}});exports.Connector=Class(net.interfaces.Connector,function(){this.connect=function(){var b=process.openStdin();this.onConnect(new Transport(b,process.stdout))}});\n');
jsio.setCachedSrc("../../packages/net/env/node/tcp.js",'jsio("import net.interfaces");var nodeTcp=jsio.__env.require("net"),Transport=Class(net.interfaces.Transport,function(){this.init=function(a){this._socket=a};this.makeConnection=function(a){this._socket.addListener("data",bind(a,"dataReceived"));this._socket.addListener("close",bind(a,"connectionLost"));this._socket.addListener("end",this._socket.close)};this.write=function(a){this._socket.write(a)};this.loseConnection=function(){this._socket.forceClose()}});\nexports.Connector=Class(net.interfaces.Connector,function(){this.connect=function(){var a=nodeTcp.createConnection(this._opts.port,this._opts.host);a.addListener("connect",bind(this,function(){this.onConnect(new Transport(a))}));this._opts.encoding="plain";a.setEncoding("binary");typeof this._opts.timeout=="number"&&a.setTimeout(this._opts.timeout)}});\nexports.Listener=Class(net.interfaces.Listener,function(){this.listen=function(){var a=nodeTcp.createServer(bind(this,function(b){typeof this._opts.timeout=="number"&&b.setTimeout(this._opts.timeout);b.setEncoding("utf8");b.addListener("connect",bind(this,function(){this.onConnect(new Transport(b))}))}));logger.info("Listening tcp@"+((this._opts["interface"]||"")+":"+this._opts.port));a.listen(this._opts.port,this._opts["interface"]||"")}});\n');
jsio.setCachedSrc("../../packages/net/protocols/buffered.js",'jsio("from net.interfaces import Protocol");jsio("from net.buffer import Buffer");exports.BufferedProtocol=Class(Protocol,function(){this.init=function(){this.buffer=new Buffer};this.bufferUpdated=function(){};this.dataReceived=function(a){this.buffer.append(a);this.bufferUpdated()}});\n');jsio.setCachedSrc("../../packages/net/buffer.js",'jsio("from net.interfaces import Protocol");var EmptyBufferError=exports.EmptyBufferError=Class(function(){this.init=function(a){this.message=a}});\nexports.Buffer=Class(function(){this.init=function(a){this._rawBuffer=a?a:""};this.getLength=function(){return this._rawBuffer.length};this.append=function(a){logger.debug("append",JSON.stringify(a));this._rawBuffer+=a};this.peekBytes=function(a){return a?this._rawBuffer.slice(0,a):this._rawBuffer};this.peekToDelimiter=function(a){a=a?a:"\\n";var b=this._rawBuffer.indexOf(a);if(b==-1)throw new EmptyBufferError("delimiter "+a+"not present in buffer");else return this._rawBuffer.slice(0,b)};this.consumeBytes=\nfunction(a){a=this.peekBytes(a);this._rawBuffer=this._rawBuffer.slice(a.length);return a};this.consumeMaxBytes=function(a){var b=this._rawBuffer.slice(0,a);this._rawBuffer=this._rawBuffer(a);return b};this.consumeAllBytes=function(){var a=this._rawBuffer;this._rawBuffer="";return a};this.consumeThroughDelimiter=function(a){return this.consumeToDelimiter(a)+this.consumeBytes(a.length)};this.consumeToDelimiter=function(a){a=a?a:"\\n";a=this.peekToDelimiter(a);this._rawBuffer=this._rawBuffer.slice(a.length);\nreturn a};this.hasBytes=function(a){a=a?a:0;return this._rawBuffer.length>=a};this.hasDelimiter=function(a){a=a?a:"\\n";return this._rawBuffer.indexOf(a)!=-1}});\n');
jsio.setCachedSrc("../../packages/net/protocols/Cuppa.js",'jsio("import lib.Callback;");jsio("import lib.PubSub;");jsio("from net.protocols.rtjp import RTJPProtocol;");logger.setLevel(0);\nvar Error=Class(function(){this.init=function(d,a,c,b,e){this.id=a;this.msg=c;this.details=b;this.requestId=e}}),RPCRequest=Class(function(){this.init=function(d,a){this.protocol=d;this.id=a;this._onError=new lib.Callback;this._onSuccess=new lib.Callback};this.onError=function(){this._onError.forward(arguments)};this.onSuccess=function(){this._onSuccess.forward(arguments)};this.bindLater=function(d){var a=[].slice(arguments,1);this._onError.forward([d,d.fail].concat(a));this._onSuccess.forward([d,\nd.succed].concat(a));return d}}),ReceivedRequest=Class(function(){this.type="request";this.init=function(d,a,c,b,e){this.protocol=d;this.id=a;this.name=c;this.responded=false;this.args=b;this.target=e};this.error=function(d,a){if(this.responded)throw Error("already responded");if(this._timer){clearTimeout(this._timer);this._timer=null}args={id:this.id,msg:d+""};if(a!==undefined)args.details=a;this.responded=true;this.protocol.sendFrame("ERROR",args)};this.respond=function(d){if(this.responded)throw Error("already responded");\nif(this._timer){clearTimeout(this._timer);this._timer=null}this.responded=true;this.protocol.sendFrame("RESPONSE",{id:this.id,args:d==undefined?{}:d})};this.timeoutAfter=function(d,a){if(!this.responded){this._timer&&clearTimeout(this._timer);this._timer=setTimeout(bind(this,"_timeout",a),d)}};this._timeout=function(d){this.responded||this.error(d)}}),ReceivedEvent=Class(function(){this.init=function(d,a,c,b,e){this.id=a;this.name=c;this.args=b;this.target=e}});\nexports=Class(RTJPProtocol,function(d){this.init=function(){d(this,"init",arguments);this._onConnect=new lib.Callback;this._onDisconnect=new lib.Callback;this._requests={};this.onEvent=new lib.PubSub;this.onRequest=new lib.PubSub};this.disconnect=function(){this.transport.loseConnection()};this.onConnect=function(){this._onConnect.forward(arguments)};this.onDisconnect=function(){this._onDisconnect.forward(arguments)};this.reset=function(){this._onConnect.reset();this._onDisconnect.reset()};this.connectionMade=\nfunction(){this._isConnected=true;this._onConnect.fire()};this.connectionLost=function(a){for(var c in this._requests){var b=this._requests[c];delete this._requests[c];b._onError.fire(a)}this._isConnected=false;this._onDisconnect.fire(a)};this.sendRequest=function(a,c,b,e){if(arguments.length>4)e=bind.apply(GLOBAL,Array.prototype.slice.call(arguments,3));logger.debug("SEND REQUEST",a,c,b);var f={name:a,args:c};if(b)f.target=b;f=this.sendFrame("RPC",f);f=this._requests[f]=new RPCRequest(this,f);if(e){f.onSuccess(GLOBAL,\ne,false);f.onError(GLOBAL,e)}return f};this.sendEvent=function(a,c,b){logger.debug("SEND EVENT",a,c,b);this.sendFrame("EVENT",{name:a,args:c,target:b||null})};this.frameReceived=function(a,c,b){logger.debug("RECEIVED",a,c,b);switch(c.toUpperCase()){case "RESPONSE":var e=this._requests[b.id];if(!e)return;delete this._requests[b.id];e._onSuccess.fire(b.args);break;case "ERROR":c=b.msg||"unknown";var f=b.id;e=this._requests[f];a=Error(this,a,c,b.details,f);if(e){delete this._requests[f];e._onError.fire(a)}else return this.errorReceived(a);\nbreak;case "RPC":case "EVENT":logger.debug("RECEIVED",c,b.name);if(!b.name)return self.sendFrame("ERROR",{id:b.id||a,msg:\'missing "name"\'});e=b.args||{};f=b.target||null;var g=c.toUpperCase()=="RPC";c=g?this.onRequest:this.onEvent;e=new (g?ReceivedRequest:ReceivedEvent)(this,b.id||a,b.name,e,f);c.publish(e.name,e);break;default:break}}});\n');
jsio.setCachedSrc("../../packages/net/protocols/rtjp.js",'jsio("import net.interfaces");jsio("from net.protocols.delimited import DelimitedProtocol");\nexports.RTJPProtocol=Class(DelimitedProtocol,function(c){this.init=function(){c(this,"init",["\\r\\n"]);this.frameId=0};this.connectionMade=function(){this._client&&this._client.connectionMade&&this._client.connectionMade();logger.debug("connectionMade")};this.frameReceived=function(){};this.sendFrame=function(b,a){a||(a={});logger.debug("sendFrame",b,a);this.sendLine(JSON.stringify([++this.frameId,b,a]));return this.frameId};this.lineReceived=function(b){try{var a=JSON.parse(b);if(a.length!=3){logger.error("Invalid frame length");\nreturn}if(typeof a[0]!="number"){logger.error("Invalid frame id");return}if(typeof a[1]!="string"){logger.error("Invalid frame name");return}logger.debug("frameReceived:",a[0],a[1],a[2])}catch(d){logger.error(d)}a&&this.frameReceived(a[0],a[1],a[2])};this.connectionLost=function(){logger.debug("conn lost")}});\n');
jsio.setCachedSrc("../../packages/net/protocols/delimited.js",'jsio("import net.interfaces");\nexports.DelimitedProtocol=Class(net.interfaces.Protocol,function(){this.init=function(a){a||(a="\\r\\n");this.delimiter=a;this.buffer=""};this.connectionMade=function(){logger.debug("connectionMade")};this.dataReceived=function(a){if(a){logger.debug("dataReceived:("+a.length+")",a);logger.debug("last 2:",a.slice(a.length-2));this.buffer+=a;for(logger.debug("index",this.buffer.indexOf(this.delimiter));(a=this.buffer.indexOf(this.delimiter))!=-1;){var b=this.buffer.slice(0,a);this.buffer=this.buffer.slice(a+\nthis.delimiter.length);this.lineReceived(b)}}};this.lineReceived=function(a){logger.debug("Not implemented, lineReceived:",a)};this.sendLine=function(a){logger.debug("WRITE:",a+this.delimiter);this.transport.write(a+this.delimiter)};this.connectionLost=function(){logger.debug("connectionLost")}});\n');
jsio.setCachedSrc("../../packages/net/protocols/echo.js",'jsio("import net.interfaces");exports.Protocol=Class(net.interfaces.Protocol,function(){this.connectionMade=function(){logger.debug("in connectionMade");this.transport.write("Welcome")};this.dataReceived=function(a){logger.debug("dataReceived:",a);this.transport.write("Echo: "+a)};this.connectionLost=function(){logger.debug("conn lost")}});exports.Server=Class(net.interfaces.Server,function(a){this.init=function(){a(this,"init",[exports.Protocol])}});\n');
jsio.setCachedSrc("../../packages/net/protocols/mspp.js",'jsio("import net");jsio("from net.protocols.buffered import BufferedProtocol");jsio("import std.utf8 as utf8");var loggers={};loggers.stream=logging.getLogger("MSPPStream");loggers.protocol=logging.getLogger("MSPPProtocol");var frames={OPEN:0,CLOSE:1,DATA:2};\nexports.MSPPStream=Class(function(){this.setMultiplexer=function(b){loggers.stream.debug("setMultiplexer: "+b);this.multiplexer=b};this.setEncoding=function(b){loggers.stream.debug("setEncoding: "+b);this.encoding=b};this.open=function(b,a,c){if(c)this.encoding="utf8";this.id=this.multiplexer.openStream(this,b,a);loggers.stream.debug("open "+this.id+": "+b+" "+a+" "+c)};this.close=function(){loggers.stream.debug("close "+this.id);this.multiplexer.close(this.id)};this.send=function(b,a){loggers.stream.debug("send "+\nthis.id+": "+b+" "+a);if((a||this.encoding)=="utf8")b=utf8.encode(b);this.multiplexer.writeToStream(this.id,b)};this._onreadraw=function(b){if(this.encoding=="utf8"){var a=utf8.decode(b);if(a[1]!=b.length)throw Error("Incomplete utf8 codepoint");b=a[0]}loggers.stream.debug("_onreadraw "+b);this.onread(b)};this.onopen=function(){};this.onclose=function(){};this.onread=function(){}});var state={};state.closed=0;state.connecting=1;state.consuming=2;\nexports.MSPPProtocol=Class(BufferedProtocol,function(b){this.init=function(){loggers.protocol.debug("new MSPPProtocol");b(this,"init",[]);this.state=state.closed;this.transportOptions=this.transportType=null;this.currentId=0;this.streams={};this.writeBuffer=[]};this.setTransport=function(a,c){this.transportType=a;this.transportOptions=c};this.connectionMade=function(){loggers.protocol.debug("connectionMade");this.state=state.consuming;for(var a=0;a<this.writeBuffer.length;a++)this._write(this.writeBuffer[a]);\nwriteBuffer=[]};this.connectionLost=function(a){loggers.protocol.debug("closed: "+a);this.state=state.closed;for(var c in this.streams)this.streams[c].onclose(a)};this.openStream=function(a,c,d){if(this.state==state.closed){this.state=state.connecting;net.connect(this,this.transportType,this.transportOptions)}var e=++this.currentId;this.streams[e]=a;this._write([e,frames.OPEN,c+","+d]);return e};this.closeStream=function(a){this._write([a,frames.CLOSE,""])};this.writeToStream=function(a,c){this._write([a,\nframes.DATA,c])};this.bufferUpdated=function(){loggers.protocol.debug("bufferUpdated. state: "+this.state+". buffer: "+this.buffer._rawBuffer);if(this.state!=state.consuming)throw Error("buffer update in invalid MSPP state: "+this.state);if(this.buffer.hasDelimiter(":")){var a=this.buffer.peekToDelimiter(":"),c=parseInt(a);if(this.buffer.hasBytes(c+a.length+1)){this.buffer.consumeThroughDelimiter(":");a=this.buffer.consumeToDelimiter(",");this.buffer.consumeBytes(1);var d=parseInt(this.buffer.consumeBytes(1));\nc-=a.length+2;a=parseInt(a);c=this.buffer.consumeBytes(c);switch(d){case frames.OPEN:this.streams[a].onopen();break;case frames.CLOSE:this.streams[a].onclose(c);break;case frames.DATA:this.streams[a]._onreadraw(c);break;default:throw Error("invalid MSPP data type!");}}}};this._write=function(a){if(this.state!=state.consuming){loggers.protocol.debug("buffering write: "+a);this.writeBuffer.push(a)}else{a=a[0]+","+a[1]+a[2];a=a.length+":"+a;loggers.protocol.debug("write: "+a);this.transport.write(a)}}});\n');
jsio.setCachedSrc("../../packages/net/protocols/stomp.js",'jsio("from net.protocols.buffered import BufferedProtocol");jsio("from util.sprintf import sprintf");\nexports.StompProtocol=Class(BufferedProtocol,function(b){this.init=function(){b(this,"init",[]);this.state="peek"};this.connect=function(a,c){var d=new StompFrame("CONNECT");a&&d.setHeader("login",a);c&&d.setHeader("passcode",c);this.sendFrame(d)};this.send=function(a,c,d){c=new StompFrame("SEND",c,d);c.setHeader("destination",a);this.sendFrame(c)};this.subscribe=function(a,c){var d=new StompFrame("SUBSCRIBE",null,c);d.setHeader("destination",a);this.sendFrame(d)};this.unsubscribe=function(a,c){var d=\nnew StompFrame("UNSUBSCRIBE",null,c);d.setHeader("destination",a);this.sendFrame(d)};this.sendFrame=function(a){this.transport.write(a.serialize())};this.frameReceived=function(a){logger.info("frame received",a)};this.bufferUpdated=function(){logger.debug("bufferUpdated");for(var a=0;++a<10;)switch(this.state){case "peek":if(this.buffer.peekBytes(1)=="\\n"){logger.debug("consuming a single \\n byte");this.buffer.consumeBytes(1)}this.state="method";case "method":logger.debug("case method");if(!this.buffer.hasLine())return;\nthis._frame=new StompFrame;var c=this.buffer.consumeThroughDelimiter();logger.debug("method is",JSON.stringify(c));this._frame.setMethod(c);this.state="headers";case "headers":logger.debug("case headers");for(c=0;this.buffer.hasLine()&&++c<10;){var d=this.buffer.consumeThroughDelimiter();if(d.length==0){this.state="body";break}var e=d.split(":");d=e[0];for(e=e.slice(1).join(":");e[0]==" ";)e=e.slice(1);for(;e[1]==" ";)e=e.slice(0,e.length-1);logger.debug("add header",d,e);this._frame.setHeader(d,\ne)}if(this.state=="headers")return;case "body":if(this._frame.getBodyMode()=="length"){if(!this.buffer.hasBytes(this._frame.getContentLength()+1))return;this._frame.setBody(this.buffer.consumeBytes(this._frame.getContentLength()));this.buffer.consumeBytes(1)}else{if(!this.buffer.hasLine("\\u0000"))return;this._frame.setBody(this.buffer.consumeThroughDelimiter("\\u0000"))}this.frameReceived(this._frame);this._frame=null;this.state="peek"}}});\nvar StompFrame=exports.StompFrame=Class(function(){this.init=function(b,a,c){this._headers=c?c:{};this._method=b?b:null;this._body=a?a:""};this.setHeader=function(b,a){this._headers[b]=a};this.getHeader=function(b){return this._headers[b]};this.getHeaders=function(){return this._headers};this.setMethod=function(b){this._method=b};this.getMethod=function(){return this._method};this.setBody=function(b){this._body=b};this.getbody=function(){return this._body};this.toString=function(){var b=0;for(var a in this._headers)++b;\nreturn sprintf("[StompFrame method(%s), num-headers(%d), body-length(%d)]",this._method,b,this._body.length)};this.getContentLength=function(){return parseInt(this._headers["content-length"])};this.getBodyMode=function(){if("content-length"in this._headers)return"length";return"delimited"};this.serialize=function(){var b=this._method+"\\n";for(var a in this._headers)b+=a+": "+this._headers[a]+"\\n";b+="content-length: "+this._body.length+"\\n";b+="\\n";b+=this._body;b+="\\u0000";return b}});\n');
jsio.setCachedSrc("../../packages/util/sprintf.js",'var sprintfWrapper={init:function(){if(typeof arguments=="undefined")return null;if(arguments.length<1)return null;if(typeof arguments[0]!="string")return null;if(typeof RegExp=="undefined")return null;var a=arguments[0],d=RegExp(/(%([%]|(\\-)?(\\+|\\x20)?(0)?(\\d+)?(\\.(\\d)?)?([bcdfosxX])))/g),b=[],e=[],f=0,g=0,i=0;g=0;for(var h="",c=null;c=d.exec(a);){if(c[9])f+=1;g=g;i=d.lastIndex-c[0].length;e[e.length]=a.substring(g,i);g=d.lastIndex;b[b.length]={match:c[0],left:c[3]?true:false,sign:c[4]||"",pad:c[5]||\n" ",min:c[6]||0,precision:c[8],code:c[9]||"%",negative:parseInt(arguments[f])<0?true:false,argument:typeof arguments[f]=="object"?JSON.stringify(arguments[f]):String(arguments[f])}}e[e.length]=a.substring(g);if(b.length==0)return a;if(arguments.length-1<f)return null;a=null;for(a=0;a<b.length;a++){if(b[a].code=="%")substitution="%";else if(b[a].code=="b"){b[a].argument=String(Math.abs(parseInt(b[a].argument)).toString(2));substitution=sprintfWrapper.convert(b[a],true)}else if(b[a].code=="c"){b[a].argument=\nString(String.fromCharCode(parseInt(Math.abs(parseInt(b[a].argument)))));substitution=sprintfWrapper.convert(b[a],true)}else if(b[a].code=="d"){b[a].argument=String(Math.abs(parseInt(b[a].argument)));substitution=sprintfWrapper.convert(b[a])}else if(b[a].code=="f"){b[a].argument=String(Math.abs(parseFloat(b[a].argument)).toFixed(b[a].precision?b[a].precision:6));substitution=sprintfWrapper.convert(b[a])}else if(b[a].code=="o"){b[a].argument=String(Math.abs(parseInt(b[a].argument)).toString(8));substitution=\nsprintfWrapper.convert(b[a])}else if(b[a].code=="s"){b[a].argument=b[a].argument.substring(0,b[a].precision?b[a].precision:b[a].argument.length);substitution=sprintfWrapper.convert(b[a],true)}else if(b[a].code=="x"){b[a].argument=String(Math.abs(parseInt(b[a].argument)).toString(16));substitution=sprintfWrapper.convert(b[a])}else if(b[a].code=="X"){b[a].argument=String(Math.abs(parseInt(b[a].argument)).toString(16));substitution=sprintfWrapper.convert(b[a]).toUpperCase()}else substitution=b[a].match;\nh+=e[a];h+=substitution}h+=e[a];return h},convert:function(a,d){a.sign=d?"":a.negative?"-":a.sign;var b=a.min-a.argument.length+1-a.sign.length;b=Array(b<0?0:b).join(a.pad);return a.left?a.pad=="0"||d?a.sign+a.argument+b.replace(/0/g," "):a.sign+a.argument+b:a.pad=="0"||d?a.sign+b+a.argument:b+a.sign+a.argument}};exports.sprintf=sprintfWrapper.init;\n');
jsio.setCachedSrc("../../packages/net/later.js",'exports.Later=Class(function(){this.init=function(){this.eb=this.cb=null;this.values=[];this.errors=[];this.cancelback=null};this.succeed=this.callback=function(){logger.debug("callback",[].slice.call(arguments,0));if(this.cb)this.cb.apply(this,arguments)==false&&this.cancel();else this.values.push(arguments)};this.fail=this.errback=function(){logger.debug("eb",[].slice.call(arguments,0));this.eb?this.eb.apply(this,arguments):this.errors.push(arguments)};this.cancel=function(){if(this.cancelback){var a=\nthis.cancelback;this.cancelback=null;a.call(this)}};this.setCallback=function(a){this.cb=a;a=0;for(var b;b=this.values[a];++a)this.cb.apply(this,b);this.values=[];return this};this.setErrback=function(a){this.eb=a;for(a=0;e=this.errors[a];++a)this.eb.apply(this,e);this.errors=[];return this};this.setCancelback=function(a){this.cancelback=a;return this}});exports.Later.fail=function(){var a=new Later;return a.fail.apply(a,arguments)};\nexports.Later.succeed=function(){var a=new Later;return a.succeed.apply(a,arguments)};\n');
jsio.setCachedSrc("../../packages/preprocessors/class.js","var importExpr=/^([^'\"]*)(class\\s+([a-zA-Z][a-zA-Z0-9]*)\\s+.*|from\\s+.*)$/gm;exports=function(b,a){a.src=a.src.replace(importExpr,'$1jsio(\"$2\");')};\n");jsio.setCachedSrc("../../packages/preprocessors/import.js","var importExpr=/^(\\s*)(import\\s+.*|from\\s+.*)$/gm;exports=function(b,a){a.src=a.src.replace(importExpr,'$1jsio(\"$2\");')};\n");jsio.setCachedSrc("../../packages/preprocessors/sanswith.js",'var jsioImportG=/jsio\\s*\\(\\s*[\'"](.+?)[\'"]\\s*(,\\s*(\\{[^}]+\\}))?\\)/g,jsioImport=/jsio\\s*\\(\\s*[\'"](.+?)[\'"]\\s*(,\\s*(\\{[^}]+\\}))?\\)/,cmds=jsio.__jsio.__cmds,gModuleScope;\nexports=function(e,b){gModuleScope=[];b.src=b.src.replace(jsioImportG,function(d){d=d.match(jsioImport);for(var c=[],h=d[1],f={},a=0;cmds[a];++a)if(cmds[a]({},h,f,c))break;a=0;for(var g=c.length;a<g;++a)if(c[a])if(c[a].as)c[a]=codeConstruct(c[a].as)+codeImport(c[a].from,d[3]||"");else if(c[a]["import"]){h=[];f=[];g=c[a]["import"];for(var j in g){h.push(j);f.push(g[j])}c[a]="var "+f.join(",")+";(function() {var a="+codeImport(c[a].from)+";";var i=0;for(g=f.length;i<g;++i)c[a]+=f[i]+"=a."+h[i];c[a]+=\n"})();"}return"/*| "+d[0]+"; */ "+c.join("")});if(gModuleScope.length)b.src="var "+gModuleScope.join(",")+";"+b.src};GLOBAL.__jsiomerge=function(e,b){for(var d in b)d in e||(e[d]=b[d]);return e};function codeConstruct(e){var b=e.split(".");for(e=0;e<b.length;++e)b[e]||b.splice(e--,1);var d=b.shift(),c=b.length-1;gModuleScope.push(d);return c==-1?d+"=":"if(!"+d+")"+d+"={};"+b.map(function(h,f){var a=d+"."+b.slice(0,f+1).join(".");return f!=c?"if(!"+a+")"+a+"={};":a+"="}).join("")}var _jsio="jsio";\nfunction codeImport(e,b){return _jsio+\'("import \'+e+\'", __jsiomerge(\'+(b||"{}")+", {dontExport: true}))"};\n');
jsio.setCachedSrc("../../packages/std/XML.js",'exports.parseString=function(b){if(jsio.__env.name=="browser")if(window.ActiveXObject){var a=new ActiveXObject("Microsoft.XMLDOM");return a.loadXML(b)}else{a=new DOMParser;return a.parseFromString(b,"text/xml")}};\n');jsio.setCachedSrc("../../packages/util/ajax.js",'jsio("import std.uri as URI;");var doc;exports.getDoc=function(){if(doc)return doc;try{if(doc=window.ActiveXObject&&new ActiveXObject("htmlfile")){doc.open().write("<html></html>");doc.close();window.attachEvent("onunload",function(){try{doc.body.innerHTML=""}catch(c){}doc=null})}}catch(a){}doc||(doc=document);return doc};var ctor=function(){var a=window;exports.getDoc();return new (ctor=a.XMLHttpRequest?a.XMLHttpRequest:function(){return a.ActiveXObject&&new a.ActiveXObject("Msxml2.XMLHTTP")||null})};\nexports.createXHR=function(){return new ctor};exports.post=function(a,c){return exports.get(merge({method:"POST"},a),c)};\nexports.get=function(a,c){if(typeof a=="string")a={url:a};var d=a.method||"GET",e=a.url,b=a.data&&typeof a.data=="object";if(a.url){var f=d=="POST"?b?JSON.stringify(a.data):a.data:null;if(d=="GET"&&a.data)e=(new URI(e)).addQuery(b?a.data:URI.parseQuery(a.data)).toString();b=exports.createXHR();b.open(d,e,a.async!=false);b.setRequestHeader("Content-Type","text/plain");if(c)b.onreadystatechange=bind(this,onReadyStateChange,b,a.type,c);b.send(f||null)}else logger.error("no url provided")};\nfunction onReadyStateChange(a,c,d){if(a.readyState==4)if(a.status!=200&&a.status!=0)d({status:a.status,response:a.response},null);else{a=a.responseText;if(c=="json")a=JSON.parse(a);d(null,a)}};\n');
jsio.setCachedSrc("../../packages/util/Animation.js",'var SyncTimer=Class(function(){this.init=function(){this._items=[];this._tick=bind(this,"tick");this._length=0};this.tick=function(){var a=+new Date,b=a-this._last;this._last=a;for(a=0;a<this._length;++a)this._items[a](b)};this.add=function(a){if(a){this._items.push(a);++this._length;a(0);this.start()}};this.remove=function(a){for(var b=0,c=this._items.length;b<c;++b)if(this._items[b]==a){this._items.splice(b,1);--this._length||this.stop();return}};this.start=function(){if(!this._isRunning){this._isRunning=\ntrue;this._last=+new Date;this._timer=setInterval(this._tick,15)}};this.stop=function(){if(this._isRunning){this._isRunning=false;clearInterval(this._timer)}}}),timer=new SyncTimer;\nexports=Class(function(){this.init=function(a){this._start="start"in a?a.start:0;this._end="end"in a?a.end:1;this._transition=a.transition||null;this._easing=a.easing||false;this._subject=a.subject;this._duration=a.duration||1E3;this._s=a.current||this._start;this._onFinish=a.onFinish||null;this._range=this._end-this._start;this._isAnimating=false;this._animate=bind(this,"animate");this._timer=null};this.stop=function(){this.jumpTo(this._s)};this.play=function(){this.seekTo(this._end)};this.seekTo=\nfunction(a,b){if(a!=this._s){this._t0=0;this._s0=this._s;this._s1=a;if(b)this._duration=b;this._ds=a-this._s;var c=this._ds/this._range*this._duration;this._dt=c<0?-c:c;if(!this._isAnimating){this._isAnimating=true;timer.add(this._animate)}return this}};this.onFinish=function(a){this._onFinish=a;return this};this.jumpTo=function(a){this._s1=this._s0=a;this._t0=0;this._dt=1;this._ds=0;this.animate(0);return this};this.animate=function(a){a=(this._t0+=a)/this._dt;if(a>1)a=1;this._s=this._s0+a*this._ds;\nvar b=this._transition?this._transition(this._s):this._s;try{this._subject(b,this._s)}finally{if(a==1){timer.remove(this._animate);this._isAnimating=false;this._onFinish&&this._onFinish()}}}});exports.linear=function(a){return a};exports.easeIn=function(a){return a*a};exports.easeInOut=function(a){return(a*=2)<1?0.5*a*a*a:0.5*((a-=2)*a*a+2)};exports.easeOut=function(a){return a*(2-a)};\n');
jsio.setCachedSrc("../../packages/util/jslint.js",'logger.warn("String.prototype has been modified.  Current browser session should only be used for debugging.");\nvar JSLINT=exports=function(){function pb(){}function U(b,d){return Object.prototype.hasOwnProperty.call(b,d)}function sa(b,d){var c;for(c in d)if(U(d,c))b[c]=d[c]}function Qa(){if(!k.safe){k.rhino&&sa(D,Db);k.devel&&sa(D,Eb);k.browser&&sa(D,Fb);k.windows&&sa(D,Gb);k.widget&&sa(D,Hb)}}function Ra(b,d,c){throw{name:"JSLintError",line:d,character:c,message:b+" ("+Math.floor(d/ta.length*100)+"% scanned)."};}function f(b,d,c,g,i,j){var n;d=d||a;if(d.id==="(end)")d=h;n=d.line||0;d=d.from||0;c={id:"(error)",\nraw:b,evidence:ta[n-1]||"",line:n,character:d,a:c,b:g,c:i,d:j};c.reason=b.supplant(c);JSLINT.errors.push(c);k.passfail&&Ra("Stopping. ",n,d);Sa+=1;Sa>=k.maxerr&&Ra("Too many errors.",n,d);return c}function s(b,d,c,g,i,j,n){return f(b,{line:d,from:c},g,i,j,n)}function p(b,d,c,g,i,j){b=f(b,d,c,g,i,j);Ra("Stopping, unable to continue.",b.line,b.character)}function N(b,d,c,g,i,j,n){return p(b,{line:d,from:c},g,i,j,n)}function ga(b,d){if(k.safe&&o["(global)"]&&typeof D[b]!=="boolean")f("ADsafe global: "+\nb+".",h);else b==="hasOwnProperty"&&f("\'hasOwnProperty\' is a really bad name.");if(U(o,b)&&!o["(global)"])f(o[b]===true?"\'{a}\' was used before it was defined.":"\'{a}\' is already defined.",a,b);o[b]=d;if(o["(global)"]){qb[b]=o;if(U(ba,b)){f("\'{a}\' was used before it was defined.",a,b);delete ba[b]}}else E[b]=o}function O(b){b=b||0;for(var d=0,c;d<=b;){(c=Da[d])||(c=Da[d]=X.token());d+=1}return c}function e(b,d){switch(h.id){case "(number)":a.id==="."&&f("A dot following a number can be confused with a decimal point.",\nh);break;case "-":if(a.id==="-"||a.id==="--")f("Confusing minusses.");break;case "+":if(a.id==="+"||a.id==="++")f("Confusing plusses.");break}if(h.type==="(string)"||h.identifier)Ta=h.value;if(b&&a.id!==b)if(d)a.id==="(end)"?f("Unmatched \'{a}\'.",d,d.id):f("Expected \'{a}\' to match \'{b}\' from line {c} and instead saw \'{d}\'.",a,b,d.id,d.line,a.value);else if(a.type!=="(identifier)"||a.value!==b)f("Expected \'{a}\' and instead saw \'{b}\'.",a,b,a.value);I=h;for(h=a;;){a=Da.shift()||X.token();if(a.id==="(end)"||\na.id==="(error)")return;if(a.type==="special"){var c=void 0,g=void 0,i=void 0,j=a.value;c=void 0;var n=void 0;switch(j){case "*/":p("Unbegun comment.");break;case "/*members":case "/*member":j="/*members";ha||(ha={});g=ha;break;case "/*jslint":k.safe&&f("ADsafe restriction.");g=k;i=Ib;break;case "/*global":k.safe&&f("ADsafe restriction.");g=D;break;default:}c=X.token();a:for(;;){for(;;){if(c.type==="special"&&c.value==="*/")break a;if(c.id!=="(endline)"&&c.id!==",")break;c=X.token()}c.type!=="(string)"&&\nc.type!=="(identifier)"&&j!=="/*members"&&p("Bad option.",c);n=X.token();if(n.id===":"){n=X.token();g===ha&&p("Expected \'{a}\' and instead saw \'{b}\'.",c,"*/",":");if(c.value==="indent"&&j==="/*jslint"){c=+n.value;if(typeof c!=="number"||!isFinite(c)||c<=0||Math.floor(c)!==c)p("Expected a small integer and instead saw \'{a}\'.",n,n.value);g.white=true;g.indent=c}else if(c.value==="maxerr"&&j==="/*jslint"){c=+n.value;if(typeof c!=="number"||!isFinite(c)||c<=0||Math.floor(c)!==c)p("Expected a small integer and instead saw \'{a}\'.",\nn,n.value);g.maxerr=c}else if(c.value==="maxlen"&&j==="/*jslint"){c=+n.value;if(typeof c!=="number"||!isFinite(c)||c<=0||Math.floor(c)!==c)p("Expected a small integer and instead saw \'{a}\'.",n,n.value);g.maxlen=c}else if(n.value==="true")g[c.value]=true;else if(n.value==="false")g[c.value]=false;else p("Bad option value.",n);c=X.token()}else{j==="/*jslint"&&p("Missing option value.",c);g[c.value]=false;c=n}}i&&Qa()}else if(a.id!=="(endline)")break}}function u(b,d){var c;a.id==="(end)"&&p("Unexpected early end of program.",\nh);e();k.safe&&typeof D[h.value]==="boolean"&&a.id!=="("&&a.id!=="."&&f("ADsafe violation.",h);if(d){Ta="anonymous";o["(verb)"]=h.value}if(d===true&&h.fud)c=h.fud();else{if(h.nud)c=h.nud();else if(a.type==="(number)"&&h.id==="."){f("A leading decimal point can be confused with a dot: \'.{a}\'.",h,a.value);e();return h}else p("Expected an identifier and instead saw \'{a}\'.",h,h.id);for(;b<a.lbp;){e();if(h.led)c=h.led(c);else p("Expected an operator and instead saw \'{a}\'.",h,h.id)}}return c}function J(b,\nd){b=b||h;d=d||a;if(k.white||r==="styleproperty"||r==="style")b.character!==d.from&&b.line===d.line&&f("Unexpected space after \'{a}\'.",d,b.value)}function Ua(b,d){b=b||h;d=d||a;if(b.character!==d.from||b.line!==d.line)f("Unexpected space before \'{a}\'.",d,d.value)}function K(b,d){b=b||h;d=d||a;k.white&&!b.comment&&b.line===d.line&&J(b,d)}function B(b,d){if(k.white){b=b||h;d=d||a;b.line===d.line&&b.character===d.from&&f("Missing space after \'{a}\'.",a,b.value)}}function rb(b,d){b=b||h;d=d||a;if(!k.laxbreak&&\nb.line!==d.line)f("Bad line breaking before \'{a}\'.",d,d.id);else if(k.white){b=b||h;d=d||a;b.character===d.from&&f("Missing space after \'{a}\'.",a,b.value)}}function V(b){if(k.white&&a.id!=="(end)"){b=F+(b||0);a.from!==b&&f("Expected \'{a}\' to have an indentation at {b} instead at {c}.",a,a.value,b,a.from)}}function ca(b){b=b||h;b.line!==a.line&&f("Line breaking error \'{a}\'.",b,b.value)}function S(){if(h.line!==a.line)k.laxbreak||f("Bad line breaking before \'{a}\'.",h,a.id);else h.character!==a.from&&\nk.white&&f("Unexpected space after \'{a}\'.",a,h.value);e(",");B(h,a)}function da(b,d){var c=P[b];if(!c||typeof c!=="object")P[b]=c={id:b,lbp:d,value:b};return c}function G(b){return da(b,0)}function ea(b,d){var c=G(b);c.identifier=c.reserved=true;c.fud=d;return c}function ka(b,d){var c=ea(b,d);c.block=true;return c}function Va(b){var d=b.id.charAt(0);if(d>="a"&&d<="z"||d>="A"&&d<="Z")b.identifier=b.reserved=true;return b}function Q(b,d){var c=da(b,150);Va(c);c.nud=typeof d==="function"?d:function(){this.right=\nu(150);this.arity="unary";if(this.id==="++"||this.id==="--")if(k.plusplus)f("Unexpected use of \'{a}\'.",this,this.id);else if((!this.right.identifier||this.right.reserved)&&this.right.id!=="."&&this.right.id!=="[")f("Bad operand.",this);return this};return c}function Ea(b,d){var c=G(b);c.type=b;c.nud=d;return c}function C(b,d){var c=Ea(b,d);c.identifier=c.reserved=true;return c}function Y(b,d){return C(b,function(){typeof d==="function"&&d(this);return this})}function M(b,d,c,g){b=da(b,c);Va(b);b.led=\nfunction(i){if(!g){rb(I,h);B(h,a)}if(typeof d==="function")return d(i,this);else{this.left=i;this.right=u(c);return this}};return b}function fa(b,d){var c=da(b,100);c.led=function(g){rb(I,h);B(h,a);var i=u(100);if(g&&g.id==="NaN"||i&&i.id==="NaN")f("Use the isNaN function to compare with NaN.",this);else d&&d.apply(this,[g,i]);g.id==="!"&&f("Confusing use of \'{a}\'.",g,"!");i.id==="!"&&f("Confusing use of \'{a}\'.",g,"!");this.left=g;this.right=i;return this};return c}function Fa(b){return b&&(b.type===\n"(number)"&&+b.value===0||b.type==="(string)"&&b.value===""||b.type==="true"||b.type==="false"||b.type==="undefined"||b.type==="null")}function la(b){da(b,20).exps=true;return M(b,function(d,c){var g;c.left=d;if(D[d.value]===false&&E[d.value]["(global)"]===true)f("Read only.",d);else d["function"]&&f("\'{a}\' is a function.",d,d.value);if(k.safe){g=d;do{typeof D[g.value]==="boolean"&&f("ADsafe violation.",g);g=g.left}while(g)}if(d){if(d.id==="."||d.id==="["){if(!d.left||d.left.value==="arguments")f("Bad assignment.",\nc);c.right=u(19);return c}else if(d.identifier&&!d.reserved){o[d.value]==="exception"&&f("Do not assign to the exception parameter.",d);c.right=u(19);return c}d===P["function"]&&f("Expected an identifier in an assignment and instead saw a function invocation.",h)}p("Bad assignment.",c)},20)}function ma(b,d,c){b=da(b,c);Va(b);b.led=typeof d==="function"?d:function(g){k.bitwise&&f("Unexpected use of \'{a}\'.",this,this.id);this.left=g;this.right=u(c);return this};return b}function na(b){da(b,20).exps=\ntrue;return M(b,function(d,c){k.bitwise&&f("Unexpected use of \'{a}\'.",c,c.id);B(I,h);B(h,a);if(d){if(d.id==="."||d.id==="["||d.identifier&&!d.reserved){u(19);return c}d===P["function"]&&f("Expected an identifier in an assignment, and instead saw a function invocation.",h);return c}p("Bad assignment.",c)},20)}function sb(b){b=da(b,150);b.led=function(d){if(k.plusplus)f("Unexpected use of \'{a}\'.",this,this.id);else if((!d.identifier||d.reserved)&&d.id!=="."&&d.id!=="[")f("Bad operand.",this);this.left=\nd;return this};return b}function Wa(){if(a.identifier){e();if(k.safe&&Xa[h.value])f("ADsafe violation: \'{a}\'.",h,h.value);else h.reserved&&!k.es5&&f("Expected an identifier and instead saw \'{a}\' (a reserved word).",h,h.id);return h.value}}function ua(){var b=Wa();if(b)return b;h.id==="function"&&a.id==="("?f("Missing name in function statement."):p("Expected an identifier and instead saw \'{a}\'.",a,a.value)}function Ga(b){var d=0,c;if(!(a.id!==";"||Ya))for(;;){c=O(d);if(c.reach)return;if(c.id!=="(endline)"){if(c.id===\n"function"){f("Inner functions should be listed at the top of the outer function.",c);break}f("Unreachable \'{a}\' after \'{b}\'.",c,c.value,b);break}d+=1}}function Za(b){var d=F,c=E,g=a;if(g.id===";"){f("Unnecessary semicolon.",g);e(";")}else{if(g.identifier&&!g.reserved&&O().id===":"){e();e(":");E=Object.create(c);ga(g.value,"label");a.labelled||f("Label \'{a}\' on {b} statement.",a,g.value,a.value);$a.test(g.value+":")&&f("Label \'{a}\' looks like a javascript url.",g,g.value);a.label=g.value;g=a}b||V();\nb=u(0,true);if(!g.block){if(!b||!b.exps)f("Expected an assignment or function call and instead saw an expression.",h);else b.id==="("&&b.left.id==="new"&&f("Do not use \'new\' for side effects.");if(a.id!==";")s("Missing semicolon.",h.line,h.from+h.value.length);else{J(h,a);e(";");B(h,a)}}F=d;E=c;return b}}function tb(){if(a.value==="use strict"){e();e(";");Ha=true;k.newcap=true;return k.undef=true}else return false}function va(b){var d=[],c;b&&!tb()&&k.strict&&f(\'Missing "use strict" statement.\',a);\nif(k.adsafe)switch(b){case "script":if(!oa)if(a.value!=="ADSAFE"||O(0).id!=="."||O(1).value!=="id"&&O(1).value!=="go")p("ADsafe violation: Missing ADSAFE.id or ADSAFE.go.",a);if(a.value==="ADSAFE"&&O(0).id==="."&&O(1).value==="id"){oa&&p("ADsafe violation.",a);e("ADSAFE");e(".");e("id");e("(");a.value!==T&&p("ADsafe violation: id does not match.",a);e("(string)");e(")");e(";");oa=true}break;case "lib":if(a.value==="ADSAFE"){e("ADSAFE");e(".");e("lib");e("(");e("(string)");S();b=u(0);b.id!=="function"&&\np("The second argument to lib must be a function.",b);(c=(c=b.funct["(params)"])&&c.join(", "))&&c!=="lib"&&p("Expected \'{a}\' and instead saw \'{b}\'.",b,"(lib)","("+c+")");e(")");e(";");return d}else p("ADsafe lib violation.")}for(;!a.reach&&a.id!=="(end)";)if(a.id===";"){f("Unnecessary semicolon.");e(";")}else d.push(Za());return d}function W(b){var d,c=wa,g=F,i=E,j;wa=b;E=Object.create(E);B(h,a);j=a;if(a.id==="{"){e("{");if(a.id!=="}"||h.line!==a.line){for(F+=k.indent;!b&&a.from>F;)F+=k.indent;b||\ntb();d=va();F-=k.indent;V()}e("}",j);F=g}else{f("Expected \'{a}\' and instead saw \'{b}\'.",a,"{",a.value);Ya=true;d=[Za()];Ya=false}o["(verb)"]=null;E=i;wa=c;if(b&&(!d||d.length===0))f("Empty block.");return d}function Ia(b){ha&&typeof ha[b]!=="boolean"&&f("Unexpected /*member \'{a}\'.",h,b);if(typeof ia[b]==="number")ia[b]+=1;else ia[b]=1}function ab(b){var d=b.value;b=b.line;var c=ba[d];if(typeof c==="function")c=false;if(c)c[c.length-1]!==b&&c.push(b);else{c=[b];ba[d]=c}}function bb(){if(a.identifier){e();\nreturn true}}function Ja(){if(a.id==="-"){e("-");J();ca()}if(a.type==="(number)"){e("(number)");return true}}function cb(){if(a.type==="(string)"){e();return true}}function Z(){var b,d,c;if(a.identifier){c=a.value;if(c==="rgb"||c==="rgba"){e();e("(");for(b=0;b<3;b+=1){b&&e(",");d=a.value;if(a.type!=="(number)"||d<0){f("Expected a positive number and instead saw \'{a}\'",a,d);e()}else{e();if(a.id==="%"){e("%");d>100&&f("Expected a percentage and instead saw \'{a}\'",h,d)}else d>255&&f("Expected a small number and instead saw \'{a}\'",\nh,d)}}if(c==="rgba"){e(",");d=+a.value;if(a.type!=="(number)"||d<0||d>1)f("Expected a number between 0 and 1 and instead saw \'{a}\'",a,d);e();if(a.id==="%"){f("Unexpected \'%\'.");e("%")}}e(")");return true}else if(Jb[a.value]===true){e();return true}}else if(a.type==="(color)"){e();return true}return false}function y(){if(a.id==="-"){e("-");J();ca()}if(a.type==="(number)"){e();if(a.type!=="(string)"&&ub[a.value]===true){J();e()}else+h.value!==0&&f("Expected a linear unit and instead saw \'{a}\'.",a,a.value);\nreturn true}return false}function pa(){if(a.identifier)switch(a.value){case "thin":case "medium":case "thick":e();return true}else return y()}function xa(){if(a.identifier){if(a.value==="auto"){e();return true}}else return y()}function ja(){var b,d;if(a.identifier&&a.value==="url"){a=X.range("(",")");d=a.value;b=d.charAt(0);if(b===\'"\'||b==="\'")if(d.slice(-1)!==b)f("Bad url string.");else{d=d.slice(1,-1);d.indexOf(b)>=0&&f("Bad url string.")}d||f("Missing url.");e();k.safe&&vb.test(d)&&p("ADsafe URL violation.");\nya.push(d);return true}return false}function db(b){var d=0,c,g,i,j=0;switch(typeof b){case "function":return b();case "string":if(a.identifier&&a.value===b){e();return true}return false}for(;;){if(d>=b.length)return false;i=b[d];d+=1;if(i===true)break;else if(typeof i==="number"){c=i;i=b[d];d+=1}else c=1;for(g=false;c>0;)if(db(i)){g=true;c-=1}else break;if(g)return true}j=d;for(c=[];;){i=false;for(d=j;d<b.length;d+=1)if(!c[d])if(db(Ka[b[d]])){i=g=true;c[d]=true;break}if(!i)return g}}function wb(){for(var b;;){if(a.id===\n"}"||a.id==="(end)"||R&&a.id===R)return;for(;a.id===";";){f("Misplaced \';\'.");e(";")}for(b=void 0;a.id==="*"||a.id==="#"||a.value==="_";){k.css||f("Unexpected \'{a}\'.",a,a.value);e()}if(a.id==="-"){k.css||f("Unexpected \'{a}\'.",a,a.value);e("-");a.identifier||f("Expected a non-standard style attribute and instead saw \'{a}\'.",a,a.value);e();b=eb}else{if(a.identifier)if(U(Ka,a.value))b=Ka[a.value];else{b=eb;k.css||f("Unrecognized style attribute \'{a}\'.",a,a.value)}else f("Excepted a style attribute, and instead saw \'{a}\'.",\na,a.value);e();b=b}e(":");if(a.identifier&&a.value==="inherit")e();else if(!db(b)){f("Unexpected token \'{a}\'.",a,a.value);e()}if(a.id==="!"){e("!");J();a.identifier&&a.value==="important"?e():f("Expected \'{a}\' and instead saw \'{b}\'.",a,"important",a.value)}a.id==="}"||a.id===R?f("Missing \'{a}\'.",a,";"):e(";")}}function fb(){if(a.identifier){U(gb,k.cap?a.value.toLowerCase():a.value)||f("Expected a tagName, and instead saw {a}.",a,a.value);e()}else switch(a.id){case ">":case "+":e();fb();break;case ":":e(":");\nswitch(a.value){case "active":case "after":case "before":case "checked":case "disabled":case "empty":case "enabled":case "first-child":case "first-letter":case "first-line":case "first-of-type":case "focus":case "hover":case "last-child":case "last-of-type":case "link":case "only-of-type":case "root":case "target":case "visited":e();break;case "lang":e();e("(");a.identifier||f("Expected a lang code, and instead saw :{a}.",a,a.value);e(")");break;case "nth-child":case "nth-last-child":case "nth-last-of-type":case "nth-of-type":e();\ne("(");a:if(a.id==="(number)"){e();if(a.value==="n"&&a.identifier){J();e();if(a.id==="+"){J();e("+");J();e("(number)")}}}else{switch(a.value){case "odd":case "even":if(a.identifier){e();break a}}f("Unexpected token \'{a}\'.",a,a.value)}e(")");break;case "not":e();e("(");a.id===":"&&O(0).value==="not"&&f("Nested not.");fb();e(")");break;default:f("Expected a pseudo, and instead saw :{a}.",a,a.value)}break;case "#":e("#");a.identifier||f("Expected an id, and instead saw #{a}.",a,a.value);e();break;case "*":e("*");\nbreak;case ".":e(".");a.identifier||f("Expected a class, and instead saw #.{a}.",a,a.value);e();break;case "[":e("[");a.identifier||f("Expected an attribute, and instead saw [{a}].",a,a.value);e();if(a.id==="="||a.value==="~="||a.value==="$="||a.value==="|="||a.id==="*="||a.id==="^="){e();a.type!=="(string)"&&f("Expected a string, and instead saw {a}.",a,a.value);e()}e("]");break;default:p("Expected a CSS selector, and instead saw {a}.",a,a.value)}}function xb(){for(;a.id!=="</"&&a.id!=="(end)";){a:for(a.id===\n"{"&&f("Expected a style pattern, and instead saw \'{a}\'.",a,a.id);;){fb();if(a.id==="</"||a.id==="{"||a.id==="(end)")break a;a.id===","&&S()}r="styleproperty";if(a.id===";")e(";");else{e("{");wb();r="style";e("}")}}}function yb(){for(;a.id==="@";){O();e("@");if(a.identifier)switch(a.value){case "import":e();if(!ja()){f("Expected \'{a}\' and instead saw \'{b}\'.",a,"url",a.value);e()}e(";");break;case "media":for(e();;){if(!a.identifier||zb[a.value]===true)p("Expected a CSS media type, and instead saw \'{a}\'.",\na,a.id);e();if(a.id!==",")break;e(",")}e("{");xb();e("}");break;default:f("Expected an at-rule, and instead saw @{a}.",a,a.value)}else f("Expected an at-rule, and instead saw \'{a}\'.",a,a.value)}xb()}function hb(){var b=Wa(true);if(!b)if(a.id==="(string)"){b=a.value;if(k.adsafe&&(b.charAt(0)==="_"||b.charAt(b.length-1)==="_"))f("Unexpected {a} in \'{b}\'.",h,"dangling \'_\'",b);e()}else if(a.id==="(number)"){b=a.value.toString();e()}return b}function La(b,d){var c,g=E;E=Object.create(g);c=o={"(name)":b||\n\'"\'+Ta+\'"\',"(line)":a.line,"(context)":o,"(breakage)":0,"(loopage)":0,"(scope)":E,"(statement)":d};h.funct=o;za.push(o);b&&ga(b,"function");var i=o,j;a:{var n,v=a,q=[];e("(");K();if(a.id===")"){e(")");K(I,h);j=void 0}else for(;;){n=ua();q.push(n);ga(n,"parameter");if(a.id===",")S();else{e(")",v);K(I,h);j=q;break a}}}i["(params)"]=j;W(false);E=g;o["(last)"]=h.line;o=o["(context)"];return c}function ib(){function b(){var c={},g=a;e("{");if(a.id!=="}")for(;;){if(a.id==="(end)")p("Missing \'}\' to match \'{\' from line {a}.",\na,g.line);else if(a.id==="}"){f("Unexpected comma.",h);break}else if(a.id===",")p("Unexpected comma.",a);else a.id!=="(string)"&&f("Expected a string and instead saw {a}.",a,a.value);if(c[a.value]===true)f("Duplicate key \'{a}\'.",a,a.value);else if(a.value==="__proto__")f("Stupid key \'{a}\'.",a,a.value);else c[a.value]=true;e();e(":");ib();if(a.id!==",")break;e(",")}e("}")}function d(){var c=a;e("[");if(a.id!=="]")for(;;){if(a.id==="(end)")p("Missing \']\' to match \'[\' from line {a}.",a,c.line);else if(a.id===\n"]"){f("Unexpected comma.",h);break}else a.id===","&&p("Unexpected comma.",a);ib();if(a.id!==",")break;e(",")}e("]")}switch(a.id){case "{":b();break;case "[":d();break;case "true":case "false":case "null":case "(number)":case "(string)":e();break;case "-":e("-");h.character!==a.from&&f("Unexpected space after \'-\'.",h);J(h,a);e("(number)");break;default:p("Expected a JSON value.",a)}}function Ab(b){var d=[],c;for(c in b)U(b,c)&&d.push(c);return d}var T,oa,Aa,Ta,Ma,Kb={"<":true,"<=":true,"==":true,\n"===":true,"!==":true,"!=":true,">":true,">=":true,"+":true,"-":true,"*":true,"/":true,"%":true},Xa={arguments:true,callee:true,caller:true,constructor:true,eval:true,prototype:true,stack:true,unwatch:true,valueOf:true,watch:true},Ib={adsafe:true,bitwise:true,browser:true,cap:true,css:true,debug:true,devel:true,eqeqeq:true,es5:true,evil:true,forin:true,fragment:true,immed:true,laxbreak:true,newcap:true,nomen:true,on:true,onevar:true,passfail:true,plusplus:true,regexp:true,rhino:true,undef:true,safe:true,\nwindows:true,strict:true,sub:true,white:true,widget:true},Fb={addEventListener:false,blur:false,clearInterval:false,clearTimeout:false,close:false,closed:false,defaultStatus:false,document:false,event:false,focus:false,frames:false,getComputedStyle:false,history:false,Image:false,length:false,location:false,moveBy:false,moveTo:false,name:false,navigator:false,onbeforeunload:true,onblur:true,onerror:true,onfocus:true,onload:true,onresize:true,onunload:true,open:false,opener:false,Option:false,parent:false,\nprint:false,removeEventListener:false,resizeBy:false,resizeTo:false,screen:false,scroll:false,scrollBy:false,scrollTo:false,setInterval:false,setTimeout:false,status:false,top:false,XMLHttpRequest:false},Ka,eb,Jb={aliceblue:true,antiquewhite:true,aqua:true,aquamarine:true,azure:true,beige:true,bisque:true,black:true,blanchedalmond:true,blue:true,blueviolet:true,brown:true,burlywood:true,cadetblue:true,chartreuse:true,chocolate:true,coral:true,cornflowerblue:true,cornsilk:true,crimson:true,cyan:true,\ndarkblue:true,darkcyan:true,darkgoldenrod:true,darkgray:true,darkgreen:true,darkkhaki:true,darkmagenta:true,darkolivegreen:true,darkorange:true,darkorchid:true,darkred:true,darksalmon:true,darkseagreen:true,darkslateblue:true,darkslategray:true,darkturquoise:true,darkviolet:true,deeppink:true,deepskyblue:true,dimgray:true,dodgerblue:true,firebrick:true,floralwhite:true,forestgreen:true,fuchsia:true,gainsboro:true,ghostwhite:true,gold:true,goldenrod:true,gray:true,green:true,greenyellow:true,honeydew:true,\nhotpink:true,indianred:true,indigo:true,ivory:true,khaki:true,lavender:true,lavenderblush:true,lawngreen:true,lemonchiffon:true,lightblue:true,lightcoral:true,lightcyan:true,lightgoldenrodyellow:true,lightgreen:true,lightpink:true,lightsalmon:true,lightseagreen:true,lightskyblue:true,lightslategray:true,lightsteelblue:true,lightyellow:true,lime:true,limegreen:true,linen:true,magenta:true,maroon:true,mediumaquamarine:true,mediumblue:true,mediumorchid:true,mediumpurple:true,mediumseagreen:true,mediumslateblue:true,\nmediumspringgreen:true,mediumturquoise:true,mediumvioletred:true,midnightblue:true,mintcream:true,mistyrose:true,moccasin:true,navajowhite:true,navy:true,oldlace:true,olive:true,olivedrab:true,orange:true,orangered:true,orchid:true,palegoldenrod:true,palegreen:true,paleturquoise:true,palevioletred:true,papayawhip:true,peachpuff:true,peru:true,pink:true,plum:true,powderblue:true,purple:true,red:true,rosybrown:true,royalblue:true,saddlebrown:true,salmon:true,sandybrown:true,seagreen:true,seashell:true,\nsienna:true,silver:true,skyblue:true,slateblue:true,slategray:true,snow:true,springgreen:true,steelblue:true,tan:true,teal:true,thistle:true,tomato:true,turquoise:true,violet:true,wheat:true,white:true,whitesmoke:true,yellow:true,yellowgreen:true,activeborder:true,activecaption:true,appworkspace:true,background:true,buttonface:true,buttonhighlight:true,buttonshadow:true,buttontext:true,captiontext:true,graytext:true,highlight:true,highlighttext:true,inactiveborder:true,inactivecaption:true,inactivecaptiontext:true,\ninfobackground:true,infotext:true,menu:true,menutext:true,scrollbar:true,threeddarkshadow:true,threedface:true,threedhighlight:true,threedlightshadow:true,threedshadow:true,window:true,windowframe:true,windowtext:true},$,jb,ub={"%":true,cm:true,em:true,ex:true,"in":true,mm:true,pc:true,pt:true,px:true},zb,Na,Eb={alert:false,confirm:false,console:false,Debug:false,opera:false,prompt:false},Lb={"\\u0008":"\\\\b","\\t":"\\\\t","\\n":"\\\\n","\\u000c":"\\\\f","\\r":"\\\\r",\'"\':\'\\\\"\',"/":"\\\\/","\\\\":"\\\\\\\\"},o,Ba=["closure",\n"exception","global","label","outer","unused","var"],za,qb,gb={a:{},abbr:{},acronym:{},address:{},applet:{},area:{empty:true,parent:" map "},article:{},aside:{},audio:{},b:{},base:{empty:true,parent:" head "},bdo:{},big:{},blockquote:{},body:{parent:" html noframes "},br:{empty:true},button:{},canvas:{parent:" body p div th td "},caption:{parent:" table "},center:{},cite:{},code:{},col:{empty:true,parent:" table colgroup "},colgroup:{parent:" table "},command:{parent:" menu "},datalist:{},dd:{parent:" dl "},\ndel:{},details:{},dialog:{},dfn:{},dir:{},div:{},dl:{},dt:{parent:" dl "},em:{},embed:{},fieldset:{},figure:{},font:{},footer:{},form:{},frame:{empty:true,parent:" frameset "},frameset:{parent:" html frameset "},h1:{},h2:{},h3:{},h4:{},h5:{},h6:{},head:{parent:" html "},header:{},hgroup:{},hr:{empty:true},"hta:application":{empty:true,parent:" head "},html:{parent:"*"},i:{},iframe:{},img:{empty:true},input:{empty:true},ins:{},kbd:{},keygen:{},label:{},legend:{parent:" details fieldset figure "},li:{parent:" dir menu ol ul "},\nlink:{empty:true,parent:" head "},map:{},mark:{},menu:{},meta:{empty:true,parent:" head noframes noscript "},meter:{},nav:{},noframes:{parent:" html body "},noscript:{parent:" body head noframes "},object:{},ol:{},optgroup:{parent:" select "},option:{parent:" optgroup select "},output:{},p:{},param:{empty:true,parent:" applet object "},pre:{},progress:{},q:{},rp:{},rt:{},ruby:{},samp:{},script:{empty:true,parent:" body div frame head iframe p pre span "},section:{},select:{},small:{},span:{},source:{},\nstrong:{},style:{parent:" head ",empty:true},sub:{},sup:{},table:{},tbody:{parent:" table "},td:{parent:" tr "},textarea:{},tfoot:{parent:" table "},th:{parent:" tr "},thead:{parent:" table "},time:{},title:{parent:" head "},tr:{parent:" table tbody thead tfoot "},tt:{},u:{},ul:{},"var":{},video:{}},Oa,ba,wa,F,qa,ta,Da,ia,ha,a,Ya,k,D,kb,I,Db={defineClass:false,deserialize:false,gc:false,help:false,load:false,loadClass:false,print:false,quit:false,readFile:false,readUrl:false,runCommand:false,seal:false,\nserialize:false,spawn:false,sync:false,toint32:false,version:false},E,Pa,L,Mb={Array:false,Boolean:false,Date:false,decodeURI:false,decodeURIComponent:false,encodeURI:false,encodeURIComponent:false,Error:false,eval:false,EvalError:false,Function:false,hasOwnProperty:false,isFinite:false,isNaN:false,JSON:false,Math:false,Number:false,Object:false,parseInt:false,parseFloat:false,RangeError:false,ReferenceError:false,RegExp:false,String:false,SyntaxError:false,TypeError:false,URIError:false},Nb={E:true,\nLN2:true,LN10:true,LOG2E:true,LOG10E:true,MAX_VALUE:true,MIN_VALUE:true,NEGATIVE_INFINITY:true,PI:true,POSITIVE_INFINITY:true,SQRT1_2:true,SQRT2:true},Ha,P={},lb,h,ya,Sa,Hb={alert:true,animator:true,appleScript:true,beep:true,bytesToUIString:true,Canvas:true,chooseColor:true,chooseFile:true,chooseFolder:true,closeWidget:true,COM:true,convertPathToHFS:true,convertPathToPlatform:true,CustomAnimation:true,escape:true,FadeAnimation:true,filesystem:true,Flash:true,focusWidget:true,form:true,FormField:true,\nFrame:true,HotKey:true,Image:true,include:true,isApplicationRunning:true,iTunes:true,konfabulatorVersion:true,log:true,md5:true,MenuItem:true,MoveAnimation:true,openURL:true,play:true,Point:true,popupMenu:true,preferenceGroups:true,preferences:true,print:true,prompt:true,random:true,Rectangle:true,reloadWidget:true,ResizeAnimation:true,resolvePath:true,resumeUpdates:true,RotateAnimation:true,runCommand:true,runCommandInBg:true,saveAs:true,savePreferences:true,screen:true,ScrollBar:true,showWidgetPreferences:true,\nsleep:true,speak:true,Style:true,suppressUpdates:true,system:true,tellWidget:true,Text:true,TextArea:true,Timer:true,unescape:true,updateNow:true,URL:true,Web:true,widget:true,Window:true,XMLDOM:true,XMLHttpRequest:true,yahooCheckLogin:true,yahooLogin:true,yahooLogout:true},Gb={ActiveXObject:false,CScript:false,Debug:false,Enumerator:false,System:false,VBArray:false,WScript:false},r,R,mb=/@cc|<\\/?|script|\\]\\s*\\]|<\\s*!|&lt/i,Ob=/[\\u0000-\\u001f\\u007f-\\u009f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/,\nPb=/^\\s*([(){}\\[.,:;\'"~\\?\\]#@]|==?=?|\\/(\\*(jslint|members?|global)?|=|\\/)?|\\*[\\/=]?|\\+(?:=|\\++)?|-(?:=|-+)?|%=?|&[&=]?|\\|[|=]?|>>?>?=?|<([\\/=!]|\\!(\\[|--)?|<=?)?|\\^=?|\\!=?=?|[a-zA-Z_$][a-zA-Z0-9_$]*|[0-9]+([xX][0-9a-fA-F]+|\\.[0-9]*)?([eE][+\\-]?[0-9]+)?)/;$=/^\\s*([\'"=>\\/&#]|<(?:\\/|\\!(?:--)?)?|[a-zA-Z][a-zA-Z0-9_\\-:]*|[0-9]+|--)/;var Qb=/[\\u0000-\\u001f&<"\\/\\\\\\u007f-\\u009f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/,Rb=/[\\u0000-\\u001f&<"\\/\\\\\\u007f-\\u009f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g,\nSb=/[>&]|<[\\/!]?|--/,Tb=/\\*\\/|\\/\\*/,Bb=/^([a-zA-Z_$][a-zA-Z0-9_$]*)$/,$a=/^(?:javascript|jscript|ecmascript|vbscript|mocha|livescript)\\s*:/i,vb=/&|\\+|\\u00AD|\\.\\.|\\/\\*|%[^;]|base64|url|expression|data|mailto/i,Ub=/[^a-zA-Z0-9+\\-_\\/ ]/,Vb=/[\\[\\]\\/\\\\"\'*<>.&:(){}+=#]/,Wb={outer:$,html:$,style:/^\\s*([{:#%.=,>+\\[\\]@()"\';]|\\*=?|\\$=|\\|=|\\^=|~=|[a-zA-Z_][a-zA-Z0-9_\\-]*|[0-9]+|<\\/|\\/\\*)/,styleproperty:/^\\s*([@#!"\'};:\\-%.=,+\\[\\]()*_]|[a-zA-Z][a-zA-Z0-9._\\-]*|\\/\\*?|\\d+(?:\\.\\d+)?|<\\/)/};if(typeof Object.create!==\n"function")Object.create=function(b){pb.prototype=b;return new pb};String.prototype.entityify=function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};String.prototype.isAlpha=function(){return this>="a"&&this<="z\\uffff"||this>="A"&&this<="Z\\uffff"};String.prototype.isDigit=function(){return this>="0"&&this<="9"};String.prototype.supplant=function(b){return this.replace(/\\{([^{}]*)\\}/g,function(d,c){var g=b[c];return typeof g==="string"||typeof g==="number"?g:d})};String.prototype.name=\nfunction(){if(Bb.test(this))return this;if(Qb.test(this))return\'"\'+this.replace(Rb,function(b){var d=Lb[b];if(d)return d;return"\\\\u"+("0000"+b.charCodeAt().toString(16)).slice(-4)})+\'"\';return\'"\'+this+\'"\'};var X=function(){function b(){var n;if(i>=ta.length)return false;c=1;j=ta[i];i+=1;n=j.search(/ \\t/);n>=0&&s("Mixed spaces and tabs.",i,n+1);j=j.replace(/\\t/g,lb);n=j.search(Ob);n>=0&&s("Unsafe character.",i,n);k.maxlen&&k.maxlen<j.length&&s("Line too long.",i,j.length);return true}function d(n,\nv){var q,l;l=n==="(color)"||n==="(range)"?{type:n}:n==="(punctuator)"||n==="(identifier)"&&U(P,v)?P[v]||P["(error)"]:P[n];l=Object.create(l);if(n==="(string)"||n==="(range)")$a.test(v)&&s("Script URL.",i,g);if(n==="(identifier)"){l.identifier=true;if(v==="__iterator__"||v==="__proto__")N("Reserved name \'{a}\'.",i,g,v);else if(k.nomen&&(v.charAt(0)==="_"||v.charAt(v.length-1)==="_"))s("Unexpected {a} in \'{b}\'.",i,g,"dangling \'_\'",v)}l.value=v;l.line=i;l.character=c;l.from=g;q=l.id;if(q!=="(endline)")kb=\nq&&("(,=:[!&|?{};".indexOf(q.charAt(q.length-1))>=0||q==="return");return l}var c,g,i,j;return{init:function(n){ta=typeof n==="string"?n.replace(/\\r\\n/g,"\\n").replace(/\\r/g,"\\n").split("\\n"):n;i=0;b();g=1},range:function(n,v){var q,l="";g=c;for(j.charAt(0)!==n&&N("Expected \'{a}\' and instead saw \'{b}\'.",i,c,n,j.charAt(0));;){j=j.slice(1);c+=1;q=j.charAt(0);switch(q){case "":N("Missing \'{a}\'.",i,c,q);break;case v:j=j.slice(1);c+=1;return d("(range)",l);case R:case "\\\\":s("Unexpected \'{a}\'.",i,c,q)}l+=\nq}},token:function(){function n(z){if(z=z.exec(j)){m=z[0].length;z=z[1];l=z.charAt(0);j=j.substr(m);g=c+m-z.length;c+=m;return z}}function v(z){function Ca(nb){var ra=parseInt(j.substr(H+1,nb),16);H+=nb;ra>=32&&ra<=126&&ra!==34&&ra!==92&&ra!==39&&s("Unnecessary escapement.",i,c);c+=nb;A=String.fromCharCode(ra)}var A,H,Cb="";qa&&z!==\'"\'&&s("Strings must use doublequote.",i,c);if(R===z||r==="scriptstring"&&!R)return d("(punctuator)",z);for(H=0;;){for(;H>=j.length;){H=0;if(r!=="html"||!b())N("Unclosed string.",\ni,g)}A=j.charAt(H);if(A===z){c+=1;j=j.substr(H+1);return d("(string)",Cb,z)}if(A<" "){if(A==="\\n"||A==="\\r")break;s("Control character in string: {a}.",i,c+H,j.slice(0,H))}else if(A===R)s("Bad HTML string",i,c+H);else if(A==="<")if(k.safe&&r==="html")s("ADsafe string violation.",i,c+H);else if(j.charAt(H+1)==="/"&&(r||k.safe))s("Expected \'<\\\\/\' and instead saw \'</\'.",i,c);else{if(j.charAt(H+1)==="!"&&(r||k.safe))s("Unexpected \'<!\' in a string.",i,c)}else if(A==="\\\\")if(r==="html")k.safe&&s("ADsafe string violation.",\ni,c+H);else if(r==="styleproperty"){H+=1;c+=1;A=j.charAt(H);A!==z&&s("Escapement in style string.",i,c+H)}else{H+=1;c+=1;A=j.charAt(H);switch(A){case R:s("Bad HTML string",i,c+H);break;case "\\\\":case "\'":case \'"\':case "/":break;case "b":A="\\u0008";break;case "f":A="\\u000c";break;case "n":A="\\n";break;case "r":A="\\r";break;case "t":A="\\t";break;case "u":Ca(4);break;case "v":A="\\u000b";break;case "x":qa&&s("Avoid \\\\x-.",i,c);Ca(2);break;default:s("Bad escapement.",i,c)}}Cb+=A;c+=1;H+=1}}for(var q,l,\nt,x,m,w;;){if(!j)return d(b()?"(endline)":"(end)","");for(;r==="outer";){x=j.search(Sb);if(x===0)break;else if(x>0){c+=1;j=j.slice(x);break}else if(!b())return d("(end)","")}if(t=n(Wb[r]||Pb)){if(l.isAlpha()||l==="_"||l==="$")return d("(identifier)",t);if(l.isDigit()){r!=="style"&&!isFinite(Number(t))&&s("Bad number \'{a}\'.",i,c,t);r!=="style"&&r!=="styleproperty"&&j.substr(0,1).isAlpha()&&s("Missing space after \'{a}\'.",i,c,t);if(l==="0"){x=t.substr(1,1);if(x.isDigit())h.id!=="."&&r!=="styleproperty"&&\ns("Don\'t use extra leading zeros \'{a}\'.",i,c,t);else if(qa&&(x==="x"||x==="X"))s("Avoid 0x-. \'{a}\'.",i,c,t)}t.substr(t.length-1)==="."&&s("A trailing decimal point can be confused with a dot \'{a}\'.",i,c,t);return d("(number)",t)}switch(t){case \'"\':case "\'":return v(t);case "//":if(Pa||r&&r!=="script")s("Unexpected comment.",i,c);else if(r==="script"&&/<\\s*\\//i.test(j))s("Unexpected </ in comment.",i,c);else if((k.safe||r==="script")&&mb.test(j))s("Dangerous comment.",i,c);j="";h.comment=true;break;\ncase "/*":if(Pa||r&&r!=="script"&&r!=="style"&&r!=="styleproperty")s("Unexpected comment.",i,c);for(k.safe&&mb.test(j)&&s("ADsafe comment violation.",i,c);;){x=j.search(Tb);if(x>=0)break;if(b())k.safe&&mb.test(j)&&s("ADsafe comment violation.",i,c);else N("Unclosed comment.",i,c)}c+=x+2;j.substr(x,1)==="/"&&N("Nested comment.",i,c);j=j.substr(x+2);h.comment=true;break;case "/*members":case "/*member":case "/*jslint":case "/*global":case "*/":return{value:t,type:"special",line:i,character:c,from:g};\ncase "":break;case "/":h.id==="/="&&N("A regular expression literal can be confused with \'/=\'.",i,g);if(kb){for(m=t=x=0;;){q=true;l=j.charAt(m);m+=1;switch(l){case "":N("Unclosed regular expression.",i,g);return;case "/":x>0&&s("Unescaped \'{a}\'.",i,g+m,"/");l=j.substr(0,m-1);for(w={g:true,i:true,m:true};w[j.charAt(m)]===true;){w[j.charAt(m)]=false;m+=1}c+=m;j=j.substr(m);w=j.charAt(0);if(w==="/"||w==="*")N("Confusing regular expression.",i,g);return d("(regexp)",l);case "\\\\":l=j.charAt(m);if(l<" ")s("Unexpected control character in regular expression.",\ni,g+m);else l==="<"&&s("Unexpected escaped character \'{a}\' in regular expression.",i,g+m,l);m+=1;break;case "(":x+=1;q=false;if(j.charAt(m)==="?"){m+=1;switch(j.charAt(m)){case ":":case "=":case "!":m+=1;break;default:s("Expected \'{a}\' and instead saw \'{b}\'.",i,g+m,":",j.charAt(m))}}else t+=1;break;case "|":q=false;break;case ")":if(x===0)s("Unescaped \'{a}\'.",i,g+m,")");else x-=1;break;case " ":for(w=1;j.charAt(m)===" ";){m+=1;w+=1}w>1&&s("Spaces are hard to count. Use {{a}}.",i,g+m,w);break;case "[":l=\nj.charAt(m);if(l==="^"){m+=1;if(k.regexp)s("Insecure \'{a}\'.",i,g+m,l);else j.charAt(m)==="]"&&N("Unescaped \'{a}\'.",i,g+m,"^")}w=false;if(l==="]"){s("Empty class.",i,g+m-1);w=true}a:do{l=j.charAt(m);m+=1;switch(l){case "[":case "^":s("Unescaped \'{a}\'.",i,g+m,l);w=true;break;case "-":if(w)w=false;else{s("Unescaped \'{a}\'.",i,g+m,"-");w=true}break;case "]":w||s("Unescaped \'{a}\'.",i,g+m-1,"-");break a;case "\\\\":l=j.charAt(m);if(l<" ")s("Unexpected control character in regular expression.",i,g+m);else l===\n"<"&&s("Unexpected escaped character \'{a}\' in regular expression.",i,g+m,l);m+=1;w=true;break;case "/":s("Unescaped \'{a}\'.",i,g+m-1,"/");w=true;break;case "<":if(r==="script"){l=j.charAt(m);if(l==="!"||l==="/")s("HTML confusion in regular expression \'<{a}\'.",i,g+m,l)}w=true;break;default:w=true}}while(l);break;case ".":k.regexp&&s("Insecure \'{a}\'.",i,g+m,l);break;case "]":case "?":case "{":case "}":case "+":case "*":s("Unescaped \'{a}\'.",i,g+m,l);break;case "<":if(r==="script"){l=j.charAt(m);if(l===\n"!"||l==="/")s("HTML confusion in regular expression \'<{a}\'.",i,g+m,l)}}if(q)switch(j.charAt(m)){case "?":case "+":case "*":m+=1;if(j.charAt(m)==="?")m+=1;break;case "{":m+=1;l=j.charAt(m);if(l<"0"||l>"9")s("Expected a number and instead saw \'{a}\'.",i,g+m,l);m+=1;for(w=+l;;){l=j.charAt(m);if(l<"0"||l>"9")break;m+=1;w=+l+w*10}q=w;if(l===","){m+=1;q=Infinity;l=j.charAt(m);if(l>="0"&&l<="9"){m+=1;for(q=+l;;){l=j.charAt(m);if(l<"0"||l>"9")break;m+=1;q=+l+q*10}}}if(j.charAt(m)!=="}")s("Expected \'{a}\' and instead saw \'{b}\'.",\ni,g+m,"}",l);else m+=1;if(j.charAt(m)==="?")m+=1;w>q&&s("\'{a}\' should not be greater than \'{b}\'.",i,g+m,w,q)}}l=j.substr(0,m-1);c+=m;j=j.substr(m);return d("(regexp)",l)}return d("(punctuator)",t);case "<!--":m=i;for(l=c;;){x=j.indexOf("--");if(x>=0)break;x=j.indexOf("<!");x>=0&&N("Nested HTML comment.",i,c+x);b()||N("Unclosed HTML comment.",m,l)}m=j.indexOf("<!");m>=0&&m<x&&N("Nested HTML comment.",i,c+m);c+=x;j.charAt(x+2)!==">"&&N("Expected --\\>.",i,c);c+=3;j=j.slice(x+3);break;case "#":if(r===\n"html"||r==="styleproperty"){for(;;){l=j.charAt(0);if((l<"0"||l>"9")&&(l<"a"||l>"f")&&(l<"A"||l>"F"))break;c+=1;j=j.substr(1);t+=l}t.length!==4&&t.length!==7&&s("Bad hex color \'{a}\'.",i,g+m,t);return d("(color)",t)}return d("(punctuator)",t);default:if(r==="outer"&&l==="&"){c+=1;for(j=j.substr(1);;){l=j.charAt(0);c+=1;j=j.substr(1);if(l===";")break;l>="0"&&l<="9"||l>="a"&&l<="z"||l==="#"||N("Bad entity",i,g+m,c)}break}return d("(punctuator)",t)}}else{for(l=t="";j&&j<"!";)j=j.substr(1);if(j)if(r===\n"html")return d("(error)",j.charAt(0));else N("Unexpected \'{a}\'.",i,c,j.substr(0,1))}}}}}();eb=[ja,function(){for(;;)if(a.identifier)switch(a.value.toLowerCase()){case "url":ja();break;case "expression":f("Unexpected expression \'{a}\'.",a,a.value);e();break;default:e()}else{if(a.id===";"||a.id==="!"||a.id==="(end)"||a.id==="}")return true;e()}}];$=["none","dashed","dotted","double","groove","hidden","inset","outset","ridge","solid"];jb=["auto","always","avoid","left","right"];zb={all:true,braille:true,\nembossed:true,handheld:true,print:true,projection:true,screen:true,speech:true,tty:true,tv:true};Na=["auto","hidden","scroll","visible"];Ka={background:[true,"background-attachment","background-color","background-image","background-position","background-repeat"],"background-attachment":["scroll","fixed"],"background-color":["transparent",Z],"background-image":["none",ja],"background-position":[2,[y,"top","bottom","left","right","center"]],"background-repeat":["repeat","repeat-x","repeat-y","no-repeat"],\nborder:[true,"border-color","border-style","border-width"],"border-bottom":[true,"border-bottom-color","border-bottom-style","border-bottom-width"],"border-bottom-color":Z,"border-bottom-style":$,"border-bottom-width":pa,"border-collapse":["collapse","separate"],"border-color":["transparent",4,Z],"border-left":[true,"border-left-color","border-left-style","border-left-width"],"border-left-color":Z,"border-left-style":$,"border-left-width":pa,"border-right":[true,"border-right-color","border-right-style",\n"border-right-width"],"border-right-color":Z,"border-right-style":$,"border-right-width":pa,"border-spacing":[2,y],"border-style":[4,$],"border-top":[true,"border-top-color","border-top-style","border-top-width"],"border-top-color":Z,"border-top-style":$,"border-top-width":pa,"border-width":[4,pa],bottom:[y,"auto"],"caption-side":["bottom","left","right","top"],clear:["both","left","none","right"],clip:[function(){var b;if(a.identifier&&a.value==="rect"){e();e("(");for(b=0;b<4;b+=1)if(!y()){f("Expected a number and instead saw \'{a}\'.",\na,a.value);break}e(")");return true}return false},"auto"],color:Z,content:["open-quote","close-quote","no-open-quote","no-close-quote",cb,ja,function(){if(a.identifier&&a.value==="counter"){e();e("(");e();if(a.id===","){S();a.type!=="(string)"&&f("Expected a string and instead saw \'{a}\'.",a,a.value);e()}e(")");return true}if(a.identifier&&a.value==="counters"){e();e("(");a.identifier||f("Expected a name and instead saw \'{a}\'.",a,a.value);e();if(a.id===","){S();a.type!=="(string)"&&f("Expected a string and instead saw \'{a}\'.",\na,a.value);e()}if(a.id===","){S();a.type!=="(string)"&&f("Expected a string and instead saw \'{a}\'.",a,a.value);e()}e(")");return true}return false},function(){if(a.identifier&&a.value==="attr"){e();e("(");a.identifier||f("Expected a name and instead saw \'{a}\'.",a,a.value);e();e(")");return true}return false}],"counter-increment":[bb,"none"],"counter-reset":[bb,"none"],cursor:[ja,"auto","crosshair","default","e-resize","help","move","n-resize","ne-resize","nw-resize","pointer","s-resize","se-resize",\n"sw-resize","w-resize","text","wait"],direction:["ltr","rtl"],display:["block","compact","inline","inline-block","inline-table","list-item","marker","none","run-in","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group"],"empty-cells":["show","hide"],"float":["left","none","right"],font:["caption","icon","menu","message-box","small-caption","status-bar",true,"font-size","font-style","font-weight","font-family"],\n"font-family":function(){for(;a.id!==";";){!bb()&&!cb()&&f("Expected a name and instead saw \'{a}\'.",a,a.value);if(a.id!==",")return true;S()}},"font-size":["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller",y],"font-size-adjust":["none",Ja],"font-stretch":["normal","wider","narrower","ultra-condensed","extra-condensed","condensed","semi-condensed","semi-expanded","expanded","extra-expanded"],"font-style":["normal","italic","oblique"],"font-variant":["normal","small-caps"],\n"font-weight":["normal","bold","bolder","lighter",Ja],height:[y,"auto"],left:[y,"auto"],"letter-spacing":["normal",y],"line-height":["normal",function(){if(a.id==="-"){e("-");J()}if(a.type==="(number)"){e();if(a.type!=="(string)"&&ub[a.value]===true){J();e()}return true}return false}],"list-style":[true,"list-style-image","list-style-position","list-style-type"],"list-style-image":["none",ja],"list-style-position":["inside","outside"],"list-style-type":["circle","disc","square","decimal","decimal-leading-zero",\n"lower-roman","upper-roman","lower-greek","lower-alpha","lower-latin","upper-alpha","upper-latin","hebrew","katakana","hiragana-iroha","katakana-oroha","none"],margin:[4,xa],"margin-bottom":xa,"margin-left":xa,"margin-right":xa,"margin-top":xa,"marker-offset":[y,"auto"],"max-height":[y,"none"],"max-width":[y,"none"],"min-height":y,"min-width":y,opacity:Ja,outline:[true,"outline-color","outline-style","outline-width"],"outline-color":["invert",Z],"outline-style":["dashed","dotted","double","groove",\n"inset","none","outset","ridge","solid"],"outline-width":pa,overflow:Na,"overflow-x":Na,"overflow-y":Na,padding:[4,y],"padding-bottom":y,"padding-left":y,"padding-right":y,"padding-top":y,"page-break-after":jb,"page-break-before":jb,position:["absolute","fixed","relative","static"],quotes:[8,cb],right:[y,"auto"],"table-layout":["auto","fixed"],"text-align":["center","justify","left","right"],"text-decoration":["none","underline","overline","line-through","blink"],"text-indent":y,"text-shadow":["none",\n4,[Z,y]],"text-transform":["capitalize","uppercase","lowercase","none"],top:[y,"auto"],"unicode-bidi":["normal","embed","bidi-override"],"vertical-align":["baseline","bottom","sub","super","top","text-top","middle","text-bottom",y],visibility:["visible","hidden","collapse"],"white-space":["normal","nowrap","pre","pre-line","pre-wrap","inherit"],width:[y,"auto"],"word-spacing":["normal",y],"word-wrap":["break-word","normal"],"z-index":["auto",Ja]};Ea("(number)",function(){return this});Ea("(string)",\nfunction(){return this});P["(identifier)"]={type:"(identifier)",lbp:0,identifier:true,nud:function(){var b=this.value,d=E[b],c;if(typeof d==="function")d=undefined;else if(typeof d==="boolean"){c=o;o=za[0];ga(b,"var");d=o;o=c}if(o===d)switch(o[b]){case "unused":o[b]="var";break;case "unction":o[b]="function";this["function"]=true;break;case "function":this["function"]=true;break;case "label":f("\'{a}\' is a statement label.",h,b);break}else if(o["(global)"]){k.undef&&D[b]!=="boolean"&&f("\'{a}\' is not defined.",\nh,b);ab(h)}else switch(o[b]){case "closure":case "function":case "var":case "unused":f("\'{a}\' used out of scope.",h,b);break;case "label":f("\'{a}\' is a statement label.",h,b);break;case "outer":case "global":break;default:if(d===true)o[b]=true;else if(d===null){f("\'{a}\' is not allowed.",h,b);ab(h)}else if(typeof d!=="object"){if(k.undef)f("\'{a}\' is not defined.",h,b);else o[b]=true;ab(h)}else switch(d[b]){case "function":case "unction":this["function"]=true;d[b]="closure";o[b]=d["(global)"]?"global":\n"outer";break;case "var":case "unused":d[b]="closure";o[b]=d["(global)"]?"global":"outer";break;case "closure":case "parameter":o[b]=d["(global)"]?"global":"outer";break;case "label":f("\'{a}\' is a statement label.",h,b)}}return this},led:function(){p("Expected an operator and instead saw \'{a}\'.",a,a.value)}};Ea("(regexp)",function(){return this});G("(endline)");G("(begin)");G("(end)").reach=true;G("</").reach=true;G("<!");G("<!--");G("--\\>");G("(error)").reach=true;G("}").reach=true;G(")");G("]");\nG(\'"\').reach=true;G("\'").reach=true;G(";");G(":").reach=true;G(",");G("#");G("@");C("else");C("case").reach=true;C("catch");C("default").reach=true;C("finally");Y("arguments",function(b){if(Ha&&o["(global)"])f("Strict violation.",b);else k.safe&&f("ADsafe violation.",b)});Y("eval",function(b){k.safe&&f("ADsafe violation.",b)});Y("false");Y("Infinity");Y("NaN");Y("null");Y("this",function(b){if(Ha&&(o["(statement)"]&&o["(name)"].charAt(0)>"Z"||o["(global)"]))f("Strict violation.",b);else k.safe&&f("ADsafe violation.",\nb)});Y("true");Y("undefined");la("=","assign",20);la("+=","assignadd",20);la("-=","assignsub",20);la("*=","assignmult",20);la("/=","assigndiv",20).nud=function(){p("A regular expression literal can be confused with \'/=\'.")};la("%=","assignmod",20);na("&=","assignbitand",20);na("|=","assignbitor",20);na("^=","assignbitxor",20);na("<<=","assignshiftleft",20);na(">>=","assignshiftright",20);na(">>>=","assignshiftrightunsigned",20);M("?",function(b,d){d.left=b;d.right=u(10);e(":");d["else"]=u(10);return d},\n30);M("||","or",40);M("&&","and",50);ma("|","bitor",70);ma("^","bitxor",80);ma("&","bitand",90);fa("==",function(b,d){if(k.eqeqeq)f("Expected \'{a}\' and instead saw \'{b}\'.",this,"===","==");else if(Fa(b))f("Use \'{a}\' to compare with \'{b}\'.",this,"===",b.value);else Fa(d)&&f("Use \'{a}\' to compare with \'{b}\'.",this,"===",d.value);return this});fa("===");fa("!=",function(b,d){if(k.eqeqeq)f("Expected \'{a}\' and instead saw \'{b}\'.",this,"!==","!=");else if(Fa(b))f("Use \'{a}\' to compare with \'{b}\'.",this,\n"!==",b.value);else Fa(d)&&f("Use \'{a}\' to compare with \'{b}\'.",this,"!==",d.value);return this});fa("!==");fa("<");fa(">");fa("<=");fa(">=");ma("<<","shiftleft",120);ma(">>","shiftright",120);ma(">>>","shiftrightunsigned",120);M("in","in",120);M("instanceof","instanceof",120);M("+",function(b,d){var c=u(130);if(b&&c&&b.id==="(string)"&&c.id==="(string)"){b.value+=c.value;b.character=c.character;$a.test(b.value)&&f("JavaScript URL.",b);return b}d.left=b;d.right=c;return d},130);Q("+","num");Q("+++",\nfunction(){f("Confusing pluses.");this.right=u(150);this.arity="unary";return this});M("+++",function(b){f("Confusing pluses.");this.left=b;this.right=u(130);return this},130);M("-","sub",130);Q("-","neg");Q("---",function(){f("Confusing minuses.");this.right=u(150);this.arity="unary";return this});M("---",function(b){f("Confusing minuses.");this.left=b;this.right=u(130);return this},130);M("*","mult",140);M("/","div",140);M("%","mod",140);sb("++","postinc");Q("++","preinc");P["++"].exps=true;sb("--",\n"postdec");Q("--","predec");P["--"].exps=true;Q("delete",function(){var b=u(0);if(!b||b.id!=="."&&b.id!=="[")f("Variables should not be deleted.");this.first=b;return this}).exps=true;Q("~",function(){k.bitwise&&f("Unexpected \'{a}\'.",this,"~");u(150);return this});Q("!",function(){this.right=u(150);this.arity="unary";Kb[this.right.id]===true&&f("Confusing use of \'{a}\'.",this,"!");return this});Q("typeof","typeof");Q("new",function(){var b=u(155),d;if(b&&b.id!=="function")if(b.identifier){b["new"]=\ntrue;switch(b.value){case "Object":f("Use the object literal notation {}.",h);break;case "Array":if(a.id!=="(")f("Use the array literal notation [].",h);else{e("(");if(a.id===")")f("Use the array literal notation [].",h);else{d=u(0);b.dimension=d;if(d.id==="(number)"&&/[.+\\-Ee]/.test(d.value)||d.id==="-"&&!d.right||d.id==="(string)"||d.id==="["||d.id==="{"||d.id==="true"||d.id==="false"||d.id==="null"||d.id==="undefined"||d.id==="Infinity")f("Use the array literal notation [].",h);a.id!==")"&&p("Use the array literal notation [].",\nh)}e(")")}this.first=b;return this;case "Number":case "String":case "Boolean":case "Math":case "JSON":f("Do not use {a} as a constructor.",h,b.value);break;case "Function":k.evil||f("The Function constructor is eval.");break;case "Date":case "RegExp":break;default:if(b.id!=="function"){d=b.value.substr(0,1);if(k.newcap&&(d<"A"||d>"Z"))f("A constructor name should start with an uppercase letter.",h)}}}else b.id!=="."&&b.id!=="["&&b.id!=="("&&f("Bad constructor.",h);else f("Weird construction. Delete \'new\'.",\nthis);J(h,a);a.id!=="("&&f("Missing \'()\' invoking a constructor.");this.first=b;return this});P["new"].exps=true;M(".",function(b,d){J(I,h);Ua();var c=ua();typeof c==="string"&&Ia(c);d.left=b;d.right=c;if(b&&b.value==="arguments"&&(c==="callee"||c==="caller"))f("Avoid arguments.{a}.",b,c);else if(!k.evil&&b&&b.value==="document"&&(c==="write"||c==="writeln"))f("document.write can be a form of eval.",b);else if(k.adsafe)if(b&&b.value==="ADSAFE")if(c==="id"||c==="lib")f("ADsafe violation.",d);else if(c===\n"go"){if(r!=="script")f("ADsafe violation.",d);else if(Aa||a.id!=="("||O(0).id!=="(string)"||O(0).value!==T||O(1).id!==",")p("ADsafe violation: go.",d);Aa=true;oa=false}if(!k.evil&&(c==="eval"||c==="execScript"))f("eval is evil.");else if(k.safe)for(;;){Xa[c]===true&&f("ADsafe restricted word \'{a}\'.",h,c);if(typeof D[b.value]!=="boolean"||a.id==="(")break;if(Nb[c]===true){a.id==="."&&f("ADsafe violation.",d);break}if(a.id!=="."){f("ADsafe violation.",d);break}e(".");h.left=d;h.right=c;d=h;c=ua();\ntypeof c==="string"&&Ia(c)}return d},160,true);M("(",function(b,d){I.id!=="}"&&I.id!==")"&&Ua(I,h);K();k.immed&&!b.immed&&b.id==="function"&&f("Wrap an immediate function invocation in parentheses to assist the reader in understanding that the expression is the result of a function, and not the function itself.");var c=0,g=[];if(b)if(b.type==="(identifier)"){if(b.value.match(/^[A-Z]([A-Z0-9_$]*[a-z][A-Za-z0-9_$]*)?$/))if(b.value!=="Number"&&b.value!=="String"&&b.value!=="Boolean"&&b.value!=="Date")if(b.value===\n"Math")f("Math is not a function.",b);else k.newcap&&f("Missing \'new\' prefix when invoking a constructor.",b)}else b.id==="."&&k.safe&&b.left.value==="Math"&&b.right==="random"&&f("ADsafe violation.",b);if(a.id!==")")for(;;){g[g.length]=u(10);c+=1;if(a.id!==",")break;S()}e(")");K(I,h);if(typeof b==="object"){b.value==="parseInt"&&c===1&&f("Missing radix parameter.",b);if(!k.evil)if(b.value==="eval"||b.value==="Function"||b.value==="execScript")f("eval is evil.",b);else if(g[0]&&g[0].id==="(string)"&&\n(b.value==="setTimeout"||b.value==="setInterval"))f("Implied eval is evil. Pass a function instead of a string.",b);!b.identifier&&b.id!=="."&&b.id!=="["&&b.id!=="("&&b.id!=="&&"&&b.id!=="||"&&b.id!=="?"&&f("Bad invocation.",b)}d.left=b;return d},155,true).exps=true;Q("(",function(){K();if(a.id==="function")a.immed=true;var b=u(0);e(")",this);K(I,h);if(k.immed&&b.id==="function")a.id==="("?f("Move the invocation into the parens that contain the function.",a):f("Do not wrap function literals in parens unless they are to be immediately invoked.",\nthis);return b});M("[",function(b,d){Ua(I,h);K();var c=u(0),g;if(c&&c.type==="(string)"){if(k.safe&&Xa[c.value]===true)f("ADsafe restricted word \'{a}\'.",d,c.value);else if(!k.evil&&(c.value==="eval"||c.value==="execScript"))f("eval is evil.",d);else if(k.safe&&(c.value.charAt(0)==="_"||c.value.charAt(0)==="-"))f("ADsafe restricted subscript \'{a}\'.",d,c.value);Ia(c.value);if(!k.sub&&Bb.test(c.value)){g=P[c.value];if(!g||!g.reserved)f("[\'{a}\'] is better written in dot notation.",c,c.value)}}else if(!c||\nc.type!=="(number)"||c.value<0)k.safe&&f("ADsafe subscripting.");e("]",d);K(I,h);d.left=b;d.right=c;return d},160,true);Q("[",function(){var b=h.line!==a.line;this.first=[];if(b){F+=k.indent;if(a.from===F+k.indent)F+=k.indent}for(;a.id!=="(end)";){for(;a.id===",";){f("Extra comma.");e(",")}if(a.id==="]")break;b&&h.line!==a.line&&V();this.first.push(u(10));if(a.id===","){S();if(a.id==="]"&&!k.es5){f("Extra comma.",h);break}}else break}if(b){F-=k.indent;V()}e("]",this);return this},160);(function(b){b.nud=\nfunction(){var d,c,g,i,j={};if(d=h.line!==a.line){F+=k.indent;if(a.from===F+k.indent)F+=k.indent}for(;;){if(a.id==="}")break;d&&V();if(a.value==="get"&&O().id!==":"){e("get");k.es5||p("get/set are ES5 features.");(g=hb())||p("Missing property name.");i=a;J(h,a);c=La(g);o["(loopage)"]&&f("Don\'t make functions within a loop.",i);(c=c["(params)"])&&f("Unexpected parameter \'{a}\' in get {b} function.",i,c[0],g);J(h,a);e(",");V();e("set");i=hb();g!==i&&p("Expected {a} and instead saw {b}.",h,g,i);i=a;J(h,\na);c=La(g);c=c["(params)"];if(!c||c.length!==1||c[0]!=="value")f("Expected (value) in set {a} function.",i,g)}else{g=hb();if(typeof g!=="string")break;e(":");B(h,a);u(10)}j[g]===true&&f("Duplicate member \'{a}\'.",a,g);j[g]=true;Ia(g);if(a.id===","){S();if(a.id===",")f("Extra comma.",h);else a.id==="}"&&!k.es5&&f("Extra comma.",h)}else break}if(d){F-=k.indent;V()}e("}",this);return this};b.fud=function(){p("Expected to see a statement and instead saw a block.",h)}})(G("{"));var ob=function(b){var d,\nc;if(o["(onevar)"]&&k.onevar)f("Too many var statements.");else o["(global)"]||(o["(onevar)"]=true);for(this.first=[];;){B(h,a);d=ua();o["(global)"]&&D[d]===false&&f("Redefinition of \'{a}\'.",h,d);ga(d,"unused");if(b)break;c=h;this.first.push(h);if(a.id==="="){B(h,a);e("=");B(h,a);a.id==="undefined"&&f("It is not necessary to initialize \'{a}\' to \'undefined\'.",h,d);if(O(0).id==="="&&a.identifier){e();e("=");e()}d=u(0);c.first=d}if(a.id!==",")break;S()}return this};ea("var",ob).exps=true;ka("function",\nfunction(){wa&&f("Function statements cannot be placed in blocks. Use a function expression or move the statement to the top of the outer function.",h);var b=ua();J(h,a);ga(b,"unction");La(b,true);a.id==="("&&a.line===h.line&&p("Function statements are not invocable. Wrap the whole function invocation in parens.");return this});Q("function",function(){var b=Wa();b?J(h,a):B(h,a);La(b);o["(loopage)"]&&f("Don\'t make functions within a loop.");return this});ka("if",function(){var b=a;e("(");B(this,b);\nK();u(20);if(a.id==="="){f("Expected a conditional expression and instead saw an assignment.");e("=");u(20)}e(")",b);K(I,h);W(true);if(a.id==="else"){B(h,a);e("else");a.id==="if"||a.id==="switch"?Za(true):W(true)}return this});ka("try",function(){var b,d;k.adsafe&&f("ADsafe try violation.",this);W(false);if(a.id==="catch"){e("catch");B(h,a);e("(");d=E;E=Object.create(d);b=a.value;a.type!=="(identifier)"?f("Expected an identifier and instead saw \'{a}\'.",a,b):ga(b,"exception");e();e(")");W(false);b=\ntrue;E=d}if(a.id==="finally"){e("finally");W(false)}else{b||p("Expected \'{a}\' and instead saw \'{b}\'.",a,"catch",a.value);return this}});ka("while",function(){var b=a;o["(breakage)"]+=1;o["(loopage)"]+=1;e("(");B(this,b);K();u(20);if(a.id==="="){f("Expected a conditional expression and instead saw an assignment.");e("=");u(20)}e(")",b);K(I,h);W(true);o["(breakage)"]-=1;o["(loopage)"]-=1;return this}).labelled=true;C("with");ka("switch",function(){var b=a,d=false;o["(breakage)"]+=1;e("(");B(this,b);\nK();this.condition=u(20);e(")",b);K(I,h);B(h,a);b=a;e("{");B(h,a);F+=k.indent;for(this.cases=[];;)switch(a.id){case "case":switch(o["(verb)"]){case "break":case "case":case "continue":case "return":case "switch":case "throw":break;default:f("Expected a \'break\' statement before \'case\'.",h)}V(-k.indent);e("case");this.cases.push(u(20));d=true;e(":");o["(verb)"]="case";break;case "default":switch(o["(verb)"]){case "break":case "continue":case "return":case "throw":break;default:f("Expected a \'break\' statement before \'default\'.",\nh)}V(-k.indent);e("default");d=true;e(":");break;case "}":F-=k.indent;V();e("}",b);if(this.cases.length===1||this.condition.id==="true"||this.condition.id==="false")f("This \'switch\' should be an \'if\'.",this);o["(breakage)"]-=1;o["(verb)"]=undefined;return;case "(end)":p("Missing \'{a}\'.",a,"}");return;default:if(d)switch(h.id){case ",":p("Each value should have its own case label.");return;case ":":va();break;default:p("Missing \':\' on a case clause.",h)}else p("Expected \'{a}\' and instead saw \'{b}\'.",\na,"case",a.value)}}).labelled=true;ea("debugger",function(){k.debug||f("All \'debugger\' statements should be removed.");return this}).exps=true;(function(){var b=ea("do",function(){o["(breakage)"]+=1;o["(loopage)"]+=1;this.first=W(true);e("while");var d=a;B(h,d);e("(");K();u(20);if(a.id==="="){f("Expected a conditional expression and instead saw an assignment.");e("=");u(20)}e(")",d);K(I,h);o["(breakage)"]-=1;o["(loopage)"]-=1;return this});b.labelled=true;b.exps=true})();ka("for",function(){var b=\nk.forin,d;d=a;o["(breakage)"]+=1;o["(loopage)"]+=1;e("(");B(this,d);K();if(O(a.id==="var"?1:0).id==="in"){if(a.id==="var"){e("var");ob(true)}else{switch(o[a.value]){case "unused":o[a.value]="var";break;case "var":break;default:f("Bad for in variable \'{a}\'.",a,a.value)}e()}e("in");u(20);e(")",d);d=W(true);if(!b&&(d.length>1||typeof d[0]!=="object"||d[0].value!=="if"))f("The body of a for in should be wrapped in an if statement to filter unwanted properties from the prototype.",this)}else{if(a.id!==\n";")if(a.id==="var"){e("var");ob()}else for(;;){u(0,"for");if(a.id!==",")break;S()}ca(h);e(";");if(a.id!==";"){u(20);if(a.id==="="){f("Expected a conditional expression and instead saw an assignment.");e("=");u(20)}}ca(h);e(";");a.id===";"&&p("Expected \'{a}\' and instead saw \'{b}\'.",a,")",";");if(a.id!==")")for(;;){u(0,"for");if(a.id!==",")break;S()}e(")",d);K(I,h);W(true)}o["(breakage)"]-=1;o["(loopage)"]-=1;return this}).labelled=true;ea("break",function(){var b=a.value;o["(breakage)"]===0&&f("Unexpected \'{a}\'.",\na,this.value);ca(this);if(a.id!==";")if(h.line===a.line){if(o[b]!=="label")f("\'{a}\' is not a statement label.",a,b);else E[b]!==o&&f("\'{a}\' is out of scope.",a,b);this.first=a;e()}Ga("break");return this}).exps=true;ea("continue",function(){var b=a.value;o["(breakage)"]===0&&f("Unexpected \'{a}\'.",a,this.value);ca(this);if(a.id!==";"){if(h.line===a.line){if(o[b]!=="label")f("\'{a}\' is not a statement label.",a,b);else E[b]!==o&&f("\'{a}\' is out of scope.",a,b);this.first=a;e()}}else o["(loopage)"]||\nf("Unexpected \'{a}\'.",a,this.value);Ga("continue");return this}).exps=true;ea("return",function(){ca(this);a.id==="(regexp)"&&f("Wrap the /regexp/ literal in parens to disambiguate the slash operator.");if(a.id!==";"&&!a.reach){B(h,a);this.first=u(20)}Ga("return");return this}).exps=true;ea("throw",function(){ca(this);B(h,a);this.first=u(20);Ga("throw");return this}).exps=true;C("void");C("class");C("const");C("enum");C("export");C("extends");C("import");C("super");C("let");C("yield");C("implements");\nC("interface");C("package");C("private");C("protected");C("public");C("static");var aa=function(b,d){var c,g;JSLINT.errors=[];D=Object.create(Mb);if(d){c=d.predef;if(c instanceof Array)for(g=0;g<c.length;g+=1)D[c[g]]=true;if(d.adsafe)d.safe=true;if(d.safe){d.browser=d.css=d.debug=d.devel=d.evil=d.forin=d.on=d.rhino=d.windows=d.sub=d.widget=false;d.eqeqeq=d.nomen=d.safe=d.strict=d.undef=true;D.Date=D.eval=D.Function=D.Object=null;D.ADSAFE=D.lib=false}k=d}else k={};k.indent=k.indent||4;k.maxerr=k.maxerr||\n50;T="";Aa=oa=false;Ma={};if(k.approved)for(g=0;g<k.approved.length;g+=1)Ma[k.approved[g]]=k.approved[g];else Ma.test="test";lb="";for(g=0;g<k.indent;g+=1)lb+=" ";F=1;E=qb=Object.create(D);o={"(global)":true,"(name)":"(global)","(scope)":E,"(breakage)":0,"(loopage)":0};za=[o];Oa={};ya=[];r=Pa=false;L=null;ia={};ha=null;ba={};wa=false;Da=[];qa=false;Sa=0;X.init(b);kb=true;Ha=false;I=h=a=P["(begin)"];Qa();try{e();if(a.value.charAt(0)==="<"){a:{var i,j,n,v,q,l,t,x=k.white,m;r="html";R="";for(L=null;;){switch(a.value){case "<":r=\n"html";e("<");j={};l=a;l.identifier||f("Bad identifier {a}.",l,l.value);v=l.value;if(k.cap)v=v.toLowerCase();l.name=v;e();if(!L){L=[];c=v;if(c!=="html"&&!k.fragment)c==="div"&&k.adsafe?p("ADSAFE: Use the fragment option."):p("Expected \'{a}\' and instead saw \'{b}\'.",h,"html",c);if(k.adsafe){c==="html"&&p("Currently, ADsafe does not operate on whole HTML documents. It operates on <div> fragments and .js files.",h);if(k.fragment)c!=="div"&&p("ADsafe violation: Wrap the widget in a div.",h);else p("Use the fragment option.",\nh)}k.browser=true;Qa()}t=gb[v];typeof t!=="object"&&p("Unrecognized tag \'<{a}>\'.",l,v);n=t.empty;for(l.type=v;;){if(a.id==="/"){e("/");a.id!==">"&&f("Expected \'{a}\' and instead saw \'{b}\'.",a,">",a.value);break}if(a.id&&a.id.substr(0,1)===">")break;if(!a.identifier){if(a.id==="(end)"||a.id==="(error)")p("Missing \'>\'.",a);f("Bad identifier.")}k.white=true;B(h,a);i=a.value;k.white=x;e();!k.cap&&i!==i.toLowerCase()&&f("Attribute \'{a}\' not all lower case.",a,i);i=i.toLowerCase();R="";U(j,i)&&f("Attribute \'{a}\' repeated.",\na,i);if(i.slice(0,2)==="on"){k.on||f("Avoid HTML event handlers.");r="scriptstring";e("=");q=a.id;q!==\'"\'&&q!=="\'"&&p("Missing quote.");R=q;m=k.white;k.white=false;e(q);va("on");k.white=m;a.id!==q&&p("Missing close quote on script attribute.");r="html";R="";e(q);t=false}else if(i==="style"){r="scriptstring";e("=");q=a.id;q!==\'"\'&&q!=="\'"&&p("Missing quote.");r="styleproperty";R=q;e(q);wb();r="html";R="";e(q);t=false}else if(a.id==="="){e("=");t=a.value;!a.identifier&&a.id!==\'"\'&&a.id!=="\'"&&a.type!==\n"(string)"&&a.type!=="(number)"&&a.type!=="(color)"&&f("Expected an attribute value and instead saw \'{a}\'.",h,i);e()}else t=true;j[i]=t;c=i;g=t;var w=void 0,z=void 0;if(c==="id"){w=typeof g==="string"?g.toUpperCase():"";Oa[w]===true&&f("Duplicate id=\'{a}\'.",a,g);if(/^[A-Za-z][A-Za-z0-9._:\\-]*$/.test(g)){if(k.adsafe)if(T)if(g.slice(0,T.length)!==T)f("ADsafe violation: An id must have a \'{a}\' prefix",a,T);else/^[A-Z]+_[A-Z]+$/.test(g)||f("ADSAFE violation: bad id.");else{T=g;/^[A-Z]+_$/.test(g)||f("ADSAFE violation: bad id.")}}else f("Bad id: \'{a}\'.",\na,g);z=g.search(Vb);z>=0&&f("Unexpected character \'{a}\' in {b}.",h,g.charAt(z),c);Oa[w]=true}else if(c==="class"||c==="type"||c==="name"){z=g.search(Ub);z>=0&&f("Unexpected character \'{a}\' in {b}.",h,g.charAt(z),c);Oa[w]=true}else if(c==="href"||c==="background"||c==="content"||c==="data"||c.indexOf("src")>=0||c.indexOf("url")>=0){k.safe&&vb.test(g)&&p("ADsafe URL violation.");ya.push(g)}else if(c==="for"){if(k.adsafe)if(T)if(g.slice(0,T.length)!==T)f("ADsafe violation: An id must have a \'{a}\' prefix",\na,T);else/^[A-Z]+_[A-Z]+$/.test(g)||f("ADSAFE violation: bad id.");else f("ADSAFE violation: bad id.")}else c==="name"&&k.adsafe&&g.indexOf("_")>=0&&f("ADsafe name violation.")}c=v;g=j;w=void 0;var Ca=gb[c];z=void 0;Pa=false;Ca||p("Unrecognized tag \'<{a}>\'.",a,c===c.toLowerCase()?c:c+" (capitalization error)");if(L.length>0){c==="html"&&p("Too many <html> tags.",h);if(z=Ca.parent)z.indexOf(" "+L[L.length-1].name+" ")<0&&p("A \'<{a}>\' must be within \'<{b}>\'.",h,c,z);else if(!k.adsafe&&!k.fragment){w=\nL.length;do{w<=0&&p("A \'<{a}>\' must be within \'<{b}>\'.",h,c,"body");w-=1}while(L[w].name!=="body")}}switch(c){case "div":k.adsafe&&L.length===1&&!T&&f("ADSAFE violation: missing ID_.");break;case "script":r="script";e(">");F=a.from;g.lang&&f("lang is deprecated.",h);k.adsafe&&L.length!==1&&f("ADsafe script placement violation.",h);if(g.src){if(k.adsafe&&(!oa||!Ma[g.src]))f("ADsafe unapproved script source.",h);g.type&&f("type is unnecessary.",h)}else{Aa&&p("ADsafe script violation.",h);va("script")}r=\n"html";e("</");!a.identifier&&a.value!=="script"&&f("Expected \'{a}\' and instead saw \'{b}\'.",a,"script",a.value);e();r="outer";break;case "style":r="style";e(">");yb();r="html";e("</");!a.identifier&&a.value!=="style"&&f("Expected \'{a}\' and instead saw \'{b}\'.",a,"style",a.value);e();r="outer";break;case "input":switch(g.type){case "radio":case "checkbox":case "button":case "reset":case "submit":break;case "text":case "file":case "password":case "file":case "hidden":case "image":k.adsafe&&g.autocomplete!==\n"off"&&f("ADsafe autocomplete violation.");break;default:f("Bad input type.")}break;case "applet":case "body":case "embed":case "frame":case "frameset":case "head":case "iframe":case "noembed":case "noframes":case "object":case "param":k.adsafe&&f("ADsafe violation: Disallowed tag: "+c);break}n||L.push(l);r="outer";e(">");break;case "</":r="html";e("</");a.identifier||f("Bad identifier.");v=a.value;if(k.cap)v=v.toLowerCase();e();L||p("Unexpected \'{a}\'.",a,"</"+v+">");(l=L.pop())||p("Unexpected \'{a}\'.",\na,"</"+v+">");l.name!==v&&p("Expected \'{a}\' and instead saw \'{b}\'.",a,"</"+l.name+">","</"+v+">");a.id!==">"&&p("Missing \'{a}\'.",a,">");r="outer";e(">");break;case "<!":k.safe&&f("ADsafe HTML violation.");for(r="html";;){e();if(a.id===">"||a.id==="(end)")break;a.value.indexOf("--")>=0&&p("Unexpected --.");a.value.indexOf("<")>=0&&p("Unexpected <.");a.value.indexOf(">")>=0&&p("Unexpected >.")}r="outer";e(">");break;case "(end)":break a;default:a.id==="(end)"?p("Missing \'{a}\'.",a,"</"+L[L.length-1].value+\n">"):e()}if(L&&L.length===0&&(k.adsafe||!k.fragment||a.id==="(end)"))break}a.id!=="(end)"&&p("Unexpected material after the end.")}k.adsafe&&!Aa&&f("ADsafe violation: Missing ADSAFE.go.",this)}else switch(a.id){case "{":case "[":qa=k.laxbreak=true;ib();break;case "@":case "*":case "#":case ".":case ":":r="style";e();if(h.id!=="@"||!a.identifier||a.value!=="charset"||h.line!==1||h.from!==1)p("A css file should begin with @charset \'UTF-8\';");e();a.type!=="(string)"&&a.value!=="UTF-8"&&p("A css file should begin with @charset \'UTF-8\';");\ne();e(";");yb();break;default:k.adsafe&&k.fragment&&p("Expected \'{a}\' and instead saw \'{b}\'.",a,"<div>",a.value);va("lib")}e("(end)")}catch(A){if(A)JSLINT.errors.push({reason:A.message,line:A.line||a.line,character:A.character||a.from},null)}return JSLINT.errors.length===0};aa.data=function(){var b={functions:[]},d;d=[];var c,g,i,j,n=[];if(aa.errors.length)b.errors=aa.errors;if(qa)b.json=true;for(j in ba)U(ba,j)&&d.push({name:j,line:ba[j]});if(d.length>0)b.implieds=d;if(ya.length>0)b.urls=ya;d=Ab(E);\nif(d.length>0)b.globals=d;for(g=1;g<za.length;g+=1){c=za[g];d={};for(i=0;i<Ba.length;i+=1)d[Ba[i]]=[];for(j in c)if(U(c,j)&&j.charAt(0)!=="("){i=c[j];if(i==="unction")i="unused";if(Object.prototype.toString.apply(d[i])==="[object Array]"){d[i].push(j);i==="unused"&&n.push({name:j,line:c["(line)"],"function":c["(name)"]})}}for(i=0;i<Ba.length;i+=1)d[Ba[i]].length===0&&delete d[Ba[i]];d.name=c["(name)"];d.param=c["(params)"];d.line=c["(line)"];d.last=c["(last)"];b.functions.push(d)}if(n.length>0)b.unused=\nn;for(j in ia)if(typeof ia[j]==="number"){b.member=ia;break}return b};aa.report=function(b){function d(l,t){var x,m,w;if(t){q.push("<div><i>"+l+"</i> ");t=t.sort();for(m=0;m<t.length;m+=1)if(t[m]!==w){w=t[m];q.push((x?", ":"")+w);x=true}q.push("</div>")}}var c=aa.data(),g=[],i,j,n;i="";var v,q=[];if(c.errors||c.implieds||c.unused){j=true;q.push("<div id=errors><i>Error:</i>");if(c.errors)for(n=0;n<c.errors.length;n+=1)if(g=c.errors[n]){i=g.evidence||"";q.push("<p>Problem"+(isFinite(g.line)?" at line "+\ng.line+" character "+g.character:"")+": "+g.reason.entityify()+"</p><p class=evidence>"+(i&&(i.length>80?i.slice(0,77)+"...":i).entityify())+"</p>")}if(c.implieds){g=[];for(n=0;n<c.implieds.length;n+=1)g[n]="<code>"+c.implieds[n].name+"</code>&nbsp;<i>"+c.implieds[n].line+"</i>";q.push("<p><i>Implied global:</i> "+g.join(", ")+"</p>")}if(c.unused){g=[];for(n=0;n<c.unused.length;n+=1)g[n]="<code><u>"+c.unused[n].name+"</u></code>&nbsp;<i>"+c.unused[n].line+"</i> <code>"+c.unused[n]["function"]+"</code>";\nq.push("<p><i>Unused variable:</i> "+g.join(", ")+"</p>")}c.json&&q.push("<p>JSON: bad.</p>");q.push("</div>")}if(!b){q.push("<br><div id=functions>");c.urls&&d("URLs<br>",c.urls,"<br>");if(r==="style")q.push("<p>CSS.</p>");else if(c.json&&!j)q.push("<p>JSON: good.</p>");else c.globals?q.push("<div><i>Global</i> "+c.globals.sort().join(", ")+"</div>"):q.push("<div><i>No new global variables introduced.</i></div>");for(n=0;n<c.functions.length;n+=1){b=c.functions[n];q.push("<br><div class=function><i>"+\nb.line+"-"+b.last+"</i> "+(b.name||"")+"("+(b.param?b.param.join(", "):"")+")</div>");d("<big><b>Unused</b></big>",b.unused);d("Closure",b.closure);d("Variable",b["var"]);d("Exception",b.exception);d("Outer",b.outer);d("Global",b.global);d("Label",b.label)}if(c.member){g=Ab(c.member);if(g.length){g=g.sort();i="<br><pre id=members>/*members ";j=10;for(n=0;n<g.length;n+=1){b=g[n];v=b.name();if(j+v.length>72){q.push(i+"<br>");i="    ";j=1}j+=v.length+2;if(c.member[b]===1)v="<i>"+v+"</i>";if(n<g.length-\n1)v+=", ";i+=v}q.push(i+"<br>*/</pre>")}q.push("</div>")}}return q.join("")};aa.jslint=aa;aa.edition="2010-11-18";return aa}();\n');
jsio.setCachedSrc("../../packages/util/path.js","var util=jsio.__jsio.__util;exports.buildPath=util.buildPath;exports.resolveRelativePath=util.resolveRelativePath;exports.splitPath=util.splitPath;exports.makeRelativePath=util.makeRelativePath;\n");jsio.setCachedSrc("../../packages/util/syntax.js",'jsio("import .jslint");var isBrowser=jsio.__env.name=="browser",isRhino=jsio.__env.name=="rhino",base=jsio("base"),globals=["exports","jsio","logger"];for(var i in base)globals.push(i);exports=function(d,b){b=b||exports.defaultOpts;!jslint(d,b)&&b.display&&exports.display(jslint.errors);return jslint.errors};\nexports.display=function(d,b){for(var e=[b||""],c=[\'<div class="_jsioLint_title">\'+(b||"")+"</div>"],f=0,a;a=d[f];++f){e.push(a.line+"-"+a.character+": "+a.reason+"\\n> "+a.evidence);c.push(\'<span class="_jsioLint_lineNum">line \'+a.line+"</span>");c.push(": ");c.push(\'<span class="_jsioLint_reason">\'+a.reason+"</span>");if("evidence"in a){c.push(\'<div class="_jsioLint_evidence">\'+a.evidence.replace(/ /g,\'<span class="_jsioLint_whitespace">\\u00b7</span>\').replace(/\\t/g,\'<span class="_jsioLint_whitespace">\\u21fe   </span>\')+\n"</div>");c.push(Array(a.character).join(" ")+\'\\u21d1<span class="_jsioLint_charNum">@\'+a.character+"</span>\\n")}c.push("\\n")}logger.log(e.join("\\n"));jsio("util/browser").$({tag:"pre",id:"syntaxCheck",style:{padding:"50px",fontSize:"16px"},html:"<style>._jsioLint_title { color: #FFF; padding-bottom: 6px; border-bottom: 3px dashed #888; margin-bottom: 30px }._jsioLint_whitespace {color: #444}._jsioLint_lineNum { color: rgb(153,207,80)}._jsioLint_charNum { color: rgb(51,135,204)}._jsioLint_reason { color: rgb(137,189,255)}._jsioLint_evidence { color:rgb(226,137,100)}</style>"+\nc.join(""),parent:$({tag:"div",style:{background:"#000",position:"absolute",top:"0px",left:"0px",margin:"0px",padding:"0px",color:"#AAA",width:"100%",height:"100%",overflow:"auto",fontWeight:"bold",fontFamily:\'consolas, "courier new"\',zIndex:2E6},parent:document.body})})};\nexports.defaultOpts={adsafe:false,bitwise:false,browser:isBrowser,cap:true,css:true,debug:true,devel:true,eqeqeq:false,es5:false,evil:false,forin:false,fragment:true,immed:true,laxbreak:true,newcap:true,nomen:false,on:true,onevar:false,passfail:false,plusplus:false,regexp:false,rhino:isRhino,undef:false,safe:false,windows:false,strict:false,sub:true,white:false,widget:false,predef:globals};\nexports.warnOpts={adsafe:false,bitwise:false,browser:true,cap:true,css:true,debug:false,devel:false,eqeqeq:false,es5:false,evil:false,forin:false,fragment:true,immed:true,laxbreak:true,newcap:true,nomen:false,on:true,onevar:false,passfail:false,plusplus:false,regexp:false,rhino:true,undef:false,safe:false,windows:true,strict:false,sub:true,white:true,widget:false};\n');
jsio.setCachedSrc("../../packages/util/underscore.js",'(function(){var q=this,D=q._,n={},k=Array.prototype,o=Object.prototype,i=k.slice,E=k.unshift,F=o.toString,m=o.hasOwnProperty,t=k.forEach,u=k.map,v=k.reduce,w=k.reduceRight,x=k.filter,y=k.every,z=k.some,p=k.indexOf,A=k.lastIndexOf;o=Array.isArray;var G=Object.keys,r=Function.prototype.bind,c=function(a){return new l(a)};if(typeof module!=="undefined"&&module.exports){module.exports=c;c._=c}else q._=c;c.VERSION="1.1.7";var j=c.each=c.forEach=function(a,b,d){if(a!=null)if(t&&a.forEach===t)a.forEach(b,\nd);else if(a.length===+a.length)for(var e=0,f=a.length;e<f;e++){if(e in a&&b.call(d,a[e],e,a)===n)return}else for(e in a)if(m.call(a,e))if(b.call(d,a[e],e,a)===n)return};c.map=function(a,b,d){var e=[];if(a==null)return e;if(u&&a.map===u)return a.map(b,d);j(a,function(f,g,h){e[e.length]=b.call(d,f,g,h)});return e};c.reduce=c.foldl=c.inject=function(a,b,d,e){var f=d!==void 0;if(a==null)a=[];if(v&&a.reduce===v){if(e)b=c.bind(b,e);return f?a.reduce(b,d):a.reduce(b)}j(a,function(g,h,H){if(f)d=b.call(e,\nd,g,h,H);else{d=g;f=true}});if(!f)throw new TypeError("Reduce of empty array with no initial value");return d};c.reduceRight=c.foldr=function(a,b,d,e){if(a==null)a=[];if(w&&a.reduceRight===w){if(e)b=c.bind(b,e);return d!==void 0?a.reduceRight(b,d):a.reduceRight(b)}a=(c.isArray(a)?a.slice():c.toArray(a)).reverse();return c.reduce(a,b,d,e)};c.find=c.detect=function(a,b,d){var e;B(a,function(f,g,h){if(b.call(d,f,g,h)){e=f;return true}});return e};c.filter=c.select=function(a,b,d){var e=[];if(a==null)return e;\nif(x&&a.filter===x)return a.filter(b,d);j(a,function(f,g,h){if(b.call(d,f,g,h))e[e.length]=f});return e};c.reject=function(a,b,d){var e=[];if(a==null)return e;j(a,function(f,g,h){b.call(d,f,g,h)||(e[e.length]=f)});return e};c.every=c.all=function(a,b,d){var e=true;if(a==null)return e;if(y&&a.every===y)return a.every(b,d);j(a,function(f,g,h){if(!(e=e&&b.call(d,f,g,h)))return n});return e};var B=c.some=c.any=function(a,b,d){b=b||c.identity;var e=false;if(a==null)return e;if(z&&a.some===z)return a.some(b,\nd);j(a,function(f,g,h){if(e|=b.call(d,f,g,h))return n});return!!e};c.include=c.contains=function(a,b){var d=false;if(a==null)return d;if(p&&a.indexOf===p)return a.indexOf(b)!=-1;B(a,function(e){if(d=e===b)return true});return d};c.invoke=function(a,b){var d=i.call(arguments,2);return c.map(a,function(e){return(b.call?b||e:e[b]).apply(e,d)})};c.pluck=function(a,b){return c.map(a,function(d){return d[b]})};c.max=function(a,b,d){if(!b&&c.isArray(a))return Math.max.apply(Math,a);var e={computed:-Infinity};\nj(a,function(f,g,h){g=b?b.call(d,f,g,h):f;g>=e.computed&&(e={value:f,computed:g})});return e.value};c.min=function(a,b,d){if(!b&&c.isArray(a))return Math.min.apply(Math,a);var e={computed:Infinity};j(a,function(f,g,h){g=b?b.call(d,f,g,h):f;g<e.computed&&(e={value:f,computed:g})});return e.value};c.sortBy=function(a,b,d){return c.pluck(c.map(a,function(e,f,g){return{value:e,criteria:b.call(d,e,f,g)}}).sort(function(e,f){var g=e.criteria,h=f.criteria;return g<h?-1:g>h?1:0}),"value")};c.groupBy=function(a,\nb){var d={};j(a,function(e,f){var g=b(e,f);(d[g]||(d[g]=[])).push(e)});return d};c.sortedIndex=function(a,b,d){d||(d=c.identity);for(var e=0,f=a.length;e<f;){var g=e+f>>1;d(a[g])<d(b)?e=g+1:f=g}return e};c.toArray=function(a){if(!a)return[];if(a.toArray)return a.toArray();if(c.isArray(a))return i.call(a);if(c.isArguments(a))return i.call(a);return c.values(a)};c.size=function(a){return c.toArray(a).length};c.first=c.head=function(a,b,d){return b!=null&&!d?i.call(a,0,b):a[0]};c.rest=c.tail=function(a,\nb,d){return i.call(a,b==null||d?1:b)};c.last=function(a){return a[a.length-1]};c.compact=function(a){return c.filter(a,function(b){return!!b})};c.flatten=function(a){return c.reduce(a,function(b,d){if(c.isArray(d))return b.concat(c.flatten(d));b[b.length]=d;return b},[])};c.without=function(a){return c.difference(a,i.call(arguments,1))};c.uniq=c.unique=function(a,b){return c.reduce(a,function(d,e,f){if(0==f||(b===true?c.last(d)!=e:!c.include(d,e)))d[d.length]=e;return d},[])};c.union=function(){return c.uniq(c.flatten(arguments))};\nc.intersection=c.intersect=function(a){var b=i.call(arguments,1);return c.filter(c.uniq(a),function(d){return c.every(b,function(e){return c.indexOf(e,d)>=0})})};c.difference=function(a,b){return c.filter(a,function(d){return!c.include(b,d)})};c.zip=function(){for(var a=i.call(arguments),b=c.max(c.pluck(a,"length")),d=Array(b),e=0;e<b;e++)d[e]=c.pluck(a,""+e);return d};c.indexOf=function(a,b,d){if(a==null)return-1;var e;if(d){d=c.sortedIndex(a,b);return a[d]===b?d:-1}if(p&&a.indexOf===p)return a.indexOf(b);\nd=0;for(e=a.length;d<e;d++)if(a[d]===b)return d;return-1};c.lastIndexOf=function(a,b){if(a==null)return-1;if(A&&a.lastIndexOf===A)return a.lastIndexOf(b);for(var d=a.length;d--;)if(a[d]===b)return d;return-1};c.range=function(a,b,d){if(arguments.length<=1){b=a||0;a=0}d=arguments[2]||1;for(var e=Math.max(Math.ceil((b-a)/d),0),f=0,g=Array(e);f<e;){g[f++]=a;a+=d}return g};c.bind=function(a,b){if(a.bind===r&&r)return r.apply(a,i.call(arguments,1));var d=i.call(arguments,2);return function(){return a.apply(b,\nd.concat(i.call(arguments)))}};c.bindAll=function(a){var b=i.call(arguments,1);if(b.length==0)b=c.functions(a);j(b,function(d){a[d]=c.bind(a[d],a)});return a};c.memoize=function(a,b){var d={};b||(b=c.identity);return function(){var e=b.apply(this,arguments);return m.call(d,e)?d[e]:d[e]=a.apply(this,arguments)}};c.delay=function(a,b){var d=i.call(arguments,2);return setTimeout(function(){return a.apply(a,d)},b)};c.defer=function(a){return c.delay.apply(c,[a,1].concat(i.call(arguments,1)))};var C=function(a,\nb,d){var e;return function(){var f=this,g=arguments,h=function(){e=null;a.apply(f,g)};d&&clearTimeout(e);if(d||!e)e=setTimeout(h,b)}};c.throttle=function(a,b){return C(a,b,false)};c.debounce=function(a,b){return C(a,b,true)};c.once=function(a){var b=false,d;return function(){if(b)return d;b=true;return d=a.apply(this,arguments)}};c.wrap=function(a,b){return function(){var d=[a].concat(i.call(arguments));return b.apply(this,d)}};c.compose=function(){var a=i.call(arguments);return function(){for(var b=\ni.call(arguments),d=a.length-1;d>=0;d--)b=[a[d].apply(this,b)];return b[0]}};c.after=function(a,b){return function(){if(--a<1)return b.apply(this,arguments)}};c.keys=G||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var d in a)if(m.call(a,d))b[b.length]=d;return b};c.values=function(a){return c.map(a,c.identity)};c.functions=c.methods=function(a){var b=[];for(var d in a)c.isFunction(a[d])&&b.push(d);return b.sort()};c.extend=function(a){j(i.call(arguments,1),function(b){for(var d in b)if(b[d]!==\nvoid 0)a[d]=b[d]});return a};c.defaults=function(a){j(i.call(arguments,1),function(b){for(var d in b)if(a[d]==null)a[d]=b[d]});return a};c.clone=function(a){return c.isArray(a)?a.slice():c.extend({},a)};c.tap=function(a,b){b(a);return a};c.isEqual=function(a,b){if(a===b)return true;var d=typeof a;if(d!=typeof b)return false;if(a==b)return true;if(!a&&b||a&&!b)return false;if(a._chain)a=a._wrapped;if(b._chain)b=b._wrapped;if(a.isEqual)return a.isEqual(b);if(b.isEqual)return b.isEqual(a);if(c.isDate(a)&&\nc.isDate(b))return a.getTime()===b.getTime();if(c.isNaN(a)&&c.isNaN(b))return false;if(c.isRegExp(a)&&c.isRegExp(b))return a.source===b.source&&a.global===b.global&&a.ignoreCase===b.ignoreCase&&a.multiline===b.multiline;if(d!=="object")return false;if(a.length&&a.length!==b.length)return false;d=c.keys(a);var e=c.keys(b);if(d.length!=e.length)return false;for(var f in a)if(!(f in b)||!c.isEqual(a[f],b[f]))return false;return true};c.isEmpty=function(a){if(c.isArray(a)||c.isString(a))return a.length===\n0;for(var b in a)if(m.call(a,b))return false;return true};c.isElement=function(a){return!!(a&&a.nodeType==1)};c.isArray=o||function(a){return F.call(a)==="[object Array]"};c.isObject=function(a){return a===Object(a)};c.isArguments=function(a){return!!(a&&m.call(a,"callee"))};c.isFunction=function(a){return!!(a&&a.constructor&&a.call&&a.apply)};c.isString=function(a){return!!(a===""||a&&a.charCodeAt&&a.substr)};c.isNumber=function(a){return!!(a===0||a&&a.toExponential&&a.toFixed)};c.isNaN=function(a){return a!==\na};c.isBoolean=function(a){return a===true||a===false};c.isDate=function(a){return!!(a&&a.getTimezoneOffset&&a.setUTCFullYear)};c.isRegExp=function(a){return!!(a&&a.test&&a.exec&&(a.ignoreCase||a.ignoreCase===false))};c.isNull=function(a){return a===null};c.isUndefined=function(a){return a===void 0};c.noConflict=function(){q._=D;return this};c.identity=function(a){return a};c.times=function(a,b,d){for(var e=0;e<a;e++)b.call(d,e)};c.mixin=function(a){j(c.functions(a),function(b){I(b,c[b]=a[b])})};\nvar J=0;c.uniqueId=function(a){var b=J++;return a?a+b:b};c.templateSettings={evaluate:/<%([\\s\\S]+?)%>/g,interpolate:/<%=([\\s\\S]+?)%>/g};c.template=function(a,b){var d=c.templateSettings;d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push(\'"+a.replace(/\\\\/g,"\\\\\\\\").replace(/\'/g,"\\\\\'").replace(d.interpolate,function(e,f){return"\',"+f.replace(/\\\\\'/g,"\'")+",\'"}).replace(d.evaluate||null,function(e,f){return"\');"+f.replace(/\\\\\'/g,"\'").replace(/[\\r\\n\\t]/g," ")+"__p.push(\'"}).replace(/\\r/g,\n"\\\\r").replace(/\\n/g,"\\\\n").replace(/\\t/g,"\\\\t")+"\');}return __p.join(\'\');";d=new Function("obj",d);return b?d(b):d};var l=function(a){this._wrapped=a};c.prototype=l.prototype;var s=function(a,b){return b?c(a).chain():a},I=function(a,b){l.prototype[a]=function(){var d=i.call(arguments);E.call(d,this._wrapped);return s(b.apply(c,d),this._chain)}};c.mixin(c);j(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=k[a];l.prototype[a]=function(){b.apply(this._wrapped,arguments);\nreturn s(this._wrapped,this._chain)}});j(["concat","join","slice"],function(a){var b=k[a];l.prototype[a]=function(){return s(b.apply(this._wrapped,arguments),this._chain)}});l.prototype.chain=function(){this._chain=true;return this};l.prototype.value=function(){return this._wrapped}})();exports={_:module.exports};\n');
jsio.setCachedSrc("../../packages/index.js",'require("./jsio");\n');jsio.setCachedSrc("../../packages/logging.js","exports.UIWatcher=Class(function(){});\n");
jsio("import .compiler").start()