<html>
 <head>
  <script>
function log() {
    d= document.createElement('div')
    d.innerHTML = [].join.call(arguments, " ");
    document.body.appendChild(d);
}


function time(f, i) {
    window.setTimeout(function() {
      var start = new Date()
      for (var j = 0; j < i; ++j) {
          f();
      }
      var end = new Date()
      var total = end - start;
      log(f.name, '(' + i + ' iterations),', total);
    }, 0);
}


function simpleWith() {
   with({x: 3}) {
   var y = x;
   }
}

function simple() {
    var y = 3;
}

var enclosedSimple = (function() {
    return function enclosedSimple() {
        var y = 3;
    }
})()

function unusedWith() {
   with({x: 3}) {
      var y = 3;
   }
}

function noopWith() {
   with({}) {
   }
}

function noop() {

}

var enclosedNoop = (function() {
    return function enclosedNoop() {

    }
})()

var withEnclosedNoop;
with({}) {
  (function() {
    withEnclosedNoop = function withEnclosedNoop() {
    }
  })();
}

var simpleWithEnclosed;
with({x: 3}) {
  (function() {
    simpleWithEnclosed = function simpleWithEnclosed() {
        var y = x;
        var i;
    }
  })();
}

function simpleWithInnerLooped() {
   with({x: 3}) {
     for (var i = 0; i < 10; ++i) {
        var y = x;
     }
   }
}

function simpleWithOuterLooped() {
   for (var i = 0; i < 10; ++i) {
     with({x: 3}) {
        var y = x;
     }
   }
}

var simpleWithEnclosedInnerLooped;
with({x: 3}) {
  (function() {
    simpleWithEnclosedInnerLooped = function simpleWithEnclosedInnerLooped() {
      for (var i = 0; i < 10; ++i) {
        var y = x;
      }
  }
  })();
};



onload = function() {
  time(simple, 10000);
  time(simpleWith, 10000);
  time(enclosedSimple, 10000);
  time(simpleWithEnclosed, 10000);
  time(simpleWithEnclosedInnerLooped, 10000);
  time(simpleWithInnerLooped, 100000);
  time(simpleWithOuterLooped, 100000);
  time(unusedWith, 10000);
  time(noop, 10000);
  time(noopWith, 10000);
  time(enclosedNoop, 10000);
  time(withEnclosedNoop, 10000);
  time(simpleWithInnerLooped, 10);
  time(simpleWithInnerLooped, 100);
  time(simpleWithInnerLooped, 1000);
  time(simpleWithInnerLooped, 10000);
  time(simpleWithInnerLooped, 100000);
  time(simpleWithInnerLooped, 200000);
  time(simpleWithInnerLooped, 400000);
  time(simpleWithOuterLooped, 10);
  time(simpleWithOuterLooped, 100);
  time(simpleWithOuterLooped, 1000);
  time(simpleWithOuterLooped, 10000);
  time(simpleWithOuterLooped, 100000);
}

</script>
</head>
<body>
 <h1>Time with execution</h1>
</body>
</html>
